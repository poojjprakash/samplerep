/*! (C) 2024 Microsoft Group of Companies. v1.0.5-HF2 */
var XandrVideoAdSdk;(()=>{var e={"./node_modules/@appnexus/videoads-util-logging/src/Logging.js":
/*! *********************************************************************!*\
  !*** ./node_modules/@appnexus/videoads-util-logging/src/Logging.js ***!
  \*********************************************************************/e=>{var t=0,r=0,a=0,i=!1;function n(e,t){try{if(void 0!==e&&l(e)&&console){var r=i?"[XandrVideo":"[APN",a=function(e){switch(e){case 0:break;case 1:return"always";case 2:return"error";case 3:return"warn";case 4:return"info";case 5:return"log";case 6:return"debug";case 7:return"verbose"}}(e);if(console[a]||(r+="-"+a,a="log"),r+="]",r+="["+function(){var e="";try{var t=new Date;e=t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+"."+t.getMilliseconds()}catch(e){}return e}()+"]",t.splice(0,0,r),console[a].apply)console[a].apply(console,t);else{var n=Array.prototype.slice.apply(t).join("");console[a](n)}}}catch(e){}}function s(e){try{var t="";try{t=window.top.location.search}catch(e){try{t=window.location.search}catch(e){}}var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}catch(e){return""}}function o(e){var t=0;try{if(void 0!==e){var r=parseInt(e);isNaN(r)?"boolean"==typeof e?t=e?6:0:"TRUE"===(e=e.toUpperCase())?t=6:"FALSE"===e&&(t=0):t=r}}catch(e){}return t}function l(e){return e<=t}e.exports={traceAtLevel:function(){try{if(arguments.length>0){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);n.call(this,e,t)}}catch(e){}},always:function(){try{n.call(this,1,Array.prototype.slice.call(arguments))}catch(e){}},error:function(){try{n.call(this,2,Array.prototype.slice.call(arguments))}catch(e){}},log:function(){try{n.call(this,5,Array.prototype.slice.call(arguments))}catch(e){}},warn:function(){try{n.call(this,3,Array.prototype.slice.call(arguments))}catch(e){}},info:function(){try{n.call(this,4,Array.prototype.slice.call(arguments))}catch(e){}},debug:function(){try{n.call(this,6,Array.prototype.slice.call(arguments))}catch(e){}},verbose:function(){try{n.call(this,6,Array.prototype.slice.call(arguments))}catch(e){}},handleLogDebugLegacySupport:function(e,t){try{!function(e,t,r){try{var a="[APN-"+e+"-"+(new Date).toISOString()+"] ";null!==r&&r&&r.length>0&&(a+=r+">"),a+=t,l(e)&&console.log(a)}catch(t){l(e)&&console.log(t)}}(5,e,t)}catch(e){}},setDebugLevel:function(e){try{!function(e){try{a=o(e),t=Math.max(Math.max(r,a),t)}catch(e){}}(e)}catch(e){}},isTraceLevelActive:function(e){try{return l(e)}catch(e){return!1}},TRACE_LEVEL_ALWAYS:1,TRACE_LEVEL_ERROR:2,TRACE_LEVEL_WARN:3,TRACE_LEVEL_INFO:4,TRACE_LEVEL_LOG:5,TRACE_LEVEL_DEBUG:6,TRACE_LEVEL_VERBOSE:6},function(){try{var e=s("xdr_debug").toUpperCase();e&&e.length>0?(r=o(e),i=!0):r=o(s("ast_debug").toUpperCase()),t=Math.max(r,t)}catch(e){}}()},"./node_modules/@appnexus/videoads-util-user-agent-parser/src/UserAgentParser.js":
/*! ***************************************************************************************!*\
  !*** ./node_modules/@appnexus/videoads-util-user-agent-parser/src/UserAgentParser.js ***!
  \***************************************************************************************/(e,t,r)=>{r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js").always("UserAgentParser","Version 0.0.1");var a=function(e,t){var r="model",i="name",n="type",s="vendor",o="version",l="mobile",d="tablet",c={extend:function(e,t){var r={};for(var a in e)t[a]&&t[a].length%2==0?r[a]=t[a].concat(e[a]):r[a]=e[a];return r},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},u={rgx:function(){var e,t,r,a,i,n,s={},o=0,l=arguments;for(r=0;r<l[1].length;r++)s["object"==typeof(a=l[1][r])?a[0]:a]=void 0;for(;o<l.length&&!i;){var d=l[o],c=l[o+1];for(e=t=0;e<d.length&&!i;)if(i=d[e++].exec(this.getUA()))for(r=0;r<c.length;r++)n=i[++t],"object"==typeof(a=c[r])&&a.length>0?2===a.length?"function"==typeof a[1]?s[a[0]]=a[1].call(this,n):s[a[0]]=a[1]:3===a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?s[a[0]]=n?n.replace(a[1],a[2]):void 0:s[a[0]]=n?a[1].call(this,n,a[2]):void 0:4===a.length&&(s[a[0]]=n?a[3].call(this,n.replace(a[1],a[2])):void 0):s[a]=n||void 0;o+=2}return s},str:function(e,t){for(var r in t)if("object"==typeof t[r]&&t[r].length>0){for(var a=0;a<t[r].length;a++)if(c.has(t[r][a],e))return"?"===r?void 0:r}else if(c.has(t[r],e))return"?"===r?void 0:r;return e}},p={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},h={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[i,o],[/(opios)[\/\s]+([\w\.]+)/i],[[i,"Opera Mini"],o],[/\s(opr)\/([\w\.]+)/i],[[i,"Opera"],o],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[i,o],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[i,"IE"],o],[/(edge)\/((\d+)?[\w\.]+)/i],[i,o],[/(yabrowser)\/([\w\.]+)/i],[[i,"Yandex"],o],[/(comodo_dragon)\/([\w\.]+)/i],[[i,/_/g," "],o],[/(micromessenger)\/([\w\.]+)/i],[[i,"WeChat"],o],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[o,[i,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[i,/(.+)/,"$1 WebView"],o],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[o,[i,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[i,o],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[i,"UCBrowser"],o],[/(dolfin)\/([\w\.]+)/i],[[i,"Dolphin"],o],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[i,"Chrome"],o],[/;fbav\/([\w\.]+);/i],[o,[i,"Facebook"]],[/fxios\/([\w\.-]+)/i],[o,[i,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[o,[i,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[o,i],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[i,[o,u.str,p.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[i,o],[/(navigator|netscape)\/([\w\.-]+)/i],[[i,"Netscape"],o],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[i,o]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[r,s,[n,d]],[/applecoremedia\/[\w\.]+ \((ipad)/],[r,[s,"Apple"],[n,d]],[/(apple\s{0,1}tv)/i],[[r,"Apple TV"],[s,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[s,r,[n,d]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[r,[s,"Amazon"],[n,d]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[r,u.str,p.device.amazon.model],[s,"Amazon"],[n,l]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[r,s,[n,l]],[/\((ip[honed|\s\w*]+);/i],[r,[s,"Apple"],[n,l]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[s,r,[n,l]],[/\(bb10;\s(\w+)/i],[r,[s,"BlackBerry"],[n,l]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[r,[s,"Asus"],[n,d]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[s,"Sony"],[r,"Xperia Tablet"],[n,d]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[s,"Sony"],[r,"Xperia Phone"],[n,l]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[s,r,[n,"console"]],[/android.+;\s(shield)\sbuild/i],[r,[s,"Nvidia"],[n,"console"]],[/(playstation\s[34portablevi]+)/i],[r,[s,"Sony"],[n,"console"]],[/(sprint\s(\w+))/i],[[s,u.str,p.device.sprint.vendor],[r,u.str,p.device.sprint.model],[n,l]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[s,r,[n,d]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[s,[r,/_/g," "],[n,l]],[/(nexus\s9)/i],[r,[s,"HTC"],[n,d]],[/(nexus\s6p)/i],[r,[s,"Huawei"],[n,l]],[/(microsoft);\s(lumia[\s\w]+)/i],[s,r,[n,l]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[r,[s,"Microsoft"],[n,"console"]],[/(kin\.[onetw]{3})/i],[[r,/\./g," "],[s,"Microsoft"],[n,l]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[r,[s,"Motorola"],[n,l]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[r,[s,"Motorola"],[n,d]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[s,c.trim],[r,c.trim],[n,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[r,/^/,"SmartTV"],[s,"Samsung"],[n,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[r,[s,"Sharp"],[n,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[s,"Samsung"],r,[n,d]],[/smart-tv.+(samsung)/i],[s,[n,"smarttv"],r],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[s,"Samsung"],r,[n,l]],[/sie-(\w+)*/i],[r,[s,"Siemens"],[n,l]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[s,"Nokia"],r,[n,l]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[r,[s,"Acer"],[n,d]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[s,"LG"],r,[n,d]],[/(lg) netcast\.tv/i],[s,r,[n,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[r,[s,"LG"],[n,l]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[r,[s,"Lenovo"],[n,d]],[/linux;.+((jolla));/i],[s,r,[n,l]],[/((pebble))app\/[\d\.]+\s/i],[s,r,[n,"wearable"]],[/android.+;\s(glass)\s\d/i],[r,[s,"Google"],[n,"wearable"]],[/android.+;\s(pixel c)\s/i],[r,[s,"Google"],[n,d]],[/android.+;\s(pixel xl|pixel)\s/i],[r,[s,"Google"],[n,l]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[r,/_/g," "],[s,"Xiaomi"],[n,l]],[/android.+a000(1)\s+build/i],[r,[s,"OnePlus"],[n,l]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[n,c.lowerize],s,r]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[o,[i,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[i,o],[/rv\:([\w\.]+).*(gecko)/i],[o,i]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[i,o],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[i,[o,u.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[i,"Windows"],[o,u.str,p.os.windows.version]],[/\((bb)(10);/i],[[i,"BlackBerry"],o],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[i,o],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[i,"Symbian"],o],[/\((series40);/i],[i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[i,"Firefox OS"],o],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[i,o],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[i,"Chromium OS"],o],[/(sunos)\s?([\w\.]+\d)*/i],[[i,"Solaris"],o],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[i,o],[/(haiku)\s(\w+)/i],[i,o],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[i,"iOS"],[o,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[i,"Mac OS"],[o,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[i,o]]};if(!(this instanceof a))return new a(e,t).getResult();var f=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""),g=t?c.extend(h,t):h;return this.getBrowser=function(){var e=u.rgx.apply(this,g.browser);return e.major=c.major(e.version),e},this.getDevice=function(){return u.rgx.apply(this,g.device)},this.getEngine=function(){return u.rgx.apply(this,g.engine)},this.getOS=function(){return u.rgx.apply(this,g.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice()}},this.getUA=function(){return f},this};e.exports=a},"./src/AdCommunicator.js":
/*! *******************************!*\
  !*** ./src/AdCommunicator.js ***!
  \*******************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{AdCommunicator:()=>s});var a=r(/*! ./constants/events */"./src/constants/events.js"),i=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js");function n(e){switch(e){case"video-first-quartile":return"first-quartile";case"video-mid":return"midpoint";case"video-third-quartile":return"third-quartile";case"complete":return"complete"}return null}class s{constructor(e){this.events={},this.oneTimeEvents={...a.EVENTS_DISPATCH_ONCE},this.addEventListener(a.EVENTS.WARNING,e=>{if(e.detail){const t="Xandr Video SDK -> ".concat(JSON.stringify(e.detail));console.warn(t)}}),this.addEventListener(a.EVENTS.ERROR,e=>{if(e.detail){const t="Xandr Video SDK -> ".concat(JSON.stringify(e.detail));console.error(t)}}),this.adRequestId=e}addEventListener(e,t){t&&function(e){return a.EVENT_DETAILS.hasOwnProperty(e)}(e)&&(this.events[e]?this.events[e].find(e=>e===t)||this.events[e].push(t):this.events[e]=[t])}removeEventListener(e,t){if(this.events[e]){const r=this.events[e].findIndex(e=>e===t);r>=0&&this.events[e].splice(r,1)}}removeAllEventListeners(){this.events={}}dispatchEvent(e,t){const r=r=>{const s=n(e)||t;s&&a.EVENT_DETAILS[r]?(0,i.log)("MSSDK","requestId: ".concat(this.adRequestId,",")," event: ".concat(r,",")," data: ",s):(0,i.log)("MSSDK","requestId: ".concat(this.adRequestId,",")," event: ".concat(r))},s=r=>{let i;const s=n(e)||t;if(s&&a.EVENT_DETAILS[r])return"telemetry"===r?(i=new CustomEvent(r,{detail:{id:this.adRequestId,type:s.numberOfHops?"ad":"summary",data:s}}),i):(i=new CustomEvent(r,{detail:{id:this.adRequestId,data:s}}),i);if("adended"===r){const t="video-complete"===e?"complete":"skipped";return i=new CustomEvent(r,{detail:{id:this.adRequestId,data:{type:t}}}),i}return new CustomEvent(r,{detail:{id:this.adRequestId}})},o=a.XANDR_MSN_EVENT_MAP[e];o&&o.forEach(e=>{const t=this.oneTimeEvents[e];if(!t){if(!1===t&&(this.oneTimeEvents[e]=!0),this.events[e]){const t=s(e);this.events[e].forEach(e=>{e(t)})}r(e)}})}}},"./src/AdRequestManager.js":
/*! *********************************!*\
  !*** ./src/AdRequestManager.js ***!
  \*********************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{AdRequestManager:()=>x,test:()=>O});var a=r(/*! ./constants/statuses */"./src/constants/statuses.js"),i=r(/*! ./FallbackVastInfo */"./src/FallbackVastInfo.js"),n=r(/*! ./adRequestUtils/ptvRequestUtils */"./src/adRequestUtils/ptvRequestUtils.js"),s=r(/*! ./adRequestUtils/playFlatVast */"./src/adRequestUtils/playFlatVast.js"),o=r(/*! ./utils/xmlHelper */"./src/utils/xmlHelper.js"),l=r(/*! ./utils/commonUtils */"./src/utils/commonUtils.js"),d=r(/*! ./constants/events */"./src/constants/events.js"),c=r(/*! ./constants/common */"./src/constants/common.js");var u=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js");function p(e,t,r,a,n,s){const c=e.indexOf("<VAST ");let p=e.substring(c);const h=(new DOMParser).parseFromString(p,"text/xml");var f=!1;if("parsererror"===h.documentElement.nodeName){f=!0;try{u.error("MSSDK","Error reason = "+h.documentElement.childNodes[0].nodeValue)}catch(e){}}else{const e=(0,o.getSubNode)(h,"parsererror");if(e){f=!0;try{u.error("MSSDK","Error reason = "+e.innerText)}catch(e){}}}if(f)return this.telemetry[t].data.outcome="XML parsing error",this.telemetry[t].data.errCode=100,r.dispatchEvent(d.EVENTS.ADERROR,{errorCode:100,message:"XML parsing error"}),r.dispatchEvent(d.EVENTS.NOADRECEIVED),void r.dispatchEvent(d.EVENTS.ADSLOTENDED);const g=(0,o.getSubNode)(h,"VAST");if(!g)return this.telemetry[t].data.outcome="No VAST in response",this.telemetry[t].data.errCode=100,r.dispatchEvent(d.EVENTS.ADERROR,{errorCode:100,message:"No VAST in response"}),void r.dispatchEvent(d.EVENTS.NOADRECEIVED);if(!g.firstChild)return this.telemetry[t].data.outcome="EMPTY VAST",this.telemetry[t].data.errCode=101,r.dispatchEvent(d.EVENTS.ADERROR,{errorCode:101,message:"EMPTY VAST"}),void r.dispatchEvent(d.EVENTS.NOADRECEIVED);const m=(0,o.getVASTVersion)(g);this.fallbackRequestData[t].vastVersion=m;const v=(0,o.getSubNode)(g,"Error");let b=null;v&&(b=(0,o.getNodeValue)(v),b=b.trim());const E=(0,o.getSubNodes)(g,"Ad");if(!E||0===E.length)return this.telemetry[t].data.outcome="NO AD NODE",this.telemetry[t].data.errCode=101,b&&(b=b.replace("[ERRORCODE]",101),(0,l.trackUrl)(b)),r.dispatchEvent(d.EVENTS.ADERROR,{errorCode:101,message:"NO AD NODE"}),void r.dispatchEvent(d.EVENTS.NOADRECEIVED);const y=this.fallbackRequestData[t].fallbackVastInfo;for(let e=0;e<E.length;e++)y.push(new i.FallbackVastInfo(0,E[e],m,(0,o.getFallbackOnNoAd)(E[e]),(0,o.getFallbackIndex)(E[e]),a,n,s));this.fallbackRequestData[t].fallbackVastInfo=y.sort((e,t)=>e.fallbackIndex-t.fallbackIndex),this.fallbackRequestData[t].fallbackVastInfo.forEach((e,t)=>{e.priority=t+1})}function h(e){const t=this.fallbackRequestData[e].fallbackVastInfo;for(let e=0;e<t.length;e++){const r=t[e];if(r.status===a.UNWRAPPING.READY||r.status===a.UNWRAPPING.PROGRESS)return null;if(r.status===a.UNWRAPPING.SUCCESS)return r}return null}function f(e){const t=this.fallbackRequestData[e].fallbackVastInfo;for(let e=0;e<t.length;e++)if(t[e].status!==a.UNWRAPPING.FAILED)return!1;return!0}function g(e){const t=this.fallbackRequestData[e].fallbackVastInfo;for(let e=0;e<t.length;e++)if(t[e].status!==a.UNWRAPPING.FAILED&&t[e].status!==a.FALLBACK.STEPFAILED)return!1;return!0}function m(e,t){const r=this.requests.find(t=>t.requestId===e.requestId);return r?(r.forceToPlay&&t&&(r.schedule=t.currentTime()),r.schedule):e.schedule}function v(e,t){return new Promise((r,a)=>{const i=e.contentPlayer;if(!i)return t.dispatchEvent(d.EVENTS.SDKERROR,{message:"Content player ".concat(e.playerElementId," not exist")}),void t.dispatchEvent(d.EVENTS.ADSLOTENDED);const n=()=>{const t=m.bind(this)(e,i);t===c.SCHEDULE_VALUE_POSTROLL&&(e.schedule=i.duration(),D.bind(this)(e.requestId,e.schedule));const a=t-i.currentTime();a>=0&&(e=>{e<=5&&(i.off("timeupdate",n),r())})(a)},s=()=>{const t=i.contentEl().children[0];((0,l.isSafari)()?t.currentTime:i.currentTime())<=((0,l.isIOS)()||(0,l.isIpad)()?.5:.1)&&function(e,t){e.contentPlayerPlaying&&t.pause()}(e,i),r()};i.ready(()=>{e.contentPlayerPlaying=!e.contentPlayer.paused();const t=m.bind(this)(e);switch(t){case 0:(0,l.isSafari)()?i.one("timeupdate",s):s();break;case c.SCHEDULE_VALUE_NOW:!function(e,t){var r;null!=e&&null!==(r=e.debug)&&void 0!==r&&r.pauseContentNowAsPreroll&&t.currentTime()<=.5&&e.contentPlayerPlaying&&t.pause()}(e,i),r();break;case c.SCHEDULE_VALUE_POSTROLL:Math.abs(i.duration()-i.currentTime())<.1?(e.schedule=i.duration(),D.bind(this)(e.requestId,e.schedule),r()):i.on("timeupdate",n);break;default:if(t>i.duration()){const t="Ad is scheduled for '".concat(e.origSchedule,"' ")+"but will not play because the schedule occurs after the content video has ended";a(new Error(t))}else if(t<=i.currentTime()){k.bind(this)(i)===t&&D.bind(this)(e.requestId,i.currentTime()),r()}else i.on("timeupdate",n)}})})}function b(e){const t=e.contentPlayer;if(t&&t.currentTime()<=.1&&t.paused()&&!t.muted()){let e=!1,r="playing";((0,l.isSafari)()||(0,l.isIOS)()||(0,l.isIpad)())&&(r="timeupdate"),t.one(r,()=>{e||t.pause()}),t.one("pause",()=>{e=!0}),t.play()}}function E(e){return new Promise(t=>{e.ready(()=>{t(e.currentTime())})})}function y(e,t,r){const a=h.bind(this)(e);return!!a&&(clearTimeout(t),this.fallbackRequestData[e].vastSelectedPriority=a.priority,r({flatVastObj:a.vastObject}),!0)}function A(e,t,r,a,i){a.dispatchEvent(d.EVENTS.SDKWARNING,{message:"Parser failed to parse VAST: "+e.message}),r||f.bind(this)(t)&&(clearTimeout(i),a.dispatchEvent(d.EVENTS.ADERROR,{message:"No available VAST was found"}),a.dispatchEvent(d.EVENTS.ADSLOTENDED))}function T(e,t,r,i,n){let s=!1;this.fallbackRequestData[t].fallbackVastInfo.forEach(o=>{this.timedout||setTimeout(()=>{e.demo&&i.dispatchEvent(d.EVENTS.DEBUG,{type:"flow",status:a.FLOW.UNWRAPPED}),o.unwrapVast().then(e=>{s||(s=y.bind(this)(t,r,n)),e.telemetryEventData&&i.dispatchEvent(d.EVENTS.TELEMETRY,e.telemetryEventData)}).catch(e=>{A.bind(this)(e,t,s,i,r)})},0)})}function S(e,t,r,i,n){return 0!==this.fallbackRequestData[e].fallbackVastInfo.length||(r&&clearTimeout(r),i.dispatchEvent(d.EVENTS.ADERROR,{message:"No Ad was found in PTV response"}),n({errorMessage:"No Ad was found in PTV response"}),t.demo&&i.dispatchEvent(d.EVENTS.DEBUG,{type:"flow",status:a.FLOW.VASTFAILED}),t.contentPlayerPlaying&&t.contentPlayer.play(),!1)}function N(e,t){return Math.abs(t-e)<.1}function w(e,t,r,a,i,n,o,l,c){if(t>-.5&&t<.5){r.off(N(a.schedule,r.duration())?"ended":"timeupdate",o),this.fallbackRequestData[a.requestId].adRunning=!0,this.fallbackRequestData[a.requestId].schedule=a.schedule;let t=l;if(i&&(c=Date.now()),0===m.bind(this)(a,r)){t=l-(Date.now()-c)}var u;if(R.bind(this)(a.requestId),n.dispatchEvent(d.EVENTS.DEBUG,"INFO: Remaining timeout for rendering = "+t),t>0)return this.telemetry[a.requestId].data.adSelectedToPlay=null===(u=e.flatVastObj)||void 0===u?void 0:u.adNumber,void s.playFlatVast.bind(this)(a,e.flatVastObj,t);s.reportSdkTimeoutForRequest.bind(this)(a.requestId,n),this.telemetry[a.requestId].data.outcome="timeout",this.logRequestTelemetry(a.requestId),delete this.fallbackRequestData[a.requestId]}}function I(e,t,r,a,i){const n=a-(Date.now()-i);var o;(r.dispatchEvent(d.EVENTS.DEBUG,"INFO: Remaining timeout for rendering = "+n),n>0)?(this.telemetry[t.requestId].data.adSelectedToPlay=null===(o=e.flatVastObj)||void 0===o?void 0:o.adNumber,s.playFlatVast.bind(this)(t,e.flatVastObj,n)):(s.reportSdkTimeoutForRequest.bind(this)(t.requestId,r),this.telemetry[t.requestId].data.outcome="timeout",this.logRequestTelemetry(t.requestId),delete this.fallbackRequestData[t.requestId])}function V(e){for(const t in this.fallbackRequestData)if(this.fallbackRequestData[t].contentPlayer===e&&this.fallbackRequestData[t].adRunning)return!0;return!1}function k(e){for(const t in this.fallbackRequestData)if(this.fallbackRequestData[t].contentPlayer===e&&this.fallbackRequestData[t].adRunning)return this.fallbackRequestData[t].schedule;return null}function C(e,t,r){for(let a=0;a<this.requests.length;a++){const i=this.requests[a];if(i.contentPlayer===e&&i.schedule===r)return i.adRequestId===t}return!1}function R(e){for(let t=0;t<this.requests.length;t++){if(this.requests[t].requestId===e)return void this.requests.splice(t,1)}}function D(e,t){for(let r=0;r<this.requests.length;r++)if(this.requests[r].requestId===e)return void(this.requests[r].schedule=t)}function P(e,t,r,a,i){const n=e.contentPlayer;let s=!1,o=!0;const l=e=>{o&&e>-.5&&e<.5&&(o=!1,r.dispatchEvent(d.EVENTS.SDKWARNING,{message:"Another ad is playing.The requested ad is going to play when the currently playing ad complete."}))},u=()=>{const o=m.bind(this)(e,n),d=o-n.currentTime();if(V.bind(this)(n)||!C.bind(this)(n,e.adRequestId,o))return s=!0,i=Date.now(),void l(d);w.bind(this)(t,d,n,e,s,r,u,a,i)};if(0===e.schedule&&n.currentTime()<.5||e.schedule===c.SCHEDULE_VALUE_NOW){if(!V.bind(this)(n)&&C.bind(this)(n,e.adRequestId,e.schedule))return this.fallbackRequestData[e.requestId].adRunning=!0,R.bind(this)(e.requestId),void I.bind(this)(t,e,r,a,i);l(0)}!V.bind(this)(n)&&C.bind(this)(n,e.adRequestId,e.schedule)||(s=!0),(0===e.schedule&&n.currentTime()<.5||e.schedule===c.SCHEDULE_VALUE_NOW)&&(e.schedule=n.currentTime(),D.bind(this)(e.requestId,e.schedule)),n.on(N(e.schedule,n.duration())?"ended":"timeupdate",u),e.schedule===n.duration()&&n.duration()===n.currentTime()?n.trigger("ended"):e.schedule>0&&Math.abs(e.schedule-n.currentTime())<.5&&C.bind(this)(n,e.adRequestId,e.schedule)&&n.trigger("timeupdate")}const O=function(){try{process&&process.env,0}catch(e){}return{}}();class x{constructor(e,t){this.adRequestManagerId=t,this.vastSelectedPriority=-1,this.fallbackRequestData={},this.timedout=!1,this.sdkInstance=e,this.options={...e.options},this.adPlayers=[],this.requests=[],this.requestNumber=1,this.contentPlayersForcedToPauseAd=[],this.telemetry={},this.logRequestTelemetry=e=>{const t=this.telemetry[e];if(t&&t.adRequestId){const e="MS SDK Telemetry: Request Id - ".concat(t.adRequestId,", data - ");t.data.playerReady&&t.data.playerShow&&(t.data.timeFromPlayerReadyToShow=t.data.playerShow-t.data.playerReady),t.data.adRequestTime&&t.data.playerShow&&(t.data.timeFromRequestToPlay=t.data.playerShow-t.data.adRequestTime),t.data.adRequestTime&&t.data.failedTime&&(t.data.timeFromRequestToFailed=t.data.failedTime-t.data.adRequestTime),delete t.data.playerReady,delete t.data.adRequestTime,delete t.data.failedTime,delete t.data.playerShow,console.log(e,t.data),delete t.adRequestId,t.adCommunicator.dispatchEvent(d.EVENTS.TELEMETRY,t.data)}}}requestVast(e,t,r,i){const o=e.requestId;this.fallbackRequestData[o]={vastSelectedPriority:-1,fallbackVastInfo:[],adCommunicator:r,contentPlayer:e.contentPlayer,adRunning:!1,sdkTimeoutReported:!1};let c=null;return 0===e.schedule&&(c=setTimeout(()=>{this.fallbackRequestData[o].fallbackVastInfo.forEach(t=>{this.timedout=!0,t.status===a.UNWRAPPING.PROGRESS&&t.terminate(),s.reportSdkTimeoutForRequest.bind(this)(e.requestId)})},t)),n.makePtvCall.bind(this)(e,t,r).then(t=>{if(r.dispatchEvent(d.EVENTS.ADREQUESTCOMPLETE),p.bind(this)(t,o,r,e.adServerTimeout,e.wrapperLimit,e.adRequestId),e.demo&&r.dispatchEvent(d.EVENTS.DEBUG,{type:"flow",status:a.FLOW.ADCOUNT,count:this.fallbackRequestData[o].fallbackVastInfo.length}),!S.bind(this)(o,e,c,r,i))return this.logRequestTelemetry(o),R.bind(this)(o),(0,l.resumeContentPlayer)(e.contentPlayer,this),void(e.contentPlayerPlaying||0!==e.schedule||e.contentPlayer.pause());e.demo&&r.dispatchEvent(d.EVENTS.DEBUG,{type:"flow",status:a.FLOW.VASTVALID}),r.dispatchEvent(d.EVENTS.ADRECEIVED,{adcount:this.fallbackRequestData[o].fallbackVastInfo.length}),T.bind(this)(e,o,c,r,i)}).catch(t=>{clearTimeout(c),this.telemetry[o].data.outcome=t.message,this.logRequestTelemetry(o),e.demo&&r.dispatchEvent(d.EVENTS.DEBUG,{type:"flow",data:"No VAST xml received"}),i({errorMessage:"PTV call failed: "+t.message}),R.bind(this)(o),(0,l.resumeContentPlayer)(e.contentPlayer,this),e.contentPlayerPlaying||0!==e.schedule||e.contentPlayer.pause()})}getNextFallbackVast(e){return new Promise((t,r)=>{const a=this.fallbackRequestData[e].vastSelectedPriority-1;if("false"===this.fallbackRequestData[e].fallbackVastInfo[a].fallbackOnNoAd)return void r(new Error("Fallback Ad selection stopped by 'fallbackOnNoAd=false'"));const i=setInterval(()=>{if(g.bind(this)(e))clearInterval(i),r(new Error("There are no more fallback Ads"));else{const r=h.bind(this)(e);r&&(clearInterval(i),this.fallbackRequestData[e].vastSelectedPriority=r.priority,t(r))}},10)})}async playAd(e,t,r){const i={...this.options,...e};if(i.demo&&r.dispatchEvent(d.EVENTS.DEBUG,{type:"flow",status:a.FLOW.ADREQUEST}),i.origSchedule=i.schedule,i.schedule=await async function(e,t){let r=e.schedule;const a=e.contentPlayer;if(r||(r="pre"),"string"==typeof r){if("pre"===r){const r=await E(a);return r<.5?c.SCHEDULE_VALUE_NOW:(t.dispatchEvent(d.EVENTS.SDKERROR,{message:"Ad request was received too late. Request schedule - ".concat(e.origSchedule,". Main video time - ").concat(r,".")}),t.dispatchEvent(d.EVENTS.ADSLOTENDED),null)}if("post"===r)return c.SCHEDULE_VALUE_POSTROLL;if("now"===r)return c.SCHEDULE_VALUE_NOW;const i=r.split(":");if(3===i.length&&0===i.filter(e=>isNaN(e)).length){i.forEach((e,t)=>{i[t]=parseInt(e)});const r=3600*i[0]+60*i[1]+i[2],n=await E(a);return r<n-.5?(t.dispatchEvent(d.EVENTS.SDKERROR,{message:"Ad request was received too late. Request schedule - ".concat(e.origSchedule,". Main video time - ").concat(n,".")}),t.dispatchEvent(d.EVENTS.ADSLOTENDED),null):r}}return t.dispatchEvent(d.EVENTS.SDKERROR,{message:"Invalid 'schedule' option: ".concat(r," (Should be 'pre'/'post'/'HH:MM:SS'/now)")}),t.dispatchEvent(d.EVENTS.ADSLOTENDED),null}(i,r),null===i.schedule)return;const n=(0,l.getRequestId)();i.requestId=n,this.requests.push({requestId:n,adRequestId:i.adRequestId,schedule:i.schedule,contentPlayer:i.contentPlayer,requestNumber:this.requestNumber++,telemetry:{}}),this.telemetry[n]={adCommunicator:r,adRequestId:i.adRequestId,data:{requestTimeout:t}},e.adServerTimeout&&(this.telemetry[n].data.adServerTimeout=e.adServerTimeout),i.schedule===c.SCHEDULE_VALUE_NOW&&(this.telemetry[n].data.adRequestTime=Date.now()),0!==i.schedule&&i.schedule!==c.SCHEDULE_VALUE_NOW||b.bind(this)(i),i.position=function(e,t){switch(e){case 0:return c.POSITION.PREROLL;case c.SCHEDULE_VALUE_POSTROLL:return c.POSITION.POSTROLL;case c.SCHEDULE_VALUE_NOW:return t.currentTime()<.5?c.POSITION.PREROLL:c.POSITION.MIDROLL}return c.POSITION.MIDROLL}(i.schedule,i.contentPlayer),v.bind(this)(i,r).then(()=>{r.dispatchEvent(d.EVENTS.DEBUG,"INFO: Request timeout = "+t);let e=Date.now();this.requestVast(i,t,r,a=>{if(a.flatVastObj)P.bind(this)(i,a,r,t,e);else{if(a.warning)return this.telemetry[n].data.outcome=a.warning,this.logRequestTelemetry(n),r.dispatchEvent(d.EVENTS.SDKWARNING,{message:a.warning}),void r.dispatchEvent(d.EVENTS.ADSLOTENDED);this.logRequestTelemetry(n),R.bind(this)(n),(0,l.resumeContentPlayer)(i.contentPlayer,this),i.contentPlayerPlaying||0!==i.schedule||i.contentPlayer.pause(),i.schedule===c.SCHEDULE_VALUE_NOW&&(this.contentPlayersForcedToPauseAd.includes(i.contentPlayer)||i.contentPlayer.play()),r.dispatchEvent(d.EVENTS.ADSLOTENDED)}})}).catch(e=>{this.telemetry[n].data.outcome=e.message,this.logRequestTelemetry(n),r.dispatchEvent(d.EVENTS.SDKERROR,{message:e.message}),r.dispatchEvent(d.EVENTS.ADSLOTENDED),R.bind(this)(i.requestId)})}pauseAdForPlayer(e,t){e?this.contentPlayersForcedToPauseAd.includes(t)||this.contentPlayersForcedToPauseAd.push(t):this.contentPlayersForcedToPauseAd=this.contentPlayersForcedToPauseAd.filter(e=>e!==t),this.adPlayers.forEach(r=>{r.pauseRunningAd(e,t)})}playAdAfterScrubbing(e){if(!e)return;const t=e.currentTime();let r=[],a=Number.MAX_SAFE_INTEGER;for(let i=0;i<this.requests.length;i++){const n=this.requests[i];n.schedule>=0&&n.schedule<e.duration()&&t>=n.schedule&&t-n.schedule<=a&&(a=t-n.schedule,r=[n.requestId])}0!==r.length&&(this.requests.forEach(t=>{r.includes(t.requestId)&&(t.schedule=e.currentTime(),t.forceToPlay=!0)}),e.trigger("timeupdate"))}}},"./src/FallbackVastInfo.js":
/*! *********************************!*\
  !*** ./src/FallbackVastInfo.js ***!
  \*********************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{FallbackVastInfo:()=>p});var a=r(/*! ./constants/statuses */"./src/constants/statuses.js"),i=r(/*! ./constants/common */"./src/constants/common.js"),n=r(/*! ./utils/xmlHelper */"./src/utils/xmlHelper.js"),s=r(/*! ./utils/commonUtils */"./src/utils/commonUtils.js"),o=r(/*! videoads-util-parsers */"./node_modules/videoads-util-parsers/src/VastParser.js");function l(e,t,r,i){this.status=e?a.UNWRAPPING.FAILED:a.UNWRAPPING.SUCCESS,e?this.errorInfo={errCode:r,message:i}:!this.flatVastObj&&t&&(this.flatVastObj=t)}function d(){if(this.flatVastObj&&Array.isArray(this.flatVastObj.errorUrls)&&this.flatVastObj.errorUrls.length>0){const e=this.flatVastObj.errorUrls.filter(e=>(0,s.isImpbusUrl)(e));e.length>0&&(this.firstPartyErrorUrl=e[0],this.flatVastObj.errorUrls=this.flatVastObj.errorUrls.filter(t=>!e.includes(t)))}}function c(e,t){const r=(0,n.getNodeAttributeValue)(t,"type");e.type=""!==r?r:"not specified";const a=(0,n.getNodeAttributeValue)(t,"width");e.width=""!==a?a:"not specified";const i=(0,n.getNodeAttributeValue)(t,"height");e.height=""!==i?i:"not specified";const s=(0,n.getNodeAttributeValue)(t,"codec");e.codec=""!==s?s:"not specified";const o=(0,n.getNodeAttributeValue)(t,"bitrate");e.bitrate=""!==o?o:"not specified";const l=(0,n.getNodeAttributeValue)(t,"apiFramework");e.apiFramework=""!==l?l:"not specified"}function u(e,t,r,a,i){const n={outcome:a?"rejected":"available",adUrl:t.hops.length>0&&t.hops[0].url?t.hops[0].url:"Inline Response",numberOfHops:t.hops.length,totalTimeToProcess:r},s="MS SDK Telemetry: RequestId - ".concat(i,", Ad #").concat(e,", parsing info - ");console.log(s,n,"hops - ",t.hops);const o={...n};return o.ad=e,o.hops=t.hops.map(e=>({...e})),o.hops.forEach((e,t)=>{e.chainNodeType=e.wrapper?"wrapper":e.inline?"inline":"failure",e.hopIndex=t+1,delete e.wrapperIndex,delete e.wrapper,delete e.inline}),o}class p{constructor(e,t,r,i,n,s,o,l){this.priority=e,this.domVastObj=t,this.vastVersion=r,this.fallbackOnNoAd=i,this.fallbackIndex=n,this.adServerTimeout=s&&s>0?s:2e3,this.flatVastObj=null,this.status=a.UNWRAPPING.READY,this.unwrappingTime=-1,this.startPlayTime=-1,this.errorInfo={},this.firstPartyErrorUrl="",this.wrapperLimit=o&&o>0?o:5,this.adRequestId=l,this.parser=null}get failed(){return this.status===a.UNWRAPPING.FAILED||this.status===a.FALLBACK.STEPFAILED}get processTime(){let e=this.unwrappingTime<0?0:this.unwrappingTime;return e+=this.startPlayTime<0?0:this.startPlayTime,e}get vastObject(){return this.flatVastObj}terminate(){this.parser&&this.parser.terminate()}setErrorCode(e){this.firstPartyErrorUrl&&("string"==typeof this.firstPartyErrorUrl?this.firstPartyErrorUrl=this.firstPartyErrorUrl.replace("[ERRORCODE]",e||"-1"):"object"==typeof this.firstPartyErrorUrl&&this.firstPartyErrorUrl.url&&(this.firstPartyErrorUrl.url=this.firstPartyErrorUrl.url.replace("[ERRORCODE]",e||"-1")))}getErrorCode(){if(this.firstPartyErrorUrl){let e=this.firstPartyErrorUrl;"object"==typeof e&&e.url&&(e=e.url);const t=e.indexOf("&error_code=");if(t>0){const r=e.substring(t+12).split("&");if(r.length>0)return parseInt(r[0])}}return null}getAdId(){return this.flatVastObj&&this.flatVastObj.adId?this.flatVastObj.adId:"not specified"}unwrapVast(){return new Promise((e,t)=>{try{const t=Date.now();this.parser=(0,o.parseAdObj)(this.domVastObj,this.vastVersion,(r,a,n,s,o,c)=>{if(this.unwrappingTime=Date.now()-t,r){const t=Array.isArray(n)?n[0]:n;if(t.telemetry&&(t.mediaFiles&&function(e){const t=[];if(e.mediaFiles.forEach(e=>{e.apiFramework&&"VPAID"===e.apiFramework.toUpperCase()?e.url.indexOf("anwrapper")>0?t.includes("anwrapper")||t.push("anwrapper"):t.includes("vpaid")||t.push("vpaid"):t.includes("video")||t.push("video")}),t.length>0&&e.telemetry.hops.length>0){const r=e.telemetry.hops.find(e=>e.inline);r&&(r.mediaType=t.join(", "))}}(t),t.telemetryEventData=u(this.priority,t.telemetry,this.unwrappingTime,t.errorFlag,this.adRequestId)),t.adNumber=this.priority,t.xandrSdk=!0,l.bind(this)(!1,t),d.bind(this)(),t.errorFlag){const e=t.errCode?t.errCode:this.getErrorCode();e&&(t.parsingErrorCode=e,t.parsingErrorMessage=i.PARSING_ERROR[e.toString()]||"")}return void e(this.vastObject)}const p={};c&&(p.telemetryEventData=u(this.priority,c,this.unwrappingTime,!0,this.adRequestId)),p.adNumber=this.priority,p.xandrSdk=!0,p.errorFlag=!0,p.parsingErrorCode=n,"vast"===n.substr(0,4)&&(p.parsingErrorCode=function(e){let t=e.substr(4);try{t=parseInt(t)}catch(e){t=null}return t}(n)),p.parsingErrorMessage=i.PARSING_ERROR[p.parsingErrorCode.toString()]||"",p.errorUrls=s,l.bind(this)(!1,p),d.bind(this)(),e(this.vastObject)},this.priority,this.adServerTimeout,{telemetry:!0,wrapperLimit:this.wrapperLimit})}catch(e){t(e)}})}getCreativeDataByUrl(e){const t={};if(e){let r;if(this.flatVastObj.vastXml){const e=(new DOMParser).parseFromString(this.flatVastObj.vastXml,"text/xml");if("parsererror"===e.documentElement.nodeName)return t;if((0,n.getSubNode)(e,"parsererror"))return t;const a=(0,n.getSubNode)(e,"Ad");if(!a)return t;r=(0,n.getSubNodes)(a,"MediaFile")}else r=(0,n.getSubNodes)(this.domVastObj,"MediaFile");!function(e,t,r){if(e||e.length>0)for(let a=0;a<e.length;a++)if((0,n.getNodeValue)(e[a])===r)return void c(t,e[a])}(r,t,e)}return t}}},"./src/HeaderBidding.js":
/*! ******************************!*\
  !*** ./src/HeaderBidding.js ***!
  \******************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{HeaderBidding:()=>c,test:()=>d});var a=r(/*! ./constants/events */"./src/constants/events.js");const i=["hb_bidder","hb_uuid","hb_pb"];function n(e,t,r,i){if(console.log("HB > Returned bids at prebid timeout: ",i),i&&0!==Object.keys(i).length){const r=i[Object.keys(i)[0]].bids;e.adCommunicator.dispatchEvent(a.EVENTS.PREBID,{state:"response-received",bids:r.length});const n=function(e,t){let r="";return e.hbOptions.videoAdUnit[0].bids.forEach(e=>{0===t.filter(t=>t.bidder===e.bidder).length&&(r.length>0&&(r+=","),r+=e.bidder)}),r}(e,r);n.length>0&&e.adCommunicator.dispatchEvent(a.EVENTS.PREBID,{state:"no-bids",bidders:n}),t(i)}else e.adCommunicator.dispatchEvent(a.EVENTS.PREBID,{state:"request-failed",message:"Prebid.js returned no bids"}),r(new Error("Prebid.js returned no bids"))}function s(e){return new Promise((t,r)=>{if(Array.isArray(e.hbOptions.videoAdUnit)&&0!==e.hbOptions.videoAdUnit.length&&e.hbOptions.videoAdUnit[0].bids&&0!==e.hbOptions.videoAdUnit[0].bids.length){let t=[];e.hbOptions.videoAdUnit[0].bids.forEach(e=>{t.push(e.bidder)});const r=e.hbOptions.mappingKey;e.adCommunicator.dispatchEvent(a.EVENTS.DEBUG,"Bidders specified in the request: ".concat(t.join(", "),"; mapping key: ").concat(r))}else e.adCommunicator.dispatchEvent(a.EVENTS.PREBID,{state:"request-failed",message:"No bidders were specified"}),r(new Error("No bidders were specified"));var i,s,o;e.adCommunicator.dispatchEvent(a.EVENTS.PREBID,{state:"request-sent",bids:e.hbOptions.videoAdUnit[0].bids.length}),e.pbjs.adUnits=[],e.pbjs.bidderSettings={standard:{storageAllowed:!0}},i=e.pbjs,s=e.hbOptions,null!==(o=s.advancedSettings)&&void 0!==o&&o.bidderSettings&&(i.bidderSettings={...i.bidderSettings,...s.advancedSettings.bidderSettings}),e.pbjs.que.push(()=>{!function(e,t,r){var i;if(null!==(i=t.advancedSettings)&&void 0!==i&&i.pbjs)for(const i in t.advancedSettings.pbjs)t.advancedSettings.pbjs.hasOwnProperty(i)&&(e[i]&&"function"==typeof e[i]?e[i].apply(null,t.advancedSettings.pbjs[i]):r.dispatchEvent(a.EVENTS.SDKWARNING,{message:"Function ".concat(i," does not exist in prebid.js")}))}(e.pbjs,e.hbOptions,e.adCommunicator),e.pbjs.addAdUnits(e.hbOptions.videoAdUnit);const i={...e.hbOptions.configs};i.cache||(i.cache={url:e.hbOptions.prebidCachePath}),i.cache.url||(i.cache.url=e.hbOptions.prebidCachePath),e.pbjs.setConfig(i);const s={bidsBackHandler:n.bind(null,e,t,r),auctionId:"auction_1"};e.hbTimeout>0&&(s.timeout=e.hbTimeout),e.pbjs.requestBids(s)})})}function o(e,t,r,i){const n=[];e.forEach((function(e){e=function e(t){let r={};for(const a in t)if("object"!=typeof t[a]||Array.isArray(t[a]))r[a]=t[a];else{const i=e(t[a]);for(const e in i)r[e]=i[e]}return r}(e);const s={};t.forEach(t=>{e.hasOwnProperty(t)?s[t]=e[t]:n.includes(t)||(i.adCommunicator.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"missing key ".concat(t)}),n.push(t))}),r.push(s)}))}function l(e,t){const r=[],n=[],s=e[Object.keys(e)[0]].bids;o(s,function(e){if(Array.isArray(e)&&e.length>0){let t=[...e];return t.includes("hb_bidder")||t.push("hb_bidder"),t}return i}(this.hbOptions.targetingKeys),r,this),function(e,t){e.forEach((function(e){const r=e.adserverTargeting,a=e.cpm,i=e.currency;t.push({adserverTargeting:r,cpm:a,currency:i})}))}(s,n),this.adCommunicator.dispatchEvent(a.EVENTS.HBDEBUG,"Bid Responses:"),this.adCommunicator.dispatchEvent(a.EVENTS.HBDEBUG,n),this.adCommunicator.dispatchEvent(a.EVENTS.HBDEBUG,"Returned Output:"),this.adCommunicator.dispatchEvent(a.EVENTS.HBDEBUG,r),t(r)}const d=function(){try{process&&process.env,0}catch(e){}return{}}();class c{constructor(e,t,r){if(this.ready=!!window.pbjs,this.loadFailed=!1,this.pbjs=null,this.hbOptions=e,this.hbOptions.prebidCachePath="https://prebid.adnxs.com/pbc/v1/cache",this.hbTimeout=e.prebidTimeout,this.hbTimeoutEnd=Date.now()+e.loadPbjsTimeout,this.hbErrorMessage=null,this.adCommunicator=t,this.requestData=r,this.ready)this.pbjs=window.pbjs||{},this.pbjs.que=this.pbjs.que||[];else{const t=this,r=document.createElement("script");r.onload=function(){t.ready=!0,t.pbjs=window.pbjs,t.pbjs.que=t.pbjs.que||[]},r.onerror=function(e){t.loadFailed=!0,t.hbErrorMessage=e.message,t.adCommunicator.dispatchEvent(a.EVENTS.PREBID,{state:"request-failed",message:"Failed to load Prebid.js"})},r.async=!0,r.type="text/javascript",r.src=e.prebidPath?e.prebidPath:"https://cdn.jsdelivr.net/npm/prebid.js@latest/dist/not-for-prod/prebid.js";document.getElementsByTagName("head")[0].appendChild(r)}}doBidding(){return new Promise((e,t)=>{if(!this.loadFailed){if(this.ready){const r=Date.now();return s(this).then(t=>{this.requestData.data.prebidResponseTime=Date.now()-r,l.bind(this)(t,e)}).catch(e=>{this.requestData.data.prebidResponseTime=Date.now()-r,t(new Error("Failed to get bids: ".concat(e.message)))})}return(r=this,new Promise((e,t)=>{const a=setInterval(()=>{(r.ready||r.loadFailed||Date.now()>=r.hbTimeoutEnd)&&(clearInterval(a),r.ready?e():t(new Error("Timeout to load prebid.js")))},10)})).then(()=>{const r=Date.now();return s(this).then(t=>{this.requestData.data.prebidResponseTime=Date.now()-r,l.bind(this)(t,e)}).catch(e=>{this.requestData.data.prebidResponseTime=Date.now()-r,t(new Error("Failed to get bids: ".concat(e.message)))})}).catch(e=>{t(new Error("Header bidding error: ".concat(e.message)))})}var r;t(new Error("Header bidding error: ".concat(this.hbErrorMessage)))})}}},"./src/adPlayer/DefaultOptions.js":
/*! ****************************************!*\
  !*** ./src/adPlayer/DefaultOptions.js ***!
  \****************************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{PlayerDefaultOption:()=>s});const a={xandrSdk:!0,xandrAdPlayer:"https://acdn.adnxs.com/video/player/vastPlayer/XandrVastPlayer.js",contentPlayerType:"videojs",msSkinCss:"ms-default.css",overlayPlayer:!0,initialPlayback:"auto",initialAudio:"on",adStartTimeout:5e3,wrapperLimit:5,allowFullscreen:!1};function i(e){return"object"==typeof e}function n(e){return null===e}class s{constructor(e){this.options=function e(t){var r,a,s;for(a=1;a<arguments.length;a++)for(s in r=arguments[a])r.hasOwnProperty(s)&&(i(t[s])&&!n(t[s])&&i(r[s])?t[s]=e({},t[s],r[s]):t[s]=r[s]);return t}({},a,e||{}),this.options.playerTechnology=["html5"]}}},"./src/adPlayer/VastPlayer.js":
/*! ************************************!*\
  !*** ./src/adPlayer/VastPlayer.js ***!
  \************************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{VastPlayer:()=>p,test:()=>u});var a=r(/*! ../constants/notifications */"./src/constants/notifications.js"),i=r(/*! ./DefaultOptions */"./src/adPlayer/DefaultOptions.js"),n=r(/*! ../utils/commonUtils */"./src/utils/commonUtils.js"),s=r(/*! ../constants/events */"./src/constants/events.js"),o=r(/*! ../constants/common */"./src/constants/common.js");function l(e){return new Promise((t,r)=>{if("videojs"===this.playerOptions.contentPlayerType&&this.playerOptions.playerElementId){if(!this.contentPlayer)return void r(new Error("Failed to instatiate content player"));this.contentPlayer.ready(()=>{this.adContainer=this.adIframe.contentWindow.document.getElementById("ad-container_"+this.playerOptions.playerElementId),this.adContainer||(this.adContainer=document.createElement("div"),this.adContainer.id="ad-container_"+this.playerOptions.playerElementId,this.adContainer.width=this.contentVideoElement.clientWidth,this.adContainer.height=this.contentVideoElement.clientHeight,this.adContainer.style.opacity=0,this.adIframe.contentWindow.document.body.appendChild(this.adContainer),e.dispatchEvent(s.EVENTS.ADSLOTSTARTED)),t()})}else r(new Error("Content player not supported or 'playerElementId' not present in player options"))})}function d(){var e;this.contentPlayer.currentTime()<.1&&this.contentPlayer.pause(),this.adContainer.style.opacity=0,this.adContainer.style.width=this.contentVideoElement.clientWidth+"px",this.adContainer.style.height=this.contentVideoElement.clientHeight+"px",this.playerOptions.initialAudio=this.contentPlayer.muted()||null!==(e=this.playerOptions.debug)&&void 0!==e&&e.disableVolumeSync?"off":"on";const t=function(e){let t=e.msSkinCss;if(""===t)return null;if(t||(t="ms-default.css"),t.indexOf("//")>=0)return t;const r=e.xandrAdPlayer?e.xandrAdPlayer:"https://acdn.adnxs.com/video/player/vastPlayer/XandrVastPlayer.js",a=r.lastIndexOf("/");return t=r.substr(0,a+1)+t,t}(this.playerOptions);t&&(this.playerOptions.msSkinCss=t),(0,n.isMobile)()&&(this.playerOptions.initialAudio="off");const r=this.adIframe.contentWindow.document.getElementsByTagName("body")[0];r.style.margin="0px",r.style.overflow="hidden",this.adIframe.style.display="",this.adIframe.contentWindow.APNVideo_VastVideoPlayer.playAdObject(this.adContainer,this.playerOptions,this.vastObj,this.playCallback)}function c(e){return((0,n.isIOS)()||(0,n.isIpad)())&&e.options.vpaid}const u=function(){try{process&&process.env,0}catch(e){}return{}}();class p{constructor(e,t,r){this.adRequestManager=r,this.requestId=e.requestId,this.loadFailed=!1,this.ready=!1,this.vastObj=null,this.playerOptions=new i.PlayerDefaultOption(e).options,this.playCallback=t,this.contentPlayer=this.playerOptions.contentPlayer,this.contentVideoElement=null,this.adContainer=null,this.xandrVideoAdPlayer=null,this.adIframe=null,this.adIframeContainer=0,this.adRunning=!1,this.allowSyncVolume=!1,this.lastVolume={volume:-1,muted:!0},this.contentPausedBeforeAdPlay=null,this.forceContentToPause=()=>{this.adRunning&&setTimeout(()=>{this.contentPlayer.pause()},0)},this.handleVolumeChange=()=>{setTimeout(()=>{var e,t;const r=this.xandrVideoAdPlayer.external.vFramework,a=r.adVideoPlayer.player().volume(),i=0===a||r.adVideoPlayer.muted();this.lastVolume.volume===a&&this.lastVolume.muted===i||(this.lastVolume.volume=a,this.lastVolume.muted=i,this.adCommunicator.dispatchEvent(s.EVENTS.VOLUMECHANGE,{volume:a,mute:i,url:null===(e=this.adRequestManager.telemetry[this.requestId].data)||void 0===e||null===(t=e.creative)||void 0===t?void 0:t.url}),this.allowSyncVolume&&(c(r)&&r.adVideoPlayer.currentTime()<.3||(this.contentPlayer.muted(r.adVideoPlayer.muted()),this.contentPlayer.volume(r.adVideoPlayer.player().volume()),this.allowSyncVolume=!1)))},10)},this.resizeCheck=new ResizeObserver(()=>{this.repositionAdPlayer()})}init(){return new Promise((e,t)=>{this.contentVideoElement=this.contentPlayer.contentEl().children[0],this.adIframeContainer=this.contentPlayer.contentEl().querySelector("#ad_iframe_container"),this.adIframeContainer?(this.adIframe=this.adIframeContainer.children[0],this.ready=!0,e()):(this.adIframeContainer=document.createElement("div"),this.adIframeContainer.style.position="absolute",this.adIframeContainer.style.zIndex=100,this.adIframeContainer.id="ad_iframe_container",this.adIframe=document.createElement("iframe"),this.adIframe.src="about:blank",this.adIframe.id="ad_iframe",this.adIframe.width=this.contentVideoElement.clientWidth,this.adIframe.height=this.contentVideoElement.clientHeight,this.adIframe.style.opacity=1,this.adIframe.style.borderWidth="0px",this.adIframe.onload=()=>{(0,n.loadScript)(this.playerOptions.xandrAdPlayer?this.playerOptions.xandrAdPlayer:"https://acdn.adnxs.com/video/player/vastPlayer/XandrVastPlayer.js","XandrVastPlayer",this.adIframe.contentWindow.document.getElementsByTagName("head")[0]).then(()=>{this.ready=!0,e()}).catch(e=>{this.loadFailed=!0,this.adIframeContainer.remove(),this.adRequestManager.telemetry[this.requestId]&&(this.adRequestManager.telemetry[this.requestId].data.outcome=e,this.adRequestManager.telemetry[this.requestId].data.errCode=o.SDK_ERROR.PLAYER_LOAD.CODE),t(new Error(e))})},this.adIframeContainer.appendChild(this.adIframe),this.contentVideoElement.after(this.adIframeContainer))})}destroy(e){this.resizeCheck.unobserve(this.contentPlayer.contentEl()),this.adRunning=!1,this.contentPlayer.off("play",this.forceContentToPause),this.adIframe.style.display="none",!e&&this.adContainer&&(this.adContainer.remove(),this.adContainer=null)}prepareToPlay(e,t){this.playerOptions.useAdObj=!0,this.playerOptions.adObj=e,this.vastObj=e,this.adCommunicator=t,this.loadFailed?this.playCallback(a.AD_PLAYER_CODE.CRITICAL_ERROR,"Xandr Ad Player failed to load"):l.bind(this)(t).then(()=>{d.bind(this)()}).catch(e=>{this.playCallback(a.AD_PLAYER_CODE.CRITICAL_ERROR,e.message)})}pauseContent(e){if(e!==o.SCHEDULE_VALUE_NOW){this.contentPlayer.pause(),this.contentPlayer.addClass("vjs-waiting");this.contentPlayer.controlBar.el_.style.display="none"}this.adContainer.style.opacity=0}pauseContentWhenAdStarted(e){if(e===o.SCHEDULE_VALUE_NOW){this.contentPlayer.pause(),this.contentPlayer.addClass("vjs-waiting");this.contentPlayer.controlBar.el_.style.display="none"}}resumeContent(){this.contentPlayer.off("play",this.forceContentToPause),(0,n.resumeContentPlayer)(this.contentPlayer,this.adRequestManager,!0),this.destroy()}showAd(e,t){if(!this.contentPausedBeforeAdPlay){if(t===o.SCHEDULE_VALUE_NOW){this.contentPlayer.pause(),this.contentPlayer.addClass("vjs-waiting");this.contentPlayer.controlBar.el_.style.display="none"}e.includes(this.contentPlayer)?setTimeout(()=>{this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.pause()},0):c(this.xandrVideoAdPlayer.external.vFramework)&&this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.one("pause",()=>{this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.currentTime()<.3&&(this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.muted(!0),setTimeout(()=>{this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.play()},0))}),this.contentVideoElement.style.opacity="0",this.adContainer.style.opacity=1,this.adIframe.style.display="",(0,n.isIOS)()&&this.contentPlayer.isFullscreen()&&this.contentPlayer.exitFullscreen(),!1===this.contentPausedBeforeAdPlay&&"auto"===this.xandrVideoAdPlayer.external.vFramework.options.initialPlayback&&setTimeout(()=>{this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.play()},0)}}repositionAdPlayer(){this.adIframe.width=this.contentVideoElement.clientWidth+"px",this.adIframe.height=this.contentVideoElement.clientHeight+"px",this.adContainer.style.width=this.contentVideoElement.clientWidth+"px",this.adContainer.style.height=this.contentVideoElement.clientHeight+"px",this.xandrVideoAdPlayer.external.options.width=this.contentVideoElement.clientWidth,this.xandrVideoAdPlayer.external.options.height=this.contentVideoElement.clientHeight,this.xandrVideoAdPlayer.external.repositionPlayer()}playAd(e,t){this.adRunning=!0;const r=()=>{var e,r;if(this.pauseContent(t),(0,n.isMobile)()?this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.muted(!0):"on"===this.playerOptions.initialAudio&&this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.muted(!1),this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.player)if(null!==(r=this.playerOptions.debug)&&void 0!==r&&r.disableVolumeSync)this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.player().volume(0),this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.muted(!0);else{const e=this.contentPlayer.muted()?0:this.contentPlayer.volume();this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.player().volume(e),this.contentPlayer.muted()?this.xandrVideoAdPlayer.external.vFramework.mute():this.xandrVideoAdPlayer.external.vFramework.unmute()}"auto"===this.xandrVideoAdPlayer.external.options.initialPlayback&&this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.play(),this.adContainer.style.width=this.contentVideoElement.clientWidth+"px",this.adContainer.style.height=this.contentVideoElement.clientHeight+"px",null!==(e=this.playerOptions.debug)&&void 0!==e&&e.disableVolumeSync||this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.on("volumechange",this.handleVolumeChange),this.contentPlayer.on("play",this.forceContentToPause);const a=()=>{setTimeout(()=>{!this.contentPlayer.isFullscreen()&&this.adContainer&&(this.adContainer.children.length>1&&(this.adContainer.children[1].style.zIndex=0,this.adContainer.children[1].style.overflow="hidden"),this.repositionAdPlayer())},0)};this.contentPlayer.isFullscreen()?(0,n.isIOS)()||(setTimeout(()=>{this.adContainer.children[1].style.zIndex=101,this.adContainer.children[1].style.overflow=""},0),this.repositionAdPlayer(),this.contentPlayer.one("fullscreenchange",a)):this.xandrVideoAdPlayer.external.repositionPlayer(),this.resizeCheck.observe(this.contentPlayer.contentEl())};var a;(this.contentPausedBeforeAdPlay=null===this.contentPausedBeforeAdPlay&&this.contentPlayer.paused(),this.contentPausedBeforeAdPlay&&this.playerOptions.debug&&this.playerOptions.debug.allowAdToPlayWhenContentPaused&&(this.contentPausedBeforeAdPlay=!1),this.contentPausedBeforeAdPlay&&t===o.SCHEDULE_VALUE_NOW)?(e(),null!==(a=this.xandrVideoAdPlayer.external.vFramework)&&void 0!==a&&a.adVideoPlayer&&(this.xandrVideoAdPlayer.external.vFramework.options.initialPlayback="click",this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.options_.initialPlayback="click"),this.adIframe.parentElement.style.left="-5000px",this.contentPlayer.one("play",e=>{this.adIframe.parentElement.style.left="",this.contentPausedBeforeAdPlay=!1,this.xandrVideoAdPlayer.external.vFramework.options.initialPlayback="auto",this.xandrVideoAdPlayer.external.vFramework.adVideoPlayer.options_.initialPlayback="auto",r(),this.xandrVideoAdPlayer.external.vFramework.play()})):(this.contentPausedBeforeAdPlay=!1,r())}pauseRunningAd(e,t){this.adRunning&&this.contentPlayer===t&&(e?this.xandrVideoAdPlayer.external.vFramework.pause():this.xandrVideoAdPlayer.external.vFramework.play())}}},"./src/adRequestUtils/hbRequestUtils.js":
/*! **********************************************!*\
  !*** ./src/adRequestUtils/hbRequestUtils.js ***!
  \**********************************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{getHbParamsForPtvCall:()=>p,test:()=>u});var a=r(/*! ../constants/events */"./src/constants/events.js"),i=r(/*! ../constants/statuses */"./src/constants/statuses.js"),n=r(/*! ../utils/commonUtils */"./src/utils/commonUtils.js"),s=r(/*! ../HeaderBidding */"./src/HeaderBidding.js");function o(e,t,r,i){return Array.isArray(e)&&e.some(e=>"object"==typeof e)?e:(i.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:r}),t)}function l(e,t,r,i,n,s){if(e.hasOwnProperty("mapping")&&0!==e.mapping.trim().length){const{prebidBiddersArr:a,mappedkey:l}=function(e,t,r,a,i,n){if(e.mapping===t)return{prebidBiddersArr:r=e.bidderSpecs[t],mappedkey:a=t};if(e.mapping!==t&&e.bidderSpecs.hasOwnProperty("default")&&i===t)return{prebidBiddersArr:r=e.bidderSpecs.default,mappedkey:a};if(e.mapping!==t&&!e.bidderSpecs.hasOwnProperty("default")){const t="The default key is not defined.";return{prebidBiddersArr:r=o(e.bidderSpecs,r,t,n),mappedkey:a}}return{prebidBiddersArr:r,mappedkey:a}}(e,t,r,i,n,s);if(r=a,i=l,0!==a.length)return{biddersArr:r,prebidObjkey:i}}else{if(e.hasOwnProperty("mapping")&&0===e.mapping.trim().length&&e.bidderSpecs.hasOwnProperty("default"))return s.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"The mapping value is not defined. The default key is used."}),{biddersArr:r=e.bidderSpecs.default,prebidObjkey:i};if(!e.hasOwnProperty("mapping")&&e.bidderSpecs.hasOwnProperty("default"))return s.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"The mapping key and value are not defined. The default key is used."}),{biddersArr:r=e.bidderSpecs.default,prebidObjkey:i};if((!e.hasOwnProperty("mapping")||e.hasOwnProperty("mapping")&&0===e.mapping.trim().length)&&!e.bidderSpecs.hasOwnProperty("default")){const t="The mapping key, value and default key are not defined.";return{biddersArr:r=o(e.bidderSpecs,r,t,s),prebidObjkey:i}}}return{biddersArr:r,prebidObjkey:i}}function d(e,t){let r=[],a="default";const i=Object.keys(t.bidderSpecs).slice(-1).toString();for(const n of Object.keys(t.bidderSpecs)){const{biddersArr:s,prebidObjkey:o}=l(t,n,r,a,i,e);if(r=s,a=o,r.length>0)break}return{biddersArr:r,prebidObjkey:a}}async function c(e,t,r,i){if(!0===e.enabled&&e.bidderSpecs)if("string"==typeof e.bidderSpecs){const{biddersArr:s,key:o}=await async function(e,t){let r=[];if(0===e.bidderSpecs.trim().length)return t.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"bidderSpecs url is empty."}),{biddersArr:[],key:"default"};const i=await fetch(e.bidderSpecs,{headers:{"Content-Type":"text/plain"}});if(!i.ok)return t.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"bidderSpecs object is empty."}),{biddersArr:[],key:"default"};if(e.macros){const a=await i.text();r=(0,n.substituteMacrosInBidderSpecs)(a,e.macros,t)}else r=await i.json();if(!Object.keys(r).length)return t.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"bidderSpecs object is empty."}),{biddersArr:[],key:"default"};e.bidderSpecs=r;const{biddersArr:s,prebidObjkey:o}=d(t,e);return{biddersArr:s,key:o}}(e,i);r=s,t=o}else if("object"==typeof e.bidderSpecs){const{biddersArr:s,key:o}=function(e,t){if(!Object.keys(e.bidderSpecs).length)return t.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"bidderSpecs object is empty."}),{biddersArr:[],key:"default"};if(e.macros){let r={};const a=JSON.stringify(e.bidderSpecs);r=(0,n.substituteMacrosInBidderSpecs)(a,e.macros,t),e.bidderSpecs=r}const{biddersArr:r,prebidObjkey:i}=d(t,e);return{biddersArr:r,key:i}}(e,i);r=s,t=o}return{biddersArr:r,key:t}}const u=function(){try{process&&process.env,0}catch(e){}return{}}();async function p(e,t,r){let n=[],o="default",l=function(e,t){var r,a,i,n;if(null!==(r=e.options)&&void 0!==r&&r.prebid&&!t.prebid)return null==e||null===(n=e.options)||void 0===n?void 0:n.prebid;if((null===(a=e.options)||void 0===a||!a.prebid)&&t.prebid)return t.prebid;if(!(null!==(i=e.options)&&void 0!==i&&i.prebid||t.prebid))return{enabled:!1};const s={},o=e=>Array.isArray(e)?[...e]:"object"==typeof e?{...e}:e,l=r=>{var a,i,n;null!==(a=t.prebid)&&void 0!==a&&a.hasOwnProperty(r)?s[r]=o(t.prebid[r]):null!==(i=e.options)&&void 0!==i&&null!==(n=i.prebid)&&void 0!==n&&n.hasOwnProperty(r)&&(s[r]=o(e.options.prebid[r]))};return l("enabled"),l("prebidPath"),l("configs"),l("timeout"),l("keyValueNames"),l("bidderSpecs"),l("mapping"),l("macros"),l("advancedSettings"),s}(this.sdkInstance,e);if(!l.enabled)return r.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"prebid disabled."}),Promise.resolve([]);try{const{biddersArr:e,key:t}=await c(l,o,n,r);n=e,o=t}catch(e){r.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"Failed to load Bidders data  ".concat(e.message,".")})}if(!n||0===n.length)return r.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"Missing bidders for header bidding."}),Promise.resolve([]);console.log("HB > Bidder specs for prebid call after mapping: ",n);const d=e.contentPlayer.el_,u=e.playerElementId+"_"+Date.now(),p={prebidPath:l.prebidPath,prebidTimeout:l.timeout||-1,loadPbjsTimeout:t,targetingKeys:l.keyValueNames||[],mappingKey:o,videoAdUnit:[{code:u,mediaTypes:{video:{context:"instream",playerSize:[d.clientWidth,d.clientHeight],mimes:["video/mp4","video/webm","video/ogg","video/x-ms-wmv","video/x-msvideo","video/mpeg","video/quicktime","video/3gpp","video/3gpp2","video/x-m4v","application/javascript","application/x-javascript"],protocols:[2,3,4,5,6,7,8],placement:1,minduration:1,maxduration:33,api:[1,2],linearity:1,playbackmethod:[2],startdelay:0}},bids:n}],configs:l.configs||{},advancedSettings:l.advancedSettings||{}};!function(e){e.advancedSettings.adUnits&&(e.videoAdUnit[0]={...e.videoAdUnit[0],...e.advancedSettings.adUnits})}(p),p.prebidPath||r.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"prebidPath not specified."});const h=this.telemetry[e.requestId],f=new s.HeaderBidding(p,r,h);return e.demo&&r.dispatchEvent(a.EVENTS.DEBUG,{type:"flow",status:i.FLOW.PREBIDJSCALL}),f.doBidding().then(t=>(e.demo&&r.dispatchEvent(a.EVENTS.DEBUG,{type:"flow",status:i.FLOW.PREBIDJSRESPONSE}),Promise.resolve(t))).catch(t=>(e.demo&&r.dispatchEvent(a.EVENTS.DEBUG,{type:"flow",status:i.FLOW.PREBIDJSFAILED}),r.dispatchEvent(a.EVENTS.PREBID,{state:"warning",message:"Header bidding failed. Error: ".concat(t.message,". Continue with PTV call.")}),Promise.resolve([])))}},"./src/adRequestUtils/playFlatVast.js":
/*! ********************************************!*\
  !*** ./src/adRequestUtils/playFlatVast.js ***!
  \********************************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{playFlatVast:()=>E,reportSdkTimeoutForRequest:()=>b,test:()=>v});var a=r(/*! ../adPlayer/VastPlayer */"./src/adPlayer/VastPlayer.js"),i=r(/*! ../constants/notifications */"./src/constants/notifications.js"),n=r(/*! ../constants/events */"./src/constants/events.js"),s=r(/*! ../constants/statuses */"./src/constants/statuses.js"),o=r(/*! ../utils/commonUtils */"./src/utils/commonUtils.js"),l=r(/*! ../constants/common */"./src/constants/common.js");function d(e,t,r,a){a();const i="Player critical error. Error: ".concat(t);this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.SDKERROR,{message:i}),r.destroy(),this.telemetry[e.requestId]&&(this.telemetry[e.requestId].data.outcome="failed",this.telemetry[e.requestId].data.failedTime=Date.now(),this.logRequestTelemetry(e.requestId)),this.fallbackRequestData[e.requestId]&&delete this.fallbackRequestData[e.requestId]}function c(e,t,r,a,i,l){l();const d=this.fallbackRequestData[e.requestId].vastSelectedPriority-1;if(t&&t.errorUrls&&t.errorUrls.length>0)(0,o.trackErrorUrls)(t.errorUrls);else{var c,u,p;const t=null===(c=this.fallbackRequestData[e.requestId])||void 0===c||null===(u=c.fallbackVastInfo[d])||void 0===u||null===(p=u.flatVastObj)||void 0===p?void 0:p.errorUrls;if(t&&t.length>0){const r=this.fallbackRequestData[e.requestId].fallbackVastInfo[d].getErrorCode();(0,o.trackErrorUrls)(t,r)}}let h={errorCode:t.code,message:t.message};if(0===t.code){const t=this.fallbackRequestData[e.requestId].fallbackVastInfo[d].getErrorCode();isNaN(t)||0===t||(h={errorCode:t,message:""})}h.fallback="".concat(d+1,"/").concat(this.fallbackRequestData[e.requestId].fallbackVastInfo.length),h.adid=this.fallbackRequestData[e.requestId].fallbackVastInfo[d].getAdId();const f="Ad #".concat(a.adNumber," failed. Error: ").concat(t?JSON.stringify(t):"no data");return this.fallbackRequestData[e.requestId].fallbackVastInfo[d].status=s.FALLBACK.STEPFAILED,this.fallbackRequestData[e.requestId].fallbackVastInfo[d].setErrorCode(t.code),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.FALLBACK,{index:d+1,state:"failed",message:t.message}),e.demo&&this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,{type:"flow",status:s.FLOW.ADFAILED}),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,f),this.getNextFallbackVast(e.requestId).then(t=>{const a=i-Date.now()+36e5;var s;if(this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,"INFO: Remaining timeout for next fallback step = "+a),a>0)return r.destroy(!0),this.telemetry[e.requestId].data.adSelectedToPlay=null===(s=t.vastObject)||void 0===s?void 0:s.adNumber,void E.bind(this)(e,t.vastObject,a);b.bind(this)(e.requestId),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.ADSLOTENDED),this.fallbackRequestData[e.requestId].adRunning=!1,r.resumeContent(),this.telemetry[e.requestId]&&(h.errorCode&&(this.telemetry[e.requestId].data.errCode=h.errorCode),this.telemetry[e.requestId].data.outcome=h.message&&h.message.length>0?h.message:"failed",this.telemetry[e.requestId].data.failedTime=Date.now(),this.logRequestTelemetry(e.requestId)),this.fallbackRequestData[e.requestId]&&delete this.fallbackRequestData[e.requestId]}).catch(t=>{this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent("video-failed",h),(0,o.trackUrl)(this.fallbackRequestData[e.requestId].fallbackVastInfo[d].firstPartyErrorUrl),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,t.message),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.ADSLOTENDED),this.fallbackRequestData[e.requestId].adRunning=!1,r.resumeContent(),this.telemetry[e.requestId]&&(h.errorCode&&(this.telemetry[e.requestId].data.errCode=h.errorCode),this.telemetry[e.requestId].data.outcome=h.message&&h.message.length>0?h.message:"failed",this.telemetry[e.requestId].data.failedTime=Date.now(),this.logRequestTelemetry(e.requestId)),this.fallbackRequestData[e.requestId]&&delete this.fallbackRequestData[e.requestId]})}function u(e,t,r,a){let i;i="boolean"==typeof t?"Ad #".concat(a.adNumber," complete: ").concat(t?"skipped":"not skipped"):"Ad #".concat(a.adNumber," complete: ").concat(t?"ad container id = "+t.id:"no data"),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,i);const o=r.requestId,l=this.fallbackRequestData[o].vastSelectedPriority-1;if(this.fallbackRequestData[o].fallbackVastInfo[l].status=s.FALLBACK.STEPSUCCESS,t){let t=5;e.skippable&&e.skippable.videoOffset?t=e.skippable.videoOffset:this.fallbackRequestData[o].fallbackVastInfo[l].flatVastObj.skipOffset&&(t=this.fallbackRequestData[o].fallbackVastInfo[l].flatVastObj.skipOffset),this.fallbackRequestData[o].adCommunicator.dispatchEvent("video-skip",{skipOffset:t})}else this.fallbackRequestData[o].adCommunicator.dispatchEvent("video-complete"),this.fallbackRequestData[o].adCommunicator.dispatchEvent("complete");this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent("adended",{type:t?"skipped":"complete"}),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.ADSLOTENDED),this.fallbackRequestData[e.requestId].adRunning=!1,r.resumeContent(),r.destroy(),this.fallbackRequestData[o]&&delete this.fallbackRequestData[o]}function p(e,t,r,a,i){const o="Ad #".concat(a.adNumber," ready to play: ").concat(t?"ad container id = "+t.id:"no data");this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,o);const l=this.fallbackRequestData[e.requestId].vastSelectedPriority-1;this.fallbackRequestData[e.requestId].fallbackVastInfo[l].status=s.FALLBACK.STEPREADY,e.demo&&this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,{type:"flow",status:s.FLOW.PRIORITY,priority:this.fallbackRequestData[e.requestId].vastSelectedPriority}),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.ADPLAYERREADY),r.playAd(i,e.schedule)}function h(e,t,r,a){a(),this.telemetry[e.requestId].data.outcome="ad played",t.showAd(this.contentPlayersForcedToPauseAd);const i="Ad #".concat(r.adNumber," start playing: no data");this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,i);const o=this.fallbackRequestData[e.requestId].vastSelectedPriority-1;this.fallbackRequestData[e.requestId].fallbackVastInfo[o].status=s.FALLBACK.STEPSTART,e.demo&&this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,{type:"flow",status:s.FLOW.ADPLAYED}),t.pauseContentWhenAdStarted(e.schedule),this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.FALLBACK,{index:o+1,state:"played"});const l=this.fallbackRequestData[e.requestId].fallbackVastInfo[o].flatVastObj.durationMsecs/1e3;if(this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.ADDURATION,{duration:l>0?l:s.STATUS.UNKNOWN}),this.fallbackRequestData[e.requestId].creativedata){const t=this.fallbackRequestData[e.requestId].creativedata,r=this.fallbackRequestData[e.requestId].fallbackVastInfo[o].getCreativeDataByUrl(t.url);this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.CREATIVEDATA,r),this.telemetry[e.requestId].data.creative={url:t.url,type:r.type}}this.logRequestTelemetry(e.requestId)}function f(e,t,r,a){"volume-change"===t.event&&(r.allowSyncVolume=!0);const i=n.XANDR_MSN_EVENT_MAP[t.event];if("video-complete"!==t.event&&"video-skip"!==t.event&&i&&"aderror"!==i[0]){if("impression"!==t.event&&"AdImpression"!==t.event||a(),"AdPaused"===t.event||"video-pause"===t.event){const t=this.fallbackRequestData[e.requestId].lastPauseEventTime;if(t&&Date.now()-t<100)return;this.fallbackRequestData[e.requestId].lastPauseEventTime=Date.now()}t.slotId=r.playerOptions.playerElementId,this.fallbackRequestData[e.requestId].adCommunicator&&this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(t.event,t.data)}}function g(e,t,r,a,i){const s="Ad #".concat(r.adNumber," click mode: ").concat(t?"clicked":"ready to click");this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,s),a(),t||i.showAd(this.contentPlayersForcedToPauseAd)}function m(e,t){t.type&&t.value&&(this.fallbackRequestData[e.requestId][t.type]=t.value)}const v=function(){try{process&&process.env,0}catch(e){}return{}}();function b(e,t){if(!this.fallbackRequestData[e].sdkTimeoutReported){if(this.fallbackRequestData[e].sdkTimeoutReported=!0,this.telemetry[e].data.errCode=l.SDK_ERROR.TIMEOUT.CODE,this.telemetry[e].data.outcome=l.SDK_ERROR.TIMEOUT.MESSAGE,this.logRequestTelemetry(e),this.fallbackRequestData[e].vastSelectedPriority>0){const t=this.fallbackRequestData[e].vastSelectedPriority-1;this.fallbackRequestData[e].fallbackVastInfo[t].setErrorCode(l.SDK_ERROR.TIMEOUT.CODE),(0,o.trackUrl)(this.fallbackRequestData[e].fallbackVastInfo[t].firstPartyErrorUrl)}t?(t.dispatchEvent(n.EVENTS.SDKTIMEOUT),t.dispatchEvent(n.EVENTS.ADSLOTENDED)):this.fallbackRequestData[e].adCommunicator&&(this.fallbackRequestData[e].adCommunicator.dispatchEvent(n.EVENTS.SDKTIMEOUT),this.fallbackRequestData[e].adCommunicator.dispatchEvent(n.EVENTS.ADSLOTENDED))}}function E(e,t,r){let s=Date.now()+r,o=t;for(let t=0;t<this.adPlayers.length;t++)if(this.adPlayers[t].playerOptions.playerElementId===e.playerElementId){this.adPlayers.splice(t,1);break}let v=null;const E=()=>{v&&(clearTimeout(v),v=null)};!function(e){if(e.companionContainers){const t=[];e.companionContainers.forEach(e=>{if("string"==typeof e){const r=document.getElementById(e);r&&t.push(r)}else t.push(e)}),e.companionContainers=t}}(e);const y=(e,t)=>{e&&Math.abs(t-e.duration())<.1&&(e.trigger("ended"),e.trigger("timeupdate"))},A=new a.VastPlayer(e,(t,r)=>{const a=this.adPlayers.find(t=>t.requestId===e.requestId);switch(t){case i.AD_PLAYER_CODE.CRITICAL_ERROR:d.bind(this)(e,r,a,E),y(e.contentPlayer,e.schedule);break;case i.AD_PLAYER_CODE.FAILED:c.bind(this)(e,r,a,o,s,E),y(e.contentPlayer,e.schedule);break;case i.AD_PLAYER_CODE.COMPLETE:u.bind(this)(e,r,a,o),y(e.contentPlayer,e.schedule);break;case i.AD_PLAYER_CODE.READY_TO_PLAY:this.telemetry[e.requestId].data.playerReady=Date.now(),p.bind(this)(e,r,a,o,E);break;case i.AD_PLAYER_CODE.IGNORE_TO_PLAY:{const t="Ad #".concat(o.adNumber," ignore to play: ").concat(r?"skipped":"not skipped");this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,t),y(e.contentPlayer,e.schedule);break}case i.AD_PLAYER_CODE.START_PLYING:this.telemetry[e.requestId].data.playerShow=Date.now(),h.bind(this)(e,a,o,E);break;case i.AD_PLAYER_CODE.INITIALIZED:{const t="Ad #".concat(o.adNumber," player initialized");this.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.DEBUG,t),A.xandrVideoAdPlayer=r;break}case i.AD_PLAYER_CODE.CLICK_MODE:g.bind(this)(e,r,o,E,a);break;case i.AD_PLAYER_CODE.AD_EVENT:f.bind(this)(e,r,a,E);break;case i.AD_PLAYER_CODE.FOR_SDK:m.bind(this)(e,r)}},this),T=this;A.init().then(()=>{this.adPlayers.push(A),v=setTimeout(()=>{clearTimeout(v),v=null,A.resumeContent(),this.telemetry[e.requestId].data.errCode=l.SDK_ERROR.TIMEOUT.CODE,this.telemetry[e.requestId].data.outcome=l.SDK_ERROR.TIMEOUT.MESSAGE,this.logRequestTelemetry(e.requestId),this.fallbackRequestData[e.requestId]&&(this.fallbackRequestData[e.requestId].adRunning=!1,b.bind(this)(e.requestId),delete this.fallbackRequestData[e.requestId]),y(e.contentPlayer,e.schedule)},r),A.prepareToPlay(t,this.fallbackRequestData[e.requestId].adCommunicator)}).catch(t=>{const r="Player critical error. Error: ".concat(t.message);if(A.destroy(),T.telemetry[e.requestId].data.outcome=t.message,T.logRequestTelemetry(e.requestId),e.schedule===l.SCHEDULE_VALUE_NOW){0===T.contentPlayersForcedToPauseAd.filter(t=>t===e.contentPlayer).length&&e.contentPlayer.play()}T.fallbackRequestData[e.requestId]&&(T.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.SDKERROR,{message:r}),T.fallbackRequestData[e.requestId].adCommunicator.dispatchEvent(n.EVENTS.ADSLOTENDED),delete T.fallbackRequestData[e.requestId]),y(e.contentPlayer,e.schedule)})}},"./src/adRequestUtils/ptvRequestUtils.js":
/*! ***********************************************!*\
  !*** ./src/adRequestUtils/ptvRequestUtils.js ***!
  \***********************************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{makePtvCall:()=>h,test:()=>p});var a=r(/*! ../constants/events */"./src/constants/events.js"),i=r(/*! ../constants/statuses */"./src/constants/statuses.js"),n=r(/*! ./hbRequestUtils */"./src/adRequestUtils/hbRequestUtils.js"),s=r(/*! videoads-util-url-loader */"./node_modules/videoads-util-url-loader/src/UrlLoader.js"),o=r(/*! ../utils/commonUtils */"./src/utils/commonUtils.js"),l=r(/*! ../constants/common */"./src/constants/common.js");function d(e,t,r){t.demo&&e.dispatchEvent(a.EVENTS.DEBUG,{type:"flow",status:r})}function c(e,t,r,n,o,c){if(e){const u=Date.now();(0,s.load)(e,(r,s)=>{this.telemetry[t.requestId].data.ptvResponseTime=Date.now()-u,r||0===s.length?(d(n,t,i.FLOW.PTVFAILED),"Timeout"===r?(this.telemetry[t.requestId].data.errCode=l.SDK_ERROR.TIMEOUT.CODE,n.dispatchEvent(a.EVENTS.ADREQUESTFAILED,{message:"PTV call TIMED OUT: "+e}),c(new Error("PTV call TIMED OUT: "+e))):(n.dispatchEvent(a.EVENTS.ADREQUESTFAILED,{message:"No response for PTV call: "+e}),c(new Error("No response for PTV call: "+e)))):(d(n,t,i.FLOW.PTVCALL),o(s))},r)}}function u(e,t,r,i,n,s,o){var d;let c=e;if(c+=c.indexOf("?")>0?"&":"?",c+="cachebuster=".concat(Date.now()),c+=function(e){let t="";return Array.isArray(e)&&e.length>0&&e.forEach(e=>{const r=e.hb_bidder?"_".concat(e.hb_bidder):"";for(let a in e)"hb_bidder"!==a&&(t+="&kw_".concat(a+r,"=").concat(encodeURIComponent(e[a])))}),t}(r),s.dispatchEvent(a.EVENTS.DEBUG,"PTV URL: ".concat(c)),s.dispatchEvent(a.EVENTS.DEBUG,"PTV URL length: ".concat(c.length)),null!==(d=t.debug)&&void 0!==d&&d.noRendering)return s.dispatchEvent(a.EVENTS.DEBUG,"Process interrupted by debug.noRendering option"),o(new Error("Process interrupted by debug.noRendering option")),null;return i-(Date.now()-n)<=0?(this.telemetry[t.requestId].data.errCode=l.SDK_ERROR.TIMEOUT.CODE,s.dispatchEvent(a.EVENTS.SDKTIMEOUT),o(new Error("TIMED OUT (no time remaining for PTV call): "+c)),null):c}const p=function(){try{process&&process.env,0}catch(e){}return{}}();function h(e,t,r){var s;if(!e)return r.dispatchEvent(a.EVENTS.SDKERROR,{message:"PTV call failed: missing options."}),Promise.reject(new Error("PTV call failed: missing options."));let l;if(null!==(s=e.debug)&&void 0!==s&&s.ptvUrl)l=e.debug.ptvUrl;else if(e.targeting)if(e.targeting.hasOwnProperty("adTagUrl")){if("string"!=typeof e.targeting.adTagUrl)return r.dispatchEvent(a.EVENTS.SDKERROR,{message:"The url provided in `adTagUrl` targeting setting is invalid and must be a string within options for playAd(...) call"}),r.dispatchEvent(a.EVENTS.ADSLOTENDED),Promise.reject(new Error("The url provided in `adTagUrl` targeting setting is invalid and must be a string within options for playAd(...) call"));if(l=e.targeting.adTagUrl.trim(),!(0,o.isImpbusUrl)(l))return r.dispatchEvent(a.EVENTS.SDKERROR,{message:"The url provided in 'adTagUrl' targeting setting does not represent a call to the Xandr platform"}),Promise.reject(new Error("The url provided in 'adTagUrl' targeting setting does not represent a call to the Xandr platform"));e.prebid={enabled:!1}}else{var p;const t=e.targeting,n=function(e){let t="";return null!=e&&e.placementId?Number.isInteger(e.placementId)?(t="id=".concat(e.placementId),t):"":null!=e&&e.inventoryCode&&2===Object.keys(e.inventoryCode).length&&e.inventoryCode.hasOwnProperty("memberId")&&e.inventoryCode.hasOwnProperty("invCode")&&Number.isInteger(e.inventoryCode.memberId)?(t="member=".concat(e.inventoryCode.memberId,"&inv_code=").concat(encodeURIComponent(e.inventoryCode.invCode)),t):""}(t);if(!n)return d(r,e,i.FLOW.PTVFAILED),r.dispatchEvent(a.EVENTS.SDKERROR,{message:"The placementId or inventoryCode in targeting setting is invalid within options for playAd(...) call"}),r.dispatchEvent(a.EVENTS.ADSLOTENDED),Promise.reject(new Error("The placementId or inventoryCode in targeting setting is invalid within options for playAd(...) call"));l="https://".concat(null!==(p=e.debug)&&void 0!==p&&p.ptvHost?e.debug.ptvHost:"ib.adnxs.com","/ptv?"),l+=n,l+=function(e,t){let r="";for(const i in e)switch(i){case"width":r+="&vwidth=".concat(e[i]);break;case"height":r+="&vheight=".concat(e[i]);break;case"frameworks":r+="&vframeworks=".concat(e[i]);break;case"vastVersion":if(e.otherParams&&e.otherParams.hasOwnProperty("vv"))t.dispatchEvent(a.EVENTS.SDKWARNING,{message:"Values for both vastVersion and otherParams.vv targeting options have been specified. The value from otherParams.vv will be used in the ad call"});else{const n=f(e[i]);n?r+="&vv=".concat(n):t.dispatchEvent(a.EVENTS.SDKWARNING,{message:"Invalid value specified for vastVersion targeting option: ".concat(e[i],";")+" The 'vv' query string parameter will be omitted from the set of query string parameters used in the ad call"})}break;case"maxDuration":r+="&vmaxduration=".concat(e[i]);break;case"referrer":r+="&referrer=".concat(encodeURIComponent(e[i]));break;case"keyValues":for(const t in e.keyValues)r+="&kw_".concat(t,"=").concat(encodeURIComponent(e.keyValues[t]));break;case"otherParams":for(const t in e.otherParams)r+="&".concat(t,"=").concat(encodeURIComponent(e.otherParams[t]))}return r}(t,r)}const h=this;return new Promise((i,s)=>{const o=Date.now();return n.getHbParamsForPtvCall.bind(h)(e,t>0?t:2e3,r).then(n=>{if(l=u.bind(this)(l,e,n,t,o,r,s),l){r.dispatchEvent(a.EVENTS.ADREQUESTED);const n=t-(Date.now()-o);c.bind(this)(l,e,n,r,i,s)}}).catch(e=>{r.dispatchEvent(a.EVENTS.SDKWARNING,{message:e.message}),s(e)})})}function f(e){const t=l.VAST_VERSION_MAPPING.find(t=>t.version===e);return t?t.value:""}},"./src/constants/common.js":
/*! *********************************!*\
  !*** ./src/constants/common.js ***!
  \*********************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{PARSING_ERROR:()=>i,POSITION:()=>a,SCHEDULE_VALUE_NOW:()=>o,SCHEDULE_VALUE_POSTROLL:()=>s,SDK_ERROR:()=>n,VAST_VERSION_MAPPING:()=>l});const a={PREROLL:"preroll",MIDROLL:"midroll",POSTROLL:"postroll"},i={100:"XML parsing error",101:"VAST schema validation error",102:"VAST version not supported",200:"Ad type is not video",204:"Invalid Ad category",205:"Ad is skipped due category violation",300:"General Wrapper error",301:"Wrapper VAST URI timeout",302:"Wrapper limit reached",303:"No VAST response after one or more Wrappers",403:"No suitable rendition available",900:"Undefined error"},n={TIMEOUT:{CODE:2001,MESSAGE:"General SDK Timeout"},PLAYER_LOAD:{CODE:2002,MESSAGE:"Failed to load VAST player script"}},s=-1,o=-2,l=[{version:"2.0",value:2},{version:"3.0",value:3},{version:"4.0",value:4},{version:"4.1",value:5},{version:"4.2",value:6}]},"./src/constants/events.js":
/*! *********************************!*\
  !*** ./src/constants/events.js ***!
  \*********************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{EVENTS:()=>a,EVENTS_DISPATCH_ONCE:()=>s,EVENT_DETAILS:()=>n,XANDR_MSN_EVENT_MAP:()=>i});const a={PLAYADCALLED:"playadcalled",ADREQUESTED:"adrequested",ADREQUESTCOMPLETE:"adrequestcomplete",ADREQUESTFAILED:"adrequestfailed",ADRECEIVED:"adreceived",NOADRECEIVED:"noadreceived",ADPLAYERREADY:"adplayerready",ADSLOTSTARTED:"adslotstarted",ADSLOTENDED:"adslotended",ADERROR:"aderror",SDKTIMEOUT:"sdktimeout",USERRULEINTERVENTION:"userruleintervention",ADSTARTED:"adstarted",ADPAUSED:"adpaused",ADRESUMED:"adresumed",ADENDED:"adended",ADPLAYED:"adplayed",ADSKIPPED:"adskipped",ADDURATION:"adduration",SDKERROR:"sdkerror",FALLBACK:"fallback",QUARTILE:"quartile",CREATIVEDATA:"creativedata",PREBID:"prebid",DEBUG:"debug",WARNING:"warning",ERROR:"error",HBDEBUG:"hbdebug",SDKWARNING:"sdkwarning",TELEMETRY:"telemetry",VOLUMECHANGE:"volumechange"},i={playadcalled:["playadcalled"],adrequested:["adrequested"],adrequestcomplete:["adrequestcomplete"],adrequestfailed:["adrequestfailed"],adreceived:["adreceived"],noadreceived:["noadreceived"],adplayerready:["adplayerready"],adslotstarted:["adslotstarted"],adslotended:["adslotended"],"video-failed":["aderror"],AdError:["aderror"],aderror:["aderror"],sdktimeout:["sdktimeout"],userruleintervention:["userruleintervention"],impression:["adstarted"],AdPaused:["adpaused"],"video-pause":["adpaused"],"video-resume":["adresumed"],adended:["adended"],"video-complete":["adplayed"],"video-skip":["adskipped","adplayed"],AdUserClose:["adskipped","adplayed"],adduration:["adduration"],sdkerror:["sdkerror"],fallback:["fallback"],"video-first-quartile":["quartile"],"video-mid":["quartile"],"video-third-quartile":["quartile"],complete:["quartile"],creativedata:["creativedata"],prebid:["prebid"],sdkwarning:["sdkwarning"],telemetry:["telemetry"],volumechange:["volumechange"],debug:["debug"],warning:["warning"],error:["error"],hbdebug:["hbdebug"]},n={playadcalled:!0,adrequested:!0,adrequestcomplete:!1,adrequestfailed:!0,adreceived:!0,noadreceived:!1,adplayerready:!1,adslotstarted:!1,adslotended:!1,aderror:!0,sdktimeout:!0,userruleintervention:!1,adstarted:!1,adpaused:!1,adresumed:!1,adended:!0,adplayed:!1,adskipped:!0,adduration:!0,sdkerror:!0,fallback:!0,quartile:!0,creativedata:!0,prebid:!0,sdkwarning:!0,telemetry:!0,volumechange:!0,debug:!0,warning:!0,error:!0,hbdebug:!0},s={playadcalled:!1,sdkerror:!1,adrequested:!1,adrequestcomplete:!1,adreceived:!1,adrequestfailed:!1,sdktimeout:!1,adskipped:!1,aderror:!1,adslotended:!1,adslotstarted:!1,adplayed:!1,noadreceived:!1,adended:!1}},"./src/constants/notifications.js":
/*! ****************************************!*\
  !*** ./src/constants/notifications.js ***!
  \****************************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{AD_PLAYER_CODE:()=>n,NOTIFICATION:()=>a,PLAY_NOTIFICATION:()=>i});const a={ERROR:"error",ADCOUNT:"ad_count",INFO:"info",WARNING:"warning",ADEVENT:"ad_event",FLOW:"flow"},i={ERROR:"error",EVENT:"event",INFO:"info",FALLBACK:"fallback"},n={FAILED:0,COMPLETE:1,READY_TO_PLAY:2,IGNORE_TO_PLAY:3,START_PLYING:4,INITIALIZED:5,CLICK_MODE:6,CRITICAL_ERROR:10,AD_EVENT:11,FOR_SDK:12}},"./src/constants/statuses.js":
/*! ***********************************!*\
  !*** ./src/constants/statuses.js ***!
  \***********************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{FALLBACK:()=>n,FLOW:()=>s,STATUS:()=>a,UNWRAPPING:()=>i});const a={UNKNOWN:-1},i={READY:"ready to start",PROGRESS:"in progress",FAILED:"failed",SUCCESS:"succeeded"},n={STEPREADY:"step ready to start",STEPSTART:"step started",STEPFAILED:"step failed",STEPSUCCESS:"step succeeded"},s={ADREQUEST:"adrequest",PREBIDJSCALL:"prebid.js call",PREBIDJSRESPONSE:"prebid.js response",PREBIDJSFAILED:"prebid.js failed",PTVCALL:"made ptv call",PTVFAILED:"ptv failed",VASTVALID:"valid vast",VASTFAILED:"invalid vast",ADPLAYED:"ad impression",ADFAILED:"ad failed",ADCOUNT:"ad count",UNWRAPPED:"unwrapped",PRIORITY:"priority",NOTPLAY:"not play"}},"./src/utils/commonUtils.js":
/*! **********************************!*\
  !*** ./src/utils/commonUtils.js ***!
  \**********************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{getRequestId:()=>c,isIOS:()=>g,isImpbusUrl:()=>b,isIpad:()=>m,isMobile:()=>h,isSafari:()=>f,loadScript:()=>u,resumeContentPlayer:()=>v,substituteMacrosInBidderSpecs:()=>p,trackErrorUrls:()=>l,trackUrl:()=>d});var a=r(/*! ../constants/events */"./src/constants/events.js"),i=r(/*! ../constants/common */"./src/constants/common.js"),n=r(/*! videoads-util-url-loader */"./node_modules/videoads-util-url-loader/src/UrlLoader.js"),s=r(/*! @appnexus/videoads-util-user-agent-parser */"./node_modules/@appnexus/videoads-util-user-agent-parser/src/UserAgentParser.js"),o=r.n(s);const l=(e,t)=>{e.forEach(e=>{t&&("string"==typeof e?e=e.replace("[ERRORCODE]",t):"object"==typeof e&&e.url&&(e.url=e.url.replace("[ERRORCODE]",t))),(0,n.trackPixel)(e,"error")})},d=e=>{e&&(0,n.trackPixel)(e,"error")},c=()=>{const e=window.crypto||window.msCrypto;return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))},u=(e,t,r)=>new Promise((a,i)=>{const n=document.createElement("script");n.async=!0,n.type="text/javascript",n.src=e,t&&(n.id=t),n.onload=()=>{a()},n.onerror=e=>{i(e.message||"Failed to load Xandr Vast Player script")};(r||document.getElementsByTagName("head")[0]).appendChild(n)}),p=(e,t,r)=>{console.log("HB > Input Bidder specs: ",e),console.log("HB > Macros data for substitution: ",t);for(const r in t){const a=t[r];let i,n;"string"!=typeof a&&(n='"\\$'+r+'\\$"',i=new RegExp(n,"g"),e=e.replace(i,a),n="'\\$"+r+"\\$'",i=new RegExp(n,"g"),e=e.replace(i,a)),n="\\$"+r+"\\$",i=new RegExp(n,"g"),e=e.replace(i,a)}console.log("HB > Bidder specs after macros substitution: ",e);try{return JSON.parse(e)}catch(e){return r.dispatchEvent(a.EVENTS.SDKWARNING,{message:"JSON parser failed after macro substitution"}),{}}},h=()=>navigator.appVersion.indexOf("Mobile")>-1||navigator.appVersion.indexOf("Android")>-1||m(),f=()=>"safari"===o()().browser.name.toLowerCase();function g(){var e,t;return"ios"===(null===(e=o()().os)||void 0===e||null===(t=e.name)||void 0===t?void 0:t.toLowerCase())}function m(){return navigator.userAgent.toLowerCase().match(/mac/)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2}function v(e,t,r){let a=!1;if((null==t?void 0:t.requests.length)>0)for(let r=0;r<t.requests.length;r++){const s=t.requests[r];var n;if(s.contentPlayer===e)if((null===(n=t.fallbackRequestData[s.requestId])||void 0===n||!n.adRunning)&&(s.schedule===i.SCHEDULE_VALUE_NOW||Math.abs(s.schedule-e.currentTime())<=.5)){a=!0;break}}if(a)e.currentTime()<e.duration()&&e.trigger("timeupdate");else{const t=e.contentEl().children[0];e.removeClass("vjs-waiting"),t.style.opacity="";e.controlBar.el_.style.display="flex";Math.abs(e.duration()-e.currentTime())>=.5&&(e.trigger("timeupdate"),r&&e.play())}}function b(e){const t=new URL("string"==typeof e?e:e.url);return t.hostname.indexOf("ib.adnxs.com")>=0||t.hostname.indexOf("ib.adnxs-simple.com")>=0}},"./src/utils/xmlHelper.js":
/*! ********************************!*\
  !*** ./src/utils/xmlHelper.js ***!
  \********************************/(e,t,r)=>{"use strict";r.r(t),r.d(t,{getFallbackIndex:()=>l,getFallbackOnNoAd:()=>d,getNodeAttributeValue:()=>s,getNodeValue:()=>n,getSubNode:()=>i,getSubNodes:()=>a,getVASTVersion:()=>o});const a=(e,t)=>{const r=e.getElementsByTagName(t);return r.length>0?r:null},i=(e,t,r)=>{r||(r=0);const a=e.getElementsByTagName(t);return a.length>r?a[r]:null},n=e=>{if(0===e.childNodes.length)return"";let t="";for(let r=0;r<e.childNodes.length;r++)e.childNodes[r].nodeValue&&(t+=e.childNodes[r].nodeValue);return t.trim()},s=(e,t)=>{let r=e.getAttribute(t);return null===r&&(r=""),r},o=e=>{let t="unknown";return e&&(t=s(e,"version"),t=t.trim(),t.length>3&&(t=t.substring(0,3))),t},l=e=>{const t=a(e,"Extension");if(!t)return 999;for(let e=0;e<t.length;e++){const r=s(t[e],"fallback_index");if(""!==r)return parseInt(r)}return 999},d=e=>{const t=i(e,"Wrapper");return t?s(t,"fallbackOnNoAd"):""}},"./node_modules/videoads-util-cache-manager/src/CacheManager.js":
/*! **********************************************************************!*\
  !*** ./node_modules/videoads-util-cache-manager/src/CacheManager.js ***!
  \**********************************************************************/(e,t,r)=>{var a=r(/*! videoads-util-misc-general */"./node_modules/videoads-util-misc-general/src/GeneralUtilities.js"),i=24e5,n={},s=2;function o(e,t,r){switch(s){case 0:case 1:break;default:case 2:!function(e,t){n&&(n[e]=t)}(e,t)}}function l(e){switch(s){case 0:case 1:return null;default:case 2:return function(e){if(n)return n[e]}(e)}}function d(e){switch(s){case 0:case 1:break;default:case 2:!function(e){n&&delete n[e]}(e)}}function c(e){return"apn_"+e}a.debug("Using Cache Method "+s,"Cache Manager"),e.exports={setGenericData:function(e,t){if(void 0!==e&&void 0!==t){e="___appnexus_video_cachemanager_generic_data___"+e;try{return o(e,t),!0}catch(e){}}return!1},getGenericData:function(e){if(void 0!==e)return l(e="___appnexus_video_cachemanager_generic_data___"+e)},deleteGenericData:function(e){void 0!==e&&d(e="___appnexus_video_cachemanager_generic_data___"+e)},forceStorageMethod:function(e){s=e,a.debug("Forced usage of cache method "+s,"Cache Manager")},addAd:function(e,t){e&&function(e,t){var r={};r.timestamp=(new Date).getTime(),r.ad=e;try{o(t,JSON.stringify(r))}catch(e){}}(e,c(t))},getAd:function(e){return function(e){var t,r=(new Date).getTime();try{var a=l(e);t=a&&JSON.parse(a),d(e)}catch(e){}return t&&t.timestamp&&t.timestamp>0&&r-t.timestamp<=i?t.ad:null}(c(e))},clearAd:function(e){!function(e){try{d(e)}catch(e){}}(c(e))},setTimeToLive:function(e){i=6e4*e},getNextAdToken:function(){return e=(t=l("___appnexus_video_cachemanager_ad_token___"))?parseInt(t):0,o("___appnexus_video_cachemanager_ad_token___",e+=1),e;var e,t}}},"./node_modules/videoads-util-capability-detection/src/CapabilityDetection.js":
/*! ************************************************************************************!*\
  !*** ./node_modules/videoads-util-capability-detection/src/CapabilityDetection.js ***!
  \************************************************************************************/(e,t,r)=>{var a=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js"),i=function(e){a.debug("CapabilityDetection",e)};function n(){return!!/Android|webOS|iPhone|iPad|BlackBerry|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)}function s(){return/iphone/i.test(navigator.userAgent.toLowerCase())||/ipad/i.test(navigator.userAgent.toLowerCase())}function o(){var e,t=navigator.userAgent,r=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(r[1]))return e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE";if("Chrome"===r[1]){if(null!==(e=t.match(/\bOPR\/(\d+)/)))return"Opera";if(null!==(e=t.match(/\bEdg\/(\d+)/)))return"Edge"}return r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&r.splice(1,1,e[1]),r[0]}e.exports={supportsFlash:function(){return!1},isBrowserOnMobile:function(){return n()},getBrowserName:function(){return o()},canPlay:function(e,t){var r=function(e,t,r){var a;return i("invoke canPlayType with video("+e+") and type("+t+") and codec("+r+")"),e&&e.canPlayType?(a=r&&""!==r?e.canPlayType(t+';codecs="'+r+'"'):e.canPlayType(t),i("result : "+a),a):(i("result : failed to invoke canPlayType with "+e),"")},a=null;if(function(e){return"video/x-flv"===e||"video/x-f4v"===e||"video/f4v"===e||"application/x-shockwave-flash"===e}(e.toLowerCase()))return!1;if(function(e){return"application/javascript"===e||"application/x-javascript"===e}(e.toLowerCase()))return!0;var n=e.toLowerCase();if(!t||""===t)if("video/mp4"===n)t="avc1.42E01E,mp4a.40.2",a="avc1.42E01E";else if("video/webm"===n)t="vp8,vorbis";else if("video/ogg"===n)t="theora,vorbis";else if(!function(e){return"audio/mpeg"===e||"audio/mp4"===e||"audio/ogg"===e||"audio/x-pn-realaudio"===e}(n)&&!function(e){return"video/x-ms-wmv"===e||"video/x-msvideo"===e||"video/mpeg"===e||"video/quicktime"===e||"video/3gpp"===e||"video/3gpp2"===e||"video/x-m4v"===e}(n))return!1;var s=document.createElement("video"),l=r(s,n,t);return"probably"===l||"maybe"===l&&(a?"probably"===r(s,n,a):function(e){if("video/3gpp"===e){var t=o();if("Chrome"===t||"Edge"===t)return!1}return!0}(n))},getPlatformType:function(){return n()?/android/i.test(navigator.userAgent.toLowerCase())?"mobile-Android":s()?"mobile-iOS":"mobile-unknown":"desktop-no-flash"}}},"./node_modules/videoads-util-misc-general/src/GeneralUtilities.js":
/*! *************************************************************************!*\
  !*** ./node_modules/videoads-util-misc-general/src/GeneralUtilities.js ***!
  \*************************************************************************/(e,t,r)=>{var a=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js");function i(e){if(e)return e.responseXML?e.responseXML:e.responseText}e.exports={debug:function(){a.handleLogDebugLegacySupport.apply(this,arguments)},logDebug:function(){a.handleLogDebugLegacySupport.apply(this,arguments)},setDebugLevel:function(e){a.setDebugLevel(e)},isNotEmpty:function(e){var t=!1;return null!==e&&e&&(t=e.length>0),t},objectToString:function(e,t){var r="null";if(t=void 0!==t?t:0,null!==e){r="OBJ[";var a="";for(var i in e){var n=e[i];if("object"==typeof n)if(++t<9)try{n=this.objectToString(n)}catch(e){n="err:"+e}else n="err: max recursion hit";a.length>0&&(a+=","),a+=i+"="+n}r+=a,r+="]"}return r},getRandomString:function(){return Math.random().toString(36).substring(2)},traceVastFromXhr:function(e,t){try{if(e)if(Array.isArray(e)){if(e.length>0){var r=[];for(var n in e)r.push(e[n].responseURL);var s=e[e.length-1];if(s){var o=i(s),l=s.responseURL;a.info(t,"Tag load chain:",r,"\n","Final Tag URL: ",l,"\n","Final Tag: ",o)}}}else{var d=i(e);a.info(t,"Tag URL:",e.responseURL,"\n","Tag:",d)}}catch(e){}}}},"./node_modules/videoads-util-parsers/src/CompanionAds.js":
/*! ****************************************************************!*\
  !*** ./node_modules/videoads-util-parsers/src/CompanionAds.js ***!
  \****************************************************************/e=>{e.exports={parse:function(e,t,r){function a(e){var t,a,i,n=e.parentNode&&e.parentNode.parentNode?n=e.parentNode.parentNode:null,s="",o="unknown",l="unknown",d=function(){return o+" "+l};if(!n)return d();if(!(a=r.getSubNodes(n,"UniversalAdId")))return d();for(t=0;t<a.length;t++)i=a[t],o=r.getNodeAttributeValue(i,"idRegistry")||"unknown",l=r.getNodeValue(i)||"unknown",s.length>0&&(s+=","),s+=d();return s}var i=r.getNodeAttributeValue(t,"required");i&&i.length>0&&(e.required=i);var n=r.getSubNodes(t,"Companion");if(n)for(var s=0;s<n.length;s++){var o=n[s],l={},d=r.getNodeAttributeNumberValue(o,"width",-1),c=r.getNodeAttributeNumberValue(o,"height",-1);if(!(d<=0||c<=0)){l.width=d,l.height=c;var u=r.getNodeAttributeValue(o,"id");u&&(l.id=u),(u=r.getNodeAttributeNumberValue(o,"assetWidth",-1))>0&&(l.assetWidth=u),(u=r.getNodeAttributeNumberValue(o,"assetHeight",-1))>0&&(l.assetHeight=u),(u=r.getNodeAttributeNumberValue(o,"expandedWidth",-1))>0&&(l.expandedWidth=u),(u=r.getNodeAttributeNumberValue(o,"expandedHeight",-1))>0&&(l.expandedHeight=u),(u=r.getNodeAttributeValue(o,"apiFramework"))&&(l.apiFramework=u),(u=r.getNodeAttributeValue(o,"adSlotID"))&&(l.adSlotID=u);var p=r.getNodeAttributeNumberValue(o,"pxratio",1);1!==p&&(l.pxratio=p),(u=r.getNodeAttributeValue(o,"required"))&&(l.required=u),(u=r.getNodeAttributeValue(o,"renderingMode"))&&(l.renderingMode=u),(u=r.getSubNodeValue(o,"AltText"))&&(l.AltText=u),(u=r.getSubNodeValue(o,"AdParameters"))&&(l.AdParameters=u);var h=r.getSubNode(o,"StaticResource");if(h&&(u=r.getNodeAttributeValue(h,"creativeType"))){if("video/x-flv"===u||"video/x-f4v"===u||"video/f4v"===u||"application/x-shockwave-flash"===u)continue;var f={type:u};(u=r.getNodeValues(h))&&(f.src=u,l.StaticResource=f)}(u=r.getSubNodeWholeValue(o,"IFrameResource"))&&(l.IFrameResource=u),(u=r.getSubNodeWholeValue(o,"HTMLResource"))&&(l.HTMLResource=u),(u=r.getSubNodeWholeValue(o,"CompanionClickThrough"))&&(l.CompanionClickThrough=r.prepareAttributionData(r.getSubNode(o,"CompanionClickThrough"),u));var g,m,v,b,E=["UNIVERSALADID"],y={UNIVERSALADID:a(o)},A=r.getSubNodes(o,"CompanionClickTracking");if(A)for(l.CompanionClickTracking=[],g=0;g<A.length;g++)m=A[g],(v=r.getNodeValues(m))&&(v=r.replaceMacrosWithValues(v,E,y,-1),(b=r.prepareAttributionData(m,v))&&"string"!=typeof b&&b.url&&(b.url=r.replaceMacrosWithValues(b.url,E,y,-1)),l.CompanionClickTracking.push(b));var T=r.getSubNodes(o,"Tracking");if(T)for(l.TrackingEvents=[],g=0;g<T.length;g++){m=T[g];var S=r.getNodeAttributeValue(m,"event");v=r.getNodeValues(m),S&&v&&(v=r.replaceMacrosWithValues(v,E,y,-1),(b=r.prepareAttributionData(m,v))&&"string"!=typeof b&&b.url&&(b.url=r.replaceMacrosWithValues(b.url,E,y,-1)),l.TrackingEvents.push({eventType:S,url:b}))}e.companions.push(l)}}},mergeCompanions:function(e,t){"unknown"===e.required&&(e.required=t.required),e.companions=e.companions.concat(t.companions)},createCompanionNode:function(e,t){var r,a,i,n,s=e.createElement("Companion"),o=["id","width","height","assetWidth","assetHeight","expandedWidth","expandedHeight","apiFramework","adSlotID","required"];for(r=0;r<o.length;r++)t.hasOwnProperty(o[r])&&((i=e.createAttribute(o[r])).value=t[o[r]],s.setAttributeNode(i));t.hasOwnProperty("StaticResource")&&(a=e.createElement("StaticResource"),(i=e.createAttribute("creativeType")).value=t.StaticResource.type,a.setAttributeNode(i),n=e.createCDATASection(t.StaticResource.src),a.appendChild(n),s.appendChild(a));var l=["AdParameters","IFrameResource","HTMLResource","CompanionClickThrough"];for(r=0;r<l.length;r++)t.hasOwnProperty(l[r])&&(a=e.createElement(l[r]),n=e.createCDATASection(t[l[r]]),a.appendChild(n),s.appendChild(a));if(t.hasOwnProperty("AltText")){a=e.createElement("AltText");try{a.innerHTML=t.AltText}catch(e){try{a.textContent=t.AltText}catch(e){}}s.appendChild(a)}if(t.hasOwnProperty("CompanionClickTracking"))for(r=0;r<t.CompanionClickTracking.length;r++){var d=e.createElement("CompanionClickTracking");if("string"==typeof t.CompanionClickTracking[r])n=e.createCDATASection(t.CompanionClickTracking[r]);else{if("object"!=typeof t.CompanionClickTracking[r]||!t.CompanionClickTracking[r].url)continue;n=e.createCDATASection(t.CompanionClickTracking[r].url)}d.appendChild(n),s.appendChild(d)}if(t.hasOwnProperty("TrackingEvents")){for(a=e.createElement("TrackingEvents"),r=0;r<t.TrackingEvents.length;r++){var c=e.createElement("Tracking");if((i=e.createAttribute("event")).value=t.TrackingEvents[r].eventType,c.setAttributeNode(i),"string"==typeof t.TrackingEvents[r].url)n=e.createCDATASection(t.TrackingEvents[r].url);else{if("object"!=typeof t.TrackingEvents[r].url||!t.TrackingEvents[r].url.url)continue;n=e.createCDATASection(t.TrackingEvents[r].url.url)}c.appendChild(n),a.appendChild(c)}s.appendChild(a)}return s}}},"./node_modules/videoads-util-parsers/src/Icons.js":
/*! *********************************************************!*\
  !*** ./node_modules/videoads-util-parsers/src/Icons.js ***!
  \*********************************************************/e=>{var t={parse:function(e,t,r){var a=r.getSubNodes(t,"Icon");if(a)for(var i=0;i<a.length;i++){var n=a[i],s={},o=r.getNodeAttributeNumberValue(n,"width",-1),l=r.getNodeAttributeNumberValue(n,"height",-1),d=r.getNodeAttributeValue(n,"program"),c=r.getNodeAttributeValue(n,"xPosition"),u=r.getNodeAttributeValue(n,"yPosition");if(!(o<=0||l<=0||0===d.length||0===c.length||0===u.length)){s.width=o,s.height=l,s.program=d,s.xPosition=c,s.yPosition=u;var p=r.getNodeAttributeValue(n,"apiFramework");p&&(s.apiFramework=p);var h=r.getNodeAttributeNumberValue(n,"pxratio",1);if(1!==h&&(s.pxratio=h),p=r.getNodeAttributeValue(n,"offset")){if(isNaN(Date.parse("January 1, 1970 "+p)))continue;s.offset=p}if(p=r.getNodeAttributeValue(n,"duration")){if(isNaN(Date.parse("January 1, 1970 "+p)))continue;s.duration=p}(p=r.getNodeAttributeValue(n,"altText"))&&(s.altText=p),(p=r.getNodeAttributeValue(n,"hoverText"))&&(s.hoverText=p);var f=r.getSubNode(n,"StaticResource");if(f&&(p=r.getNodeAttributeValue(f,"creativeType"))){if("video/x-flv"===p||"video/x-f4v"===p||"video/f4v"===p||"application/x-shockwave-flash"===p)continue;var g={type:p};(p=r.getNodeValues(f))&&(g.src=p,s.StaticResource=g)}if((p=r.getSubNodeWholeValue(n,"IFrameResource"))&&(s.IFrameResource=p),(p=r.getSubNodeWholeValue(n,"HTMLResource"))&&(s.HTMLResource=p),s.StaticResource||s.IFrameResource||s.HTMLResource){var m,v=r.getSubNode(n,"IconClicks");if(v){var b=r.getSubNode(v,"IconClickThrough");if(b&&(s.IconClickThrough=r.prepareAttributionData(b,r.getNodeValues(b))),p=r.getSubNodes(v,"IconClickTracking")){s.IconClickTracking=[];for(var E=0;E<p.length;E++)m=r.prepareAttributionData(p[E],r.getNodeValues(p[E])),s.IconClickTracking.push(m)}}var y=r.getSubNodes(n,"IconViewTracking");if(y){s.IconViewTracking=[];for(var A=0;A<y.length;A++)m=r.prepareAttributionData(y[A],r.getNodeValues(y[A])),s.IconViewTracking.push(m)}!function(e,t){for(var r=0;r<e.length;r++)e[r].program===t&&e.splice(r,1)}(e,d),e.push(s)}}}},createIconNode:function(e,t){var r,a,i,n,s=e.createElement("Icon"),o=["width","height","program","xPosition","yPosition","apiFramework","offset","duration"];for(r=0;r<o.length;r++)t.hasOwnProperty(o[r])&&((i=e.createAttribute(o[r])).value=t[o[r]],s.setAttributeNode(i));t.hasOwnProperty("StaticResource")&&(a=e.createElement("StaticResource"),(i=e.createAttribute("creativeType")).value=t.StaticResource.type,a.setAttributeNode(i),n=e.createCDATASection(t.StaticResource.src),a.appendChild(n),s.appendChild(a));var l=["IFrameResource","HTMLResource","IconViewTracking"];for(r=0;r<l.length;r++)t.hasOwnProperty(l[r])&&(a=e.createElement(l[r]),n=e.createCDATASection(t[l[r]]),a.appendChild(n),s.appendChild(a));if(t.hasOwnProperty("IconClickThrough")||t.hasOwnProperty("IconClickTracking")){var d=e.createElement("IconClicks");t.hasOwnProperty("IconClickThrough")&&(a=e.createElement("IconClickThrough"),"string"==typeof t.IconClickThrough?n=e.createCDATASection(t.IconClickThrough):"object"==typeof t.IconClickThrough&&t.IconClickThrough.url&&(n=e.createCDATASection(t.IconClickThrough.url)),a.appendChild(n),d.appendChild(a)),t.hasOwnProperty("IconClickTracking")&&(a=e.createElement("IconClickTracking"),"string"==typeof t.IconClickTracking?n=e.createCDATASection(t.IconClickTracking):"object"==typeof t.IconClickTracking&&t.IconClickTracking.url&&(n=e.createCDATASection(t.IconClickTracking.url)),a.appendChild(n),d.appendChild(a)),s.appendChild(d)}return s}};e.exports=t},"./node_modules/videoads-util-parsers/src/VastMerger.js":
/*! **************************************************************!*\
  !*** ./node_modules/videoads-util-parsers/src/VastMerger.js ***!
  \**************************************************************/(e,t,r)=>{var a=r(/*! ./XmlParserHelper.js */"./node_modules/videoads-util-parsers/src/XmlParserHelper.js");e.exports=function(e,t){var i=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js"),n="VAST Parser",s=e,o=new a;function l(e){var t=function(e){var t=e.indexOf("<"),r=e.substr(-1===t?0:t);return-1!==(t=r.lastIndexOf(">"))&&(r=r.substr(0,t+1)),r}(e),r=null;if(void 0!==window.DOMParser){if("parsererror"===(r=(new DOMParser).parseFromString(t,"text/xml")).documentElement.nodeName){try{i.error(n,"Error reason = "+r.documentElement.childNodes[0].nodeValue)}catch(e){}return null}}else{if(void 0===window.ActiveXObject)return i.error(n,"Failed to get vast xml parser"),null;try{if((r=new window.ActiveXObject("Microsoft.XMLDOM")).loadXML(t),0!==r.parseError.errorCode)return i.error(n,r.parseError),null}catch(e){return i.error(n,"Failed to parse vast xml by window.ActiveXObject(Microsoft.XMLDOM)",e),null}}return r}var d=l(s[0]);if(d){var c=o.getSubNode(d,"VAST"),u=d.createAttribute("apn_waterfall");u.value=!0,c.setAttributeNode(u),t&&((u=d.createAttribute("apn_fallback")).value=!0,c.setAttributeNode(u));for(var p=[],h=0;h<s.length;h++){var f=l(s[h]),g=o.getSubNode(f,"VAST"),m=o.getSubNodes(g,"Ad");if(m&&m.length>0)for(var v=0;v<m.length;v++)p.push(m[v])}p.sort((function(e,t){return o.getNodeAttributeNumberValue(e,"sequence")-o.getNodeAttributeNumberValue(t,"sequence")}));var b=r(/*! @appnexus/videoads-util-user-agent-parser */"./node_modules/@appnexus/videoads-util-user-agent-parser/src/UserAgentParser.js")().browser.name.toLowerCase();for("ie"===b?c.textContent="":c.innerHTML="",h=0;h<p.length;h++)c.appendChild(p[h]);this.getVastXml=function(){if(!d)return"";var e;if("edge"===b)e=d.childNodes[0].outerHTML;else if("ie"===b){for(var t=d.getElementsByTagName("AdParameters"),r=0;r<t.length;r++)t[r].textContent.indexOf("]]>")>0&&"<![CDATA["!==t[r].textContent.substr(0,9)&&(t[r].textContent=t[r].textContent.replace(/]]>/g,"]]]]><![CDATA[>"),t[r].textContent="<![CDATA["+t[r].textContent+"]]>");e=(e=(e=(new XMLSerializer).serializeToString(d)).replace(/&lt;/g,"<")).replace(/&gt;/g,">")}else e=(new XMLSerializer).serializeToString(d);return e}}}},"./node_modules/videoads-util-parsers/src/VastModifier.js":
/*! ****************************************************************!*\
  !*** ./node_modules/videoads-util-parsers/src/VastModifier.js ***!
  \****************************************************************/(e,t,r)=>{var a=r(/*! ./XmlParserHelper.js */"./node_modules/videoads-util-parsers/src/XmlParserHelper.js"),i=r(/*! ./CompanionAds.js */"./node_modules/videoads-util-parsers/src/CompanionAds.js"),n=r(/*! ./Icons.js */"./node_modules/videoads-util-parsers/src/Icons.js");e.exports=function(e,t,s,o,l,d,c,u,p){var h=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js"),f="VAST Parser",g=e,m=t,v=s,b=p,E=l,y=d,A=o,T=c,S=u,N=new a;var w=function(e){var t=function(e){var t=e.indexOf("<"),r=e.substr(-1===t?0:t);return-1!==(t=r.lastIndexOf(">"))&&(r=r.substr(0,t+1)),r}(e),r=null;if(void 0!==window.DOMParser){if("parsererror"===(r=(new DOMParser).parseFromString(t,"text/xml")).documentElement.nodeName){try{h.error(f,"Error reason = "+r.documentElement.childNodes[0].nodeValue)}catch(e){}return null}}else{if(void 0===window.ActiveXObject)return h.error(f,"Failed to get vast xml parser"),null;try{if((r=new window.ActiveXObject("Microsoft.XMLDOM")).loadXML(t),0!==r.parseError.errorCode)return h.error(f,r.parseError),null}catch(e){return h.error(f,"Failed to parse vast xml by window.ActiveXObject(Microsoft.XMLDOM)",e),null}}return r}(e.vastXml);function I(e,t){var r=w.createCDATASection(t);e.appendChild(r)}!function(e){if(w){var t=N.getSubNode(w,"VAST");if(t){var r=w.createAttribute("version");r.value=e,t.setAttributeNode(r)}}}(e.vastVersion),function(){if(w){var e=N.getSubNode(w,"VAST");if(e){var t=N.getSubNodes(e,"Ad");if(t&&t.length>0)for(var r=0;r<t.length;r++){if(v){var a=w.createAttribute("notifyurl");a.value=v,t[r].setAttributeNode(a)}if(A&&"rtb"===A){var i=w.createAttribute("rtb");i.value="true",t[r].setAttributeNode(i)}var n=w.createAttribute("sequence");if(n.value=g.sequence.toString(),t[r].setAttributeNode(n),E){var s=w.createAttribute("buyerMemberId");s.value=E,t[r].setAttributeNode(s)}if(T){var o=w.createAttribute("viewabilityConfig");o.value=T,t[r].setAttributeNode(o)}if(b){var l=w.createAttribute("creativeId");l.value=b,t[r].setAttributeNode(l)}if(y){var d=w.createAttribute("brandCategoryId");d.value=y,t[r].setAttributeNode(d)}}}}}();var V=null;function k(e,t){var r=N.getSubNodes(e,"Icon");if(r&&r.length>0)for(var a=0;a<r.length;a++){if(N.getNodeAttributeValue(r[a],"program").toLowerCase()===t.toLowerCase())return!0}return!1}function C(e,t){var r,a,n={companions:[]};i.parse(n,e,N);var s=n.companions;if(t.StaticResource||t.IFrameResource||t.HTMLResource){var o=!1;for(a=0;a<s.length;a++)if(t.width===s[a].width&&t.height===s[a].height){o=!0;break}o||(r=i.createCompanionNode(w,t),e.appendChild(r))}else{var l=!1;for(a=0;a<s.length;a++)if(t.width===s[a].width&&t.height===s[a].height&&(t.id&&t.id===s[a].id||!t.id)){t.CompanionClickTracking&&(s[a].CompanionClickTracking||(s[a].CompanionClickTracking=[]),s[a].CompanionClickTracking=s[a].CompanionClickTracking.concat(t.CompanionClickTracking)),t.TrackingEvents&&(s[a].TrackingEvents||(s[a].TrackingEvents=[]),s[a].TrackingEvents=s[a].TrackingEvents.concat(t.TrackingEvents)),l=!0;break}if(l){for(;e.firstChild;)e.removeChild(e.firstChild);for(var d=0;d<s.length;d++)r=i.createCompanionNode(w,s[d]),e.appendChild(r)}}}this.addTrackers=function(){if(!w)return"";var e,t=function(){var e;if(m){var t=N.getSubNode(w,"VAST");(e=w.createAttribute("adtoken")).value=m,t.setAttributeNode(e)}var a,i,n,s=N.getSubNode(w,"InLine");if(!s)return null;if(g.extImpressionUrls&&"string"==typeof g.extImpressionUrls){var o=JSON.parse(g.extImpressionUrls);if(Array.isArray(o)&&o.length>0)for(a=0;a<o.length;a++)I(i=w.createElement("Impression"),o[a]),s.appendChild(i);delete g.extImpressionUrls}if(S&&S.impressions)for(a=0;a<S.impressions.length;a++)S.impressions[a]&&(I(i=w.createElement("Impression"),S.impressions[a]),s.appendChild(i));if(g.extErrorUrls&&"string"==typeof g.extErrorUrls){var l=JSON.parse(g.extErrorUrls);if(Array.isArray(l)&&l.length>0)for(a=0;a<l.length;a++)I(n=w.createElement("Error"),l[a]),s.appendChild(n);delete g.extErrorUrls}if(S&&S.errors)for(a=0;a<S.errors.length;a++)S.errors[a]&&(I(n=w.createElement("Error"),S.errors[a]),s.appendChild(n));if(g.extViewableImpression&&"string"==typeof g.extViewableImpression){var d=JSON.parse(g.extViewableImpression),c=w.createElement("ViewableImpression");if(Array.isArray(d.viewable)&&d.viewable.length>0)for(a=0;a<d.viewable.length;a++){var u=w.createElement("Viewable");I(u,d.viewable[a]),c.appendChild(u)}if(Array.isArray(d.notViewable)&&d.notViewable.length>0)for(a=0;a<d.notViewable.length;a++){var p=w.createElement("NotViewable");I(p,d.notViewable[a]),c.appendChild(p)}if(Array.isArray(d.undetermined)&&d.undetermined.length>0)for(a=0;a<d.undetermined.length;a++){var h=w.createElement("ViewUndetermined");I(h,d.undetermined[a]),c.appendChild(h)}s.appendChild(c),delete g.extViewableImpression}if(g.extVerifications&&"string"==typeof g.extVerifications){var f,v=JSON.parse(g.extVerifications),b=N.getSubNode(s,"AdVerifications");b||(b=w.createElement("AdVerifications"),s.appendChild(b));var E=function(t){var r=w.createElement("JavaScriptResource");I(r,t.url),f.appendChild(r),t.apiFramework&&((e=w.createAttribute("apiFramework")).value=t.apiFramework,r.setAttributeNode(e)),t.browserOptional&&((e=w.createAttribute("browserOptional")).value=t.browserOptional,r.setAttributeNode(e))};for(a=0;a<v.length;a++){var y=v[a];if(f=w.createElement("Verification"),y.vendor&&((e=w.createAttribute("vendor")).value=y.vendor,f.setAttributeNode(e)),y.jsResources&&y.jsResources.forEach(E),y.trackingEvents){var A=w.createElement("TrackingEvents");for(var T in y.trackingEvents){var k=w.createElement("Tracking");(e=w.createAttribute("event")).value=T,k.setAttributeNode(e),I(k,y.trackingEvents[T]),A.appendChild(k)}f.appendChild(A)}if(y.verificationParameters){var C=w.createElement("VerificationParameters");I(C,y.verificationParameters),f.appendChild(C)}s.appendChild(f)}}var R,D=r(/*! @appnexus/videoads-util-user-agent-parser */"./node_modules/@appnexus/videoads-util-user-agent-parser/src/UserAgentParser.js")().browser.name.toLowerCase();if(g.extExtensions&&"string"==typeof g.extExtensions){var P=g.extExtensions;P.length>0&&((R=N.getSubNode(s,"Extensions"))?"ie"===D?R.textContent=R.textContent.toString()+P:R.innerHTML=R.innerHTML.toString()+P:(R=w.createElement("Extensions"),s.appendChild(R),"ie"===D?R.textContent=P:R.innerHTML=P)),delete g.extExtensions}if(g.hasOwnProperty("fallbackIndex")){(R=N.getSubNode(s,"Extensions"))||(R=w.createElement("Extensions"),s.appendChild(R));var O=!1,x=N.getSubNodes(R,"Extension");if(x&&x.length>0)for(a=0;a<x.length;a++){if("waterfall"===N.getNodeAttributeValue(x[a],"type")){O=!0,x[a].setAttribute("fallback_index",g.fallbackIndex);break}}if(!O){var q=w.createElement("Extension");(e=w.createAttribute("type")).value="waterfall",q.setAttributeNode(e);var L=w.createAttribute("fallback_index");L.value=g.fallbackIndex,q.setAttributeNode(L),R.appendChild(q)}}(V=N.getSubNode(s,"Creatives"))||(V=w.createElement("Creatives"),s.appendChild(V));var U=N.getSubNode(V,"Linear");if(!U){var _=w.createElement("Creative");V.appendChild(_),U=w.createElement("Linear"),_.appendChild(U)}return U}();if(!t)return"";!function(e){var t,r;if(g.extTrackingUrls&&"string"==typeof g.extTrackingUrls&&g.extTrackingUrls.length>5){var a=JSON.parse(g.extTrackingUrls),i=N.getSubNode(e,"TrackingEvents");for(var s in i||(i=w.createElement("TrackingEvents"),e.appendChild(i)),a){var o=a[s];for(t=0;t<o.length;t++){var l=w.createElement("Tracking"),d=w.createAttribute("event");d.value=s,l.setAttributeNode(d),I(l,o[t]),i.appendChild(l)}}delete g.extTrackingUrls}if(g.extClickUrls&&"string"==typeof g.extClickUrls){var c=JSON.parse(g.extClickUrls);if(Array.isArray(c)&&c.length>0&&((r=N.getSubNode(e,"VideoClicks"))||(r=w.createElement("VideoClicks"),e.appendChild(r)),!N.getSubNode(r,"ClickThrough"))){var u=w.createElement("ClickThrough");I(u,c[0]),r.appendChild(u)}delete g.extClickUrls}if(g.extCustomClicks&&"string"==typeof g.extCustomClicks){var p=JSON.parse(g.extCustomClicks);if(Array.isArray(p)&&p.length>0)for((r=N.getSubNode(e,"VideoClicks"))||(r=w.createElement("VideoClicks"),e.appendChild(r)),t=0;t<p.length;t++){var h=w.createElement("CustomClick");I(h,p[t]),r.appendChild(h)}delete g.extCustomClicks}if(g.extClickTrackingUrls&&"string"==typeof g.extClickTrackingUrls){var f=JSON.parse(g.extClickTrackingUrls);if(Array.isArray(f)&&f.length>0)for((r=N.getSubNode(e,"VideoClicks"))||(r=w.createElement("VideoClicks"),e.appendChild(r)),t=0;t<f.length;t++){var m=w.createElement("ClickTracking");I(m,f[t]),r.appendChild(m)}delete g.extClickTrackingUrls}if(g.extIcons&&"string"==typeof g.extIcons){var v=JSON.parse(g.extIcons);if(Array.isArray(v)&&v.length>0){var b=N.getSubNode(e,"Icons");for(b||(b=w.createElement("Icons"),e.appendChild(b)),t=0;t<v.length;t++)if(!k(b,v[t].program)){var E=n.createIconNode(w,v[t]);E&&b.appendChild(E)}}delete g.extIcons}}(t),V&&function(){if(g.extCompanions&&"string"==typeof g.extCompanions){var e=JSON.parse(g.extCompanions);if(Array.isArray(e.companions)&&e.companions.length>0){var t,r=N.getSubNode(V,"CompanionAds");r||(r=w.createElement("CompanionAds"),V.appendChild(r)),"unknown"!==e.required&&((t=w.createAttribute("required")).value=e.required,r.setAttributeNode(t));for(var a=0;a<e.companions.length;a++)C(r,e.companions[a])}}}();var a=r(/*! @appnexus/videoads-util-user-agent-parser */"./node_modules/@appnexus/videoads-util-user-agent-parser/src/UserAgentParser.js")().browser.name.toLowerCase();if("edge"===a)e=w.childNodes[0].outerHTML;else if("ie"===a){for(var i=w.getElementsByTagName("AdParameters"),s=0;s<i.length;s++)i[s].textContent.indexOf("]]>")>0&&"<![CDATA["!==i[s].textContent.substr(0,9)&&(i[s].textContent=i[s].textContent.replace(/]]>/g,"]]]]><![CDATA[>"),i[s].textContent="<![CDATA["+i[s].textContent+"]]>");e=(e=(e=(new XMLSerializer).serializeToString(w)).replace(/&lt;/g,"<")).replace(/&gt;/g,">")}else e=(new XMLSerializer).serializeToString(w);return e}}},"./node_modules/videoads-util-parsers/src/VastParser.js":
/*! **************************************************************!*\
  !*** ./node_modules/videoads-util-parsers/src/VastParser.js ***!
  \**************************************************************/(e,t,r)=>{var a=r(/*! ./XmlParserHelper.js */"./node_modules/videoads-util-parsers/src/XmlParserHelper.js"),i=r(/*! ./CompanionAds.js */"./node_modules/videoads-util-parsers/src/CompanionAds.js"),n=r(/*! ./Icons.js */"./node_modules/videoads-util-parsers/src/Icons.js"),s=r(/*! @appnexus/videoads-util-user-agent-parser */"./node_modules/@appnexus/videoads-util-user-agent-parser/src/UserAgentParser.js")(),o=function(e,t,o){var l,d,c,u,p="100",h="101",f="102",g="200",m="204",v="205",b="300",E="301",y="302",A="303",T="403",S="900",N=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js"),w="VAST Parser",I=null,V=o,k=V&&V.wrapperLimit&&V.wrapperLimit>0?V.wrapperLimit:5,C=0,R=null,D=e,P=t&&t>0?t:1e3,O=[],x=null,q=[],L=[],U={},_=[],j=[],M=[],F=[],B=[],G=[],W="",H="",X=0,K="",Y=0,J=null,z=[],Q={},$=[],Z=[],ee=[],te=[],re=[],ae={viewable:[],notViewable:[],undetermined:[]},ie=[],ne=null,se={},oe="unknown unknown",le="unknown unknown",de=null,ce={},ue=new a(o),pe=!1,he="",fe=!1,ge="video",me=[],ve=-1,be=!1,Ee=r(/*! videoads-util-capability-detection */"./node_modules/videoads-util-capability-detection/src/CapabilityDetection.js"),ye=V.fromMediation,Ae=ye&&V.fromMediation.waterfall,Te=ye&&V.fromMediation.rtbFallback,Se=[],Ne=!1,we={},Ie="",Ve={},ke="",Ce={},Re="",De={},Pe="",Oe={},xe="",qe=0,Le=0,Ue=o.vmap,_e="",je={hops:[]};function Me(e,t){if(e&&e.length>0)for(var r=0;r<e.length;r++)e[r]=e[r].replace("[ERRORCODE]",t)}function Fe(){if(!u){u="-1";var e=[];if(V){var t=!V.overlayPlayer,r=!V.overlayPlayer;V.hasOwnProperty("skippable")&&V.skippable.enabled&&e.push("skippable"),V.hasOwnProperty("initialPlayback")&&(t="auto"===V.initialPlayback),V.hasOwnProperty("initialAudio")&&(r="off"===V.initialAudio),t?e.push(r?"mautoplayed":"autoplayed"):e.push("optin"),u=e.join()}}return u}function Be(e,t){for(var r=e,a="AD DETECTED="+("SUCCESS"===t.substr(0,7)?"SUCCESS":"NONE")+" :: Reason="+t+", playerTechnology="+(V.hasOwnProperty("playerTechnology")?JSON.stringify(V.playerTechnology):"unknown")+", platform="+Ee.getPlatformType()+", Ad tree path=",i="";-1!==r;){var n=me[r].children[0];if(n){var s=ue.getNodeAttributeValue(n,"id");i.length>0&&(i=" -> "+i),i=s+i}r=me[r].parentIdx}N.info(w,a+i)}function Ge(e){var t=ue.getSubNodes(e,"Extension");if(t&&t.length>0)for(var r=0;r<t.length;r++){var a=ue.getNodeAttributeValue(t[r],"type");if(a&&"waterfall"===a&&(a=ue.getNodeAttributeValue(t[r],"fallback_index"))&&a.length>0)return a=parseInt(a)}return-1}function We(e,t){for(var r=0;r<e.length;r++)if(e[r].toString()===t.toString())return!0;return!1}function He(e,t){for(var r=0;r<e.length;r++)if("string"==typeof e[r]){if(e[r]===t)return!0}else if("object"==typeof e[r]&&!(e[r]instanceof Array)&&e[r].url===t)return!0;return!1}function Xe(e,t,r,a){if(e){var i=ue.getSubNode(e,"Linear",0);if(i){var n=null,s=ue.getSubNode(i,"VideoClicks");if(s){var o,l,d=ue.getSubNode(s,"ClickThrough");d&&(n=ue.getNodeValues(d))&&!He(t,n)&&(o=ue.prepareAttributionData(d,n),t.push(o)),0===t.length&&ce.url&&t.push(ce.url);var c=ue.getSubNodes(s,"ClickTracking");if(c)for(l=0;l<c.length;l++)if(d=c[l],(n=ue.getNodeValues(d))&&!He(r,n)){var u={ADTYPE:ge,INVENTORYSTATE:Fe()};n=ue.resolveMacros(n,!0,u),o=ue.prepareAttributionData(d,n,u),r.push(o)}if(c=ue.getSubNodes(s,"CustomClick"))for(l=0;l<c.length;l++)d=c[l],(n=ue.getNodeValues(d))&&!He(a,n)&&(o=ue.prepareAttributionData(d,n),a.push(o))}else ce.url&&t.push(ce.url)}}}function Ke(e,t){if(e){var r=function(e){var t=[],r=ue.getSubNodes(e,"Verification");if(r&&r.length>0)for(var a=0;a<r.length;a++){var i,n,s,o=r[a],l=ue.getNodeAttributeValue(o,"vendor"),d=[],c=[],u=ue.getSubNodes(o,"JavaScriptResource");if(u&&u.length>0)for(s=0;s<u.length;s++){i=ue.getNodeValues(u[s]);var p=ue.getNodeAttributeValue(u[s],"apiFramework"),h=ue.getNodeAttributeBooleanValue(u[s],"browserOptional");d.push({url:i,framework:p,browserOptional:h})}if((u=ue.getSubNodes(o,"ExecutableResource"))&&u.length>0)for(s=0;s<u.length;s++){i=ue.getNodeValues(u[s]),n=ue.getNodeAttributeValue(u[s],"apiFramework");var f=ue.getNodeAttributeValue(u[s],"type");c.push({content:i,framework:n,type:f})}var g=ue.getSubNodeWholeValue(o,"ViewableImpression"),m={},v=!1,b=ue.getSubNode(o,"TrackingEvents");if(b){var E=ue.getSubNodes(b,"Tracking");if(E&&E.length>0)for(s=0;s<E.length;s++){i=ue.getNodeValues(E[s]);var y=ue.getNodeAttributeValue(E[s],"event");y&&i&&(v=!0,i=ue.resolveMacros(i,!0,{ADTYPE:ge,INVENTORYSTATE:Fe()}),m.hasOwnProperty(y)?m[y].push(i):m[y]=[i])}}var A=ue.getSubNodeWholeValue(o,"VerificationParameters"),T={};l&&(T.vendor=l),d.length>0&&(T.jsResources=d),c.length>0&&(T.executableResources=c),g&&(T.viewableImpression=g),v&&(T.trackingEvents=m),A&&(T.verificationParameters=A),t.push(T)}return t.length>0?t:null}(e);r&&r.length>0&&r.forEach((function(e){t.push(e)}))}}function Ye(e,t){var r=e.indexOf("%");if(r>0)return t&&t>0?Number(e.substring(0,r)):0;var a=(r=e.indexOf("."))>0?Number(e.substring(r+1)):0;r>0&&(e=e.substring(0,r));var i=e.split(":");return 3===i.length?1e3*(3600*Number(i[0])+60*Number(i[1])+Number(i[2]))+a:0}function Je(e){return"video/x-flv"===e||"video/x-f4v"===e||"video/f4v"===e||"application/x-shockwave-flash"===e}function ze(e,t,r,a){var i=null;if(e){if((i={}).type=ue.getNodeAttributeValue(e,"type"),-1===a.indexOf(i.type)&&a.push(i.type),!i.type||0===i.type.length)return null;var n="video/mp4"===i.type?"":ue.getNodeAttributeValue(e,"codec");if(n&&n.length>0&&(n=(n=n.trim()).length>2?n:"").length>0&&(i.codec=n),!function(e,t){return Ee.canPlay(e,t)}(i.type,n))return null;if(V&&!function(e){if(V.playerTechnology&&Array.isArray(V.playerTechnology)&&V.playerTechnology.length>0){for(var t=!1,r=0;r<V.playerTechnology.length;r++)if(!Je(e.toLowerCase())){t=!0;break}if(!t)return!1}return!(V.hasOwnProperty("supportVpaid")&&!V.supportVpaid&&function(e){return"application/javascript"===e||"application/x-javascript"===e}(e.toLowerCase()))}(i.type))return null;i.url=t,i.variation="Media#"+r,i.delivery=ue.getNodeAttributeValue(e,"delivery");var s=ue.getNodeAttributeNumberValue(e,"bitrate",-1);-1!==s?i.bitrate=s:(-1!==(s=ue.getNodeAttributeNumberValue(e,"minBitrate",-1))&&(i.minBitrate=s),-1!==(s=ue.getNodeAttributeNumberValue(e,"maxBitrate",-1))&&(i.maxBitrate=s)),i.width=ue.getNodeAttributeNumberValue(e,"width"),i.height=ue.getNodeAttributeNumberValue(e,"height");var o=ue.getNodeAttributeValue(e,"scalable");o.length>0&&(i.scalable=ue.getNodeAttributeBooleanValue(e,"scalable",!0)),(o=ue.getNodeAttributeValue(e,"maintainAspectRatio")).length>0&&(i.maintainAspectRatio=ue.getNodeAttributeBooleanValue(e,"maintainAspectRatio",!0));var l=ue.getNodeAttributeValue(e,"apiFramework");l&&l.length>0&&(i.apiFramework=l.toUpperCase());var d=ue.getNodeAttributeValue(e,"id");d&&d.length>0&&(i.id=d);var c=ue.getNodeAttributeNumberValue(e,"fileSize",-1);-1!==c&&(i.fileSize=c);var u=ue.getNodeAttributeNumberValue(e,"mediaType",-1);-1!==u&&(i.mediaType=u)}return i}function Qe(e,t){var r=Date.now(),a='<VAST version="'+he+'"><Ad id="'+r+'"><InLine></InLine></Ad></VAST>',i={errorFlag:!0,vastVersion:he,errorUrls:ve>0?ft(ve):e,vastXml:a,adId:Nt(c&&c.parentNode?c.parentNode.id:"unknown"),sequence:me&&me.length>0?me[0].state.sequence:1,finalVastUri:_e,extClickTrackingUrls:"",extClickUrls:"",extCustomClicks:"",extErrorUrls:"",extImpressionUrls:"",extTrackingUrls:""};if(i.errorUrls||(i.errorUrls=[]),t&&(Me(i.errorUrls,t),i.errorUrls&&i.errorUrls.length>0&&(i.errorUrls[0]+="&ERRORFORFALLBACK="+t)),he.substr(0,1)>"3"){if(c){i.universalAdId=Tt(c),i.adServingId=ue.getSubNode(c,"AdServingId");var n=ue.getSubNode(c,"AdSystem");n&&(i.adSystem={name:ue.getNodeValue(n),version:ue.getNodeAttributeValue(n,"version")});var s=Et(c);s&&(i.categories=s)}i.contentId=St(),i.conditionalAd=fe}null!=l&&(i.fallbackOnNoAd=l),Ae&&Ie.length>0&&(i.notifyurl=Ie),xe.length>0&&(i.creative_id=xe),i.rtb=!0,Be(ve,"SUCCESS"),i.clickTrackingUrls=[],i.clickUrls=[],i.customClicks=[],i.impressionUrls=[],kt(i),V.telemetry&&(i.telemetry=Object.assign({},je)),je={hops:[]},Se.push(i),Le++,-1===ve&&(Ze(),Se.length>0&&(Se.sort((function(e,t){return e.fallbackIndex-t.fallbackIndex})),delete Se[Se.length-1].fallbackOnNoAd))}function $e(e,t){var r=B.concat(G);Me(r,e),z&&z.length>0&&(Me(z,A),r=r.concat(z));var a={UNIVERSALADID:oe,ADSERVINGID:de,BREAKPOSITION:V.breakPosition};if(r=ue.resolveMacrosArray(r,["UNIVERSALADID","ADSERVINGID","BREAKPOSITION"],a,-1),N.error(w,"Error "+e+" - "+t),Te){Qe(r);var i=Ae?Se:Se[0];i.errCode=e,I(!0,D,i,null)}else I(!1,D,"vast"+e,r,Ie,Object.assign({},je)),je={hops:[]}}function Ze(){for(var e=function(e){if(V.isXandrVastPlayer&&!V.overlayPlayer&&e.errorFlag&&Array.isArray(e.errorUrls)&&e.errorUrls.length>0)for(var t=r(/*! videoads-util-url-loader */"./node_modules/videoads-util-url-loader/src/UrlLoader.js"),a=0;a<e.errorUrls.length;a++){var i=e.errorUrls[a],n=new URL("string"==typeof i?i:i.url);n.hostname.indexOf("ib.adnxs.com")>=0||n.hostname.indexOf("ib.adnxs-simple.com")>=0||t.trackPixel(i,"error")}},t=0;t<Se.length;)if(Se[t].hasOwnProperty("fallbackIndex"))t++;else{if(!(Se.length>1))break;e(Se[t]),Se.splice(t,1)}}function et(e){var t=me[ve].state;if(t&&Array.isArray(t.arrErrorUrls)&&t.arrErrorUrls.forEach((function(e){G.push(e)})),ve>=0){if(me[ve].children[0]=null,me[ve].children.splice(0,1),0===me[ve].children.length){var r=me[ve].parentIdx;if(me.splice(ve,1),-1===(ve=r)){if((Ae||Te)&&Se.length>0){var a="rtb";ye&&D&&D.content_source&&(a=D.content_source),Te?(Ze(),ye?N.info(w,"Fallback: Vast XML ad count detected for "+a+" node: # ads: "+Se.length):N.info(w,"Fallback: Vast XML ad count detected: # fallback-"+a+" ads: "+Se.length),Se.length>0&&(Se.sort((function(e,t){return e.fallbackIndex-t.fallbackIndex})),delete Se[Se.length-1].fallbackOnNoAd)):ye?N.info(w,"Waterfall: Vast XML ad count detected for "+a+" node: # ads: "+("rtb"===a?Le:qe)):d?N.info(w,"Waterfall: Vast XML ad count detected: "+(qe+Le)):N.info(w,"Waterfall: Vast XML ad count detected: # csm ads: "+qe+", # rtb ads: "+Le),I(!0,D,Se,null)}else if(Ue&&Se.length>0)N.info(w,"VMAP: Ad XML node count detected: "+Se.length),I(!0,D,Se,null);else{var i=S;e&&(i=e.toString()),1===Se.length&&Se[0].errorFlag?I(!0,D,Se[0],null):$e(i,"no Ad available")}return}return(Ne=0===ve)&&Te&&e&&Qe(G,e),void et(e)}Ne=0===ve,C=ve,me[ve].state=tt(),je.hops.push({}),Vt(me[ve].children[0])}}function tt(){return{arrTrackings:{},arrImpressions:[],arrClickUrls:[],arrCustomClicks:[],arrClickTrackings:[],arrErrorUrls:[],sExtensions:"",sequence:Ue?0:1,companions:{required:"unknown",companions:[]},icons:[],arrViewableImpressions:{viewable:[],notViewable:[],undetermined:[]},arrVerifications:[],fallback:{enabled:!1,index:-1}}}function rt(e){var t=ue.getNodeAttributeValue(e,"id");if(t.length>0){var r=ue.getNodeAttributeValue(e,"notifyurl");r&&r.length>0&&(we[t]=r)}}function at(e){var t=ue.getNodeAttributeValue(e,"id");if(t.length>0){var r=ue.getNodeAttributeValue(e,"creativeId");r&&r.length>0&&(Oe[t]=r)}}function it(e){var t=ue.getNodeAttributeValue(e,"id");if(t.length>0){var r=ue.getNodeAttributeValue(e,"buyerMemberId");r&&r.length>0&&(Ve[t]=r)}}function nt(e){var t=ue.getNodeAttributeValue(e,"id");if(t.length>0){var r=ue.getNodeAttributeValue(e,"brandCategoryId");r&&r.length>0&&(Ce[t]=r)}}function st(e){var t=ue.getNodeAttributeValue(e,"id");if(t.length>0){var r=ue.getNodeAttributeValue(e,"viewabilityConfig");r&&r.length>0&&(De[t]=r)}}function ot(){if(J&&J.length>0)for(var e=0;e<J.length;e++){var t=J[e],r=ue.getNodeValues(t);if(r&&!He(z,r)){var a=ue.prepareAttributionData(t,r);z.push(a)}}}function lt(e){(new Date).getTime(),z=[],R=e;var t=function(e){var t=e.indexOf("<"),r=e.substr(-1===t?0:t);return-1!==(t=r.lastIndexOf(">"))&&(r=r.substr(0,t+1)),r.trim()}(e);if(0===t.length)return It("outcome","failed"),Be(ve,"EMPTY VAST"),void(0===me.length?(It("errCode",h),$e(h,"empty VAST")):ye?(It("errCode",p),et(p)):(It("errCode",Te?h:A),et(Te?h:A)));var r=null;if(void 0!==window.DOMParser){var a=!1;if("parsererror"===(r=(new DOMParser).parseFromString(t,"text/xml")).documentElement.nodeName){a=!0;try{N.error(w,"Error reason = "+r.documentElement.childNodes[0].nodeValue)}catch(e){}}else{var i=ue.getSubNode(r,"parsererror");if(i){a=!0;try{N.error(w,"Error reason = "+i.innerText)}catch(e){}}}if(a)return It("outcome","failed"),It("errCode",p),Be(ve,"INVALID VAST STRUCTURE"),void(0===me.length?$e(p,"VAST XML parsing error"):et(p))}else{if(void 0===window.ActiveXObject)return It("outcome","failed"),It("errCode",p),N.error(w,"Failed to parse vast xml by window.ActiveXObject(Microsoft.XMLDOM)"),Be(ve,"INVALID VAST STRUCTURE"),void(0===me.length?$e(p,"Failed to get vast xml"):et(p));try{if((r=new window.ActiveXObject("Microsoft.XMLDOM")).loadXML(t),0!==r.parseError.errorCode)return It("outcome","failed"),It("errCode",p),N.error(w,r.parseError),Be(ve,"INVALID VAST STRUCTURE"),void(0===me.length?$e(p,r.parseError.errorCode+", Error reason = "+r.parseError.reason):et(p))}catch(e){return It("outcome","failed"),It("errCode",p),N.error(w,"Failed to parse vast xml by window.ActiveXObject(Microsoft.XMLDOM)",e),Be(ve,"INVALID VAST STRUCTURE"),void(0===me.length?$e(p,"Failed to parse vast xml by window.ActiveXObject(Microsoft.XMLDOM)"):et(p))}}if(!r)return It("outcome","failed"),It("errCode",p),Be(ve,"INVALID VAST STRUCTURE"),void(0===me.length?$e(p,"VAST XML parsing error"):et(p));var n=ue.getSubNode(r,"VAST");if(!n||!n.firstChild)return It("outcome","empty vast"),Be(ve,"EMPTY VAST"),void(D?0===me.length?(It("errCode",h),$e(h,"empty VAST")):ye?(It("errCode",p),et(p)):C>0?(It("errCode",A),et(A)):(It("errCode",Te?h:A),et(Te?h:A)):(It("errCode",A),0===me.length?$e(A,"no Ad found in VAST response"):et(A)));var s=ue.getSubNodes(n,"Error");J=ue.returnOnlyChildren(n,s);var o=function(e){var t="unknown";return e&&(t=(t=ue.getNodeAttributeValue(e,"version")).trim()).length>3&&(t=t.substr(0,3)),t}(n);if(function(e){return"2.0"===e||"3.0"===e||"4.0"===e||"4.1"===e||"4.2"===e}(o)){Ne&&(ye||((Ae=ue.getNodeAttributeBooleanValue(n,"apn_waterfall"))&&(V.waterfall=!0),Te=ue.getNodeAttributeBooleanValue(n,"apn_fallback")),ce={});var l=ue.getSubNodes(n,"Ad");if(!l||0===l.length)return It("outcome","failed"),ot(),Be(ve,"NO AD NODE"),void(0===me.length?(It("errCode",h),$e(h,"no Ad available")):(It("errCode",A),et(A)));for(var c=[],u=S,m=0;m<l.length;m++){if(Ne){var v=ue.getNodeAttributeValue(l[m],"id");v?v+="_suffix"+m:v="unknown_suffix"+m,l[m].id=v}else ye||Ae||Te||Ge(l[m])>=0&&(Ae=!0,V.waterfall=!0,d=!0);if(o>="4.1"){var b=ue.getNodeAttributeValue(l[m],"adType");if(("preview"!==V.adType||!V.onlyAudio)&&""!==b&&"video"!==b){N.log(w,"Ignore non-video Ad node"),u=g;continue}}if(o>="4.0"&&ve>0&&!me[ve].state.allowMultiAds){if(ue.getNodeAttributeValue(l[m],"sequence"))continue;if(c.length>0)break}c.push(l[m]),Ae&&Ne&&rt(l[m]),Ne&&(it(l[m]),nt(l[m]),at(l[m]),st(l[m]))}if(0===c.length)return ot(),It("outcome","failed"),It("errCode",u),Be(ve,"NO VALID AD NODES"),void(0===me.length?$e(u,"no Ad available"):et(u));var E={parentIdx:ve,currentIdx:0,children:c,state:tt()};me.push(E),E.currentIdx=me.length-1,ve=E.currentIdx,Vt(me[ve].children[0],o)}else It("outcome","failed"),It("errCode",f),Be(ve,"INVALID VAST VERSION: "+o),0===me.length?$e(f,"VAST version not supported"):et(f)}function dt(e){for(var t in me[e].state.arrTrackings)for(var r=0;r<me[e].state.arrTrackings[t].length;r++)Q.hasOwnProperty(t)?We(Q[t],me[e].state.arrTrackings[t][r])||Q[t].push(me[e].state.arrTrackings[t][r]):(Q[t]=[],Q[t].push(me[e].state.arrTrackings[t][r]));return Q}function ct(e){for(var t=0;t<me[e].state.arrImpressions.length;t++)We($,me[e].state.arrImpressions[t])||$.push(me[e].state.arrImpressions[t]);return $}function ut(e){for(var t=0;t<me[e].state.arrClickUrls.length;t++)We(Z,me[e].state.arrClickUrls[t])||Z.push(me[e].state.arrClickUrls[t]);return Z}function pt(e){for(var t=0;t<me[e].state.arrCustomClicks.length;t++)We(ee,me[e].state.arrCustomClicks[t])||ee.push(me[e].state.arrCustomClicks[t]);return ee}function ht(e){for(var t=0;t<me[e].state.arrClickTrackings.length;t++)We(te,me[e].state.arrClickTrackings[t])||te.push(me[e].state.arrClickTrackings[t]);return te}function ft(e){for(var t=0;t<me[e].state.arrErrorUrls.length;t++)We(re,me[e].state.arrErrorUrls[t])||re.push(me[e].state.arrErrorUrls[t]);return re}function gt(e){return me[e].state.sExtensions.length>0&&(W+=me[e].state.sExtensions),W}function mt(e,t){for(var r=0;r<e.length;r++)if(e[r].program.toLowerCase()===t.toLowerCase())return!0;return!1}function vt(e,t){for(var r=0;r<e.length;r++)if(e[r].program.toLowerCase()===t.toLowerCase())return void e.splice(r,1)}function bt(e){for(var t=e;t>0;){for(var r=me[t].parentIdx,a=0;a<me[t].state.icons.length;a++)mt(me[r].state.icons,me[t].state.icons[a].program)&&vt(me[r].state.icons,me[t].state.icons[a].program),me[r].state.icons.push(me[t].state.icons[a]);t=r}return me[t].state.icons}function Et(e){var t=[],r=ue.getSubNodes(e,"Category");if(r&&r.length>0)for(var a=0;a<r.length;a++){var i=ue.getNodeValues(r[a]);if(i&&i.length>0){var n=ue.getNodeAttributeValue(r[a],"authority");t.push({category:i,authority:n})}}return t.length>0?t:null}function yt(e){var t;for(t=0;t<me[e].state.arrViewableImpressions.viewable.length;t++)We(ae.viewable,me[e].state.arrViewableImpressions.viewable[t])||ae.viewable.push(me[e].state.arrViewableImpressions.viewable[t]);for(t=0;t<me[e].state.arrViewableImpressions.notViewable.length;t++)We(ae.notViewable,me[e].state.arrViewableImpressions.notViewable[t])||ae.notViewable.push(me[e].state.arrViewableImpressions.notViewable[t]);for(t=0;t<me[e].state.arrViewableImpressions.undetermined.length;t++)We(ae.undetermined,me[e].state.arrViewableImpressions.undetermined[t])||ae.undetermined.push(me[e].state.arrViewableImpressions.undetermined[t]);return ae}function At(e){var t;for(t=0;t<me[e].state.arrVerifications.length;t++)ie.push(me[e].state.arrVerifications[t]);return ie}function Tt(e){var t,r,a,i,n="",s="unknown",o="unknown",l=function(){return s+" "+o};if(!(r=ue.getSubNodes(e,"Creative"))||0===r.length)return l();for(t=0;t<r.length&&!(ue.getSubNode(r[t],"Linear")&&(a=ue.getSubNodes(r[t],"UniversalAdId"))&&a.length>0);t++);if(!a)return l();for(t=0;t<a.length;t++)i=a[t],s=ue.getNodeAttributeValue(i,"idRegistry")||"unknown",o=ue.getNodeValue(i)||"unknown",n.length>0&&(n+=","),n+=l();return n}function St(){var e="unknown",t="unknown";return V.content&&(V.content.registryId&&(e=V.content.registryId),V.content.contentId&&(t=V.content.contentId)),e+" "+t}function Nt(e){var t=e,r=t.indexOf("_suffix");return r>0&&(t=t.substring(0,r)),t}function wt(e){return!!(ne&&se&&se.hasOwnProperty(e.authority))&&!!ne.split(",").find((function(t){return t===e.category}))}function It(e,t){je.hops&&je.hops.length>0&&(je.hops[je.hops.length-1][e]=t)}function Vt(e,t){c=null;var a=ue.getSubNode(e,"Wrapper"),o=null!==a;if(o||(a=ue.getSubNode(e,"InLine")),c=a,!a)return It("outcome","failed"),It("errCode","101"),ot(),Be(ve,"MISSING WRAPPER / INLINE NODE"),void et("101");if(++C>k)return It("outcome","failed"),It("errCode",y),Be(ve,"Reach Wrapper limit"),void et(y);t>he&&(he=t);var u=ue.getNodeAttributeValue(e,"id");if(we.hasOwnProperty(u)&&(Ie=we[u]),Oe.hasOwnProperty(u)&&(xe=Oe[u]),Ve.hasOwnProperty(u)&&(ke=Ve[u]),Ce.hasOwnProperty(u)&&(Re=Ce[u]),De.hasOwnProperty(u)&&(Pe=De[u]),0===ve){var h=ue.getNodeAttributeValue(e,"sequence");h&&(me[ve].state.sequence=parseInt(h)),ue.getNodeAttributeValue(e,"conditionalAd")&&(fe=ue.getNodeAttributeBooleanValue(e,"conditionalAd")),(ge=ue.getNodeAttributeValue(e,"adType"))&&""!==ge||(ge="video"),ye||Te||Ae||Ge(a)>=0&&(Te=!0)}if(function(e,t){if(e){var r=ue.getSubNodes(e,"Error"),a=ue.returnOnlyChildren(e,r);if(a)for(var i=0;i<a.length;i++){var n=a[i],s=ue.getNodeValues(n),o={ADTYPE:ge,INVENTORYSTATE:Fe()};if((s=ue.resolveMacros(s,!0,o))&&!He(t,s)){var l=ue.prepareAttributionData(n,s,o);t.push(l)}}}}(a,me[ve].state.arrErrorUrls),function(e,t){if(e){var r=ue.getSubNodes(e,"Impression");if(r)for(var a=0;a<r.length;a++){var i=r[a],n=ue.getNodeValues(i),s={ADTYPE:ge,INVENTORYSTATE:Fe()};if((n=ue.resolveMacros(n,!0,s))&&!He(t,n)){var o=ue.prepareAttributionData(i,n,s);t.push(o)}}}}(a,me[ve].state.arrImpressions),function(e,t){if(e){var r=ue.getSubNode(e,"Linear",0);if(r){var a=ue.getSubNode(r,"TrackingEvents");if(a){var i=ue.getSubNodes(a,"Tracking");if(i)for(var n=0;n<i.length;n++){a=i[n];var s=ue.getNodeValues(a);if(s){var o={ADTYPE:ge,INVENTORYSTATE:Fe()};s=ue.resolveMacros(s,!0,o);var l,d=ue.getNodeAttributeValue(a,"event");if("progress"===d){var c=ue.getNodeAttributeValue(a,"offset");d=c?"progress_"+c:""}if(d)t.hasOwnProperty(d)?He(t[d],s)||(l=ue.prepareAttributionData(a,s,o),t[d].push(l)):(t[d]=[],l=ue.prepareAttributionData(a,s,o),t[d].push(l))}}}}}}(a,me[ve].state.arrTrackings),Xe(a,me[ve].state.arrClickUrls,me[ve].state.arrClickTrackings,me[ve].state.arrCustomClicks),function(e,t){if(e){var r=ue.getSubNode(e,"Extensions");r&&r.innerHTML&&r.innerHTML.length>0?me[t].state.sExtensions=me[t].state.sExtensions+r.innerHTML.toString():r&&r.textContent&&r.textContent.length>0&&(me[t].state.sExtensions=me[t].state.sExtensions+r.textContent.toString())}}(a,ve),function(e,t){if(e){var r=ue.getSubNode(e,"CompanionAds");r&&(r.innerHTML&&r.innerHTML.length>0||r.textContent&&r.textContent.length>0)&&i.parse(me[t].state.companions,r,ue)}}(a,ve),function(e,t){if(e){var r=ue.getSubNode(e,"Icons");r&&(r.innerHTML&&r.innerHTML.length>0||r.textContent&&r.textContent.length>0)&&n.parse(me[t].state.icons,r,ue)}}(a,ve),function(e,t){if(e){var r=ue.getSubNode(e,"ViewableImpression",0);if(r){var a,i=null,n=null,s=ue.getSubNodes(r,"Viewable");if(s&&s.length>0)for(a=0;a<s.length;a++)n=s[a],(i=ue.getNodeValues(n))&&!We(t.viewable,i)&&t.viewable.push(i);if((s=ue.getSubNodes(r,"NotViewable"))&&s.length>0)for(a=0;a<s.length;a++)n=s[a],(i=ue.getNodeValues(n))&&!We(t.notViewable,i)&&t.notViewable.push(i);if((s=ue.getSubNodes(r,"ViewUndetermined"))&&s.length>0)for(a=0;a<s.length;a++)n=s[a],(i=ue.getNodeValues(n))&&!We(t.undetermined,i)&&t.undetermined.push(i)}}}(a,me[ve].state.arrViewableImpressions),Ke(a,me[ve].state.arrVerifications),G=[],o){if(It("wrapper",!0),function(e){if(e){var t=ue.getSubNode(e,"Linear",0);if(t){var r=ue.getSubNode(t,"Duration");if(r){var a=Ye(ue.getNodeValue(r),-1);a>0&&(Y=a)}}}}(a),he>="4.0"&&ve>0&&me[ve-1].state.hasOwnProperty("followAdditionalWrappers")&&!1===me[ve-1].state.followAdditionalWrappers)return It("outcome","failed"),It("errCode",b),Be(ve,"Additional Wrappers are not allowed"),void et(b);!function(e){ne=null,se={};var t=ue.getSubNodes(e,"BlockedAdCategories");if(t&&t.length>0){ne=[];for(var r=0;r<t.length;r++){var a=ue.getNodeValues(t[r]);ne.push(a);var i=ue.getNodeAttributeValue(t[r],"authority");i&&i.length>0&&(se[i]=a)}ne=ne.toString()}}(a),function(e){It("wrapperIndex",C),l=null;var t=ue.getSubNode(e,"VASTAdTagURI");if(!t)return It("outcome","failed"),It("errCode",b),Be(ve,"INVALID WRAPPER NODE"),void(0===me.length?$e(b,"invalid wrapper node"):et(b));var a,i,n=ue.getNodeValues(t);if(!n||0===n.length)return It("outcome","failed"),It("errCode",b),Be(ve,"EMPTY VASTAdTagURI"),void(0===me.length?$e(b,"Invalid VASTAdTagURI node value"):et(b));if(be)return Be(ve,"terminated"),void I(!1,D,"terminated",null,Ie);if(pe=!0,he>="4.0"&&(a=ue.getNodeAttributeBooleanValue(e,"followAdditionalWrappers",!0),me[ve].state.followAdditionalWrappers=a,a=ue.getNodeAttributeBooleanValue(e,"allowMultipleAds",!1),me[ve].state.allowMultipleAds=a),Te){var s=Ge(e);s>=0&&(""!==(a=ue.getNodeAttributeValue(e,"fallbackOnNoAd"))?(l=ue.getNodeAttributeBooleanValue(e,"fallbackOnNoAd"),me[ve].state.fallback.enabled=l):me[ve].state.fallback.enabled=!1,me[ve].state.fallback.index=s)}_e=n,i=V.overlayPlayer?1:V.expandable?3:-1,n=ue.resolveMacros(n,!1,{BLOCKEDADCATEGORIES:ne?ne.toString():-1,ADTYPE:ge,ADCOUNT:1,PLACEMENTTYPE:i,INVENTORYSTATE:Fe()}),It("wrapperDomain",ue.getDomain(n)),It("url",n);var o=Date.now();r(/*! videoads-util-url-loader */"./node_modules/videoads-util-url-loader/src/UrlLoader.js").load(n,(function(t,r){if(It("timeToProcess",Date.now()-o),be)return Be(ve,"terminated"),void I(!1,D,"terminated",null,Ie);if(t||0===r.length)"Timeout"===t?(It("responseStatus","timeout"),Be(ve,"VASTAdTagURI TIMED OUT: "+n),0===me.length?$e(E,"Timeout of VAST URI provided in wrapper element"):et(E)):(It("responseStatus","failed"),It("errCode",A),Be(ve,"No response for VASTAdTagURI: "+n),0===me.length?$e(A,"No VAST response for VAST URI provided in wrapper element"):et(A));else{It("responseStatus","success"),Ne=!1;var a=[];Xe(e,a,[],[]),a.length>0&&(ce.url=a[0]),je.hops.push({}),lt(r)}}),V.adServerTimeout?V.adServerTimeout:P)}(a)}else{var f;It("inline",!0);var g=!1;Te&&(f=Ge(a))>=0&&(g=!0,me[ve].state.fallback.enabled=!0,me[ve].state.fallback.index=f);var S=function(e){X=0,K="",H="",O=[],x=null,q=[],L=[];var t=null,r=[];if(e){var a=ue.getSubNode(e,"Linear",0);if(a){var i=ue.getSubNode(a,"Duration");if(i){var n=ue.getNodeValue(i);X=Ye(n,-1)}var s=ue.getNodeAttributeValue(a,"skipoffset");K=s,H="";var o=ue.getSubNode(a,"AdParameters");if(o)if(H=ue.getNodeValues(o),ue.getNodeAttributeBooleanValue(o,"xmlEncoded",!1)){var l=document.createElement("textarea");l.innerHTML=H,H=l.value}if(i=ue.getSubNode(a,"MediaFiles")){var d,c=ue.getSubNodes(i,"MediaFile");if(c){var u;for(u=0;u<c.length;u++)if(i=c[u],(d=ue.getNodeValues(i)).length>0){var h=ze(i,d,u,r);h&&O.push(h)}if(0===O.length)t={code:T,message:"INCOMPATIBLE MEDIA TYPE, Available = "+JSON.stringify(r)};else{i=ue.getSubNode(a,"MediaFiles"),x=ue.getSubNodeWholeValue(i,"Mezzanine","");var f=ue.getSubNodes(i,"InteractiveCreativeFile");if(f&&f.length>0)for(var g=0;g<f.length;g++){var m=f[g];if(d=ue.getNodeValues(m)){var v=ue.getNodeAttributeValue(m,"type"),b=ue.getNodeAttributeValue(m,"apiFramework"),E=ue.getNodeAttributeBooleanValue(m,"variableDuration");q.push({url:d,type:v,apiFramework:b,variableDuration:E})}}var y=ue.getSubNode(i,"ClosedCaptionFiles");if(y){var A=ue.getSubNodes(y,"ClosedCaptionFile");if(A&&A.length>0)for(u=0;u<A.length;u++)L.push({uri:ue.getNodeValues(A[u]),type:ue.getNodeAttributeValue(A[u],"type"),language:ue.getNodeAttributeValue(A[u],"language")})}}}else t={code:T,message:"MISSING MEDIA FILES"}}else t={code:T,message:"MISSING MEDIA FILES"}}else t={code:p,message:"INVALID VAST STRUCTURE"}}return t}(a);if((0===O.length||null!==S)&&!g)return Be(ve,S.message),void et(S.code);Q=JSON.parse(JSON.stringify(U)),$=_.slice(0),Z=j.slice(0),ee=M.slice(0),te=F.slice(0),re=B.slice(0),W="";var N=JSON.stringify(function(e){for(var t=e;t>=0;)dt(t),t=me[t].parentIdx;return Q}(me[ve].parentIdx)),w=JSON.stringify(function(e){for(var t=e;t>=0;)ct(t),t=me[t].parentIdx;return $}(me[ve].parentIdx)),J=JSON.stringify(function(e){for(var t=e;t>=0;)ut(t),t=me[t].parentIdx;return Z.reverse(),Z}(me[ve].parentIdx)),z=JSON.stringify(function(e){for(var t=e;t>=0;)ht(t),t=me[t].parentIdx;return te}(me[ve].parentIdx)),Ee=JSON.stringify(function(e){for(var t=e;t>=0;)pt(t),t=me[t].parentIdx;return ee}(me[ve].parentIdx)),Me=JSON.stringify(function(e){for(var t=e;t>=0;)ft(t),t=me[t].parentIdx;return re}(me[ve].parentIdx)),Je=function(e){for(var t=e;t>=0;)gt(t),t=me[t].parentIdx;return W}(me[ve].parentIdx),Qe=JSON.stringify(function(e){for(var t={required:"unknown",companions:[]},r=e;r>=0;)i.mergeCompanions(t,me[r].state.companions),r=me[r].parentIdx;return t}(me[ve].parentIdx)),Ze=JSON.stringify(function(e){for(var t=[],r=e;r>=0;){for(var a=0;a<me[r].state.icons.length;a++)mt(t,me[r].state.icons[a].program)||t.push(me[r].state.icons[a]);r=me[r].parentIdx}return t}(me[ve].parentIdx));W="";var tt=function(e){for(var t=e;t>0;){var r=me[t].parentIdx;i.mergeCompanions(me[r].state.companions,me[t].state.companions),t=r}return"unknown"===me[t].state.companions.required&&delete me[t].state.companions.required,me[t].state.companions}(ve);tt=function(e){var t,r,a,i=[],n=[],s=e.companions;if(!e.companions)return e;for(r=s.length-1;r>=0;r--)if((t=s[r]).StaticResource||t.IFrameResource||t.HTMLResource){var o=!1;for(a=0;a<i.length;a++)if(t.width===i[a].width&&t.height===i[a].height){o=!0;break}o||i.push(t)}else n.push(t);for(r=0;r<n.length;r++)for(a=0;a<i.length;a++)n[r].width===i[a].width&&n[r].height===i[a].height&&(n[r].id&&n[r].id===i[a].id||!n[r].id)&&(n[r].CompanionClickTracking&&(i[a].CompanionClickTracking||(i[a].CompanionClickTracking=[]),i[a].CompanionClickTracking=i[a].CompanionClickTracking.concat(n[r].CompanionClickTracking)),n[r].TrackingEvents&&(i[a].TrackingEvents||(i[a].TrackingEvents=[]),i[a].TrackingEvents=i[a].TrackingEvents.concat(n[r].TrackingEvents)));var l={companions:i};return e.required&&(l.required=e.required),l}(tt);var rt={vastVersion:he,withWrapper:pe,mediaFiles:O,trackingUrls:dt(ve),impressionUrls:ct(ve),clickUrls:ut(ve),clickTrackingUrls:ht(ve),customClicks:pt(ve),errorUrls:ft(ve),durationMsecs:X>0?X:Y,skipOffset:K,extensions:gt(ve),adParameters:H,vastXml:R,extTrackingUrls:N,extImpressionUrls:w,extClickUrls:J,extCustomClicks:Ee,extClickTrackingUrls:z,extErrorUrls:Me,extExtensions:Je,adId:Nt(u),sequence:me[0].state.sequence,companionAds:tt,extCompanions:Qe,icons:bt(ve),extIcons:Ze,finalVastUri:_e};d&&(rt.notImpbusWaterfall=!0);var at,it=JSON.stringify(function(e){for(var t=e;t>=0;)At(t),t=me[t].parentIdx;return ie}(me[ve].parentIdx)),nt=At(ve);if(nt&&nt.length>0&&(rt.extVerifications=it,rt.adVerifications=nt),he.substr(0,1)>"2"&&L&&L.length>0&&(rt.closedCaptionFiles=L),he.substr(0,1)>"3"){oe=Tt(a),rt.universalAdId=oe,le=St(),rt.contentId=le;var st=ue.getSubNode(a,"AdServingId");st&&(de=ue.getNodeValue(st)),rt.adServingId=de;var vt=ue.getSubNode(a,"AdSystem");vt&&(rt.adSystem={name:ue.getNodeValue(vt),version:ue.getNodeAttributeValue(vt,"version")});var Vt=ue.getSubNode(a,"AdTitle");Vt&&(rt.adTitle=ue.getNodeValue(Vt));var Ct=ue.getSubNode(a,"Description");Ct&&(rt.description=ue.getNodeValue(Ct));var Rt=ue.getSubNode(a,"Advertiser");Rt&&(rt.advertiser={name:ue.getNodeValue(Rt),id:ue.getNodeAttributeValue(Rt,"id")});var Dt=ue.getSubNode(a,"Pricing");Dt&&(rt.pricing={price:ue.getNodeAttributeNumberValue(Dt,"price"),model:ue.getNodeAttributeValue(Dt,"model"),currency:ue.getNodeAttributeValue(Dt,"currency")});var Pt=ue.getSubNodes(a,"Survey");if(Pt&&Pt.length>0)for(rt.surveys=[],at=0;at<Pt.length;at++)rt.surveys.push({uri:ue.getNodeValue(Pt[at]),type:ue.getNodeAttributeValue(Pt[at],"type")});var Ot=ue.getSubNode(a,"Expires");if(Ot){var xt=parseInt(ue.getNodeValue(Ot));!isNaN(xt)&&xt>0&&(rt.expires=Date.now()+1e3*xt)}var qt=function(e){var t=ue.getSubNodes(e,"Creative");if(t&&t.length>0)for(var r=0;r<t.length;r++){if(ue.getSubNode(t[r],"Linear")){var a=ue.getSubNode(t[r],"CreativeExtensions");if(a){var i=ue.getSubNodes(a,"CreativeExtension");if(i&&i.length>0){for(var n=[],s=0;s<i.length;s++){var o=ue.getSubNodeValue(i[s]);o&&n.push(o)}if(n.length>0)return n}}return null}}return null}(a);qt&&qt.length>0&&(rt.creativeExtensions=qt),rt.conditionalAd=fe;var Lt=Et(a);if(Lt){for(var Ut=0;Ut<Lt.length;Ut++){if(!Lt[Ut].category||!Lt[Ut].authority)return Be(ve,"invalid Category node"),void et(m);if(wt(Lt[Ut]))return Be(ve,"ad is skipped due category violation"),void et(v)}rt.categories=Lt}var _t=JSON.stringify(function(e){for(var t=e;t>=0;)yt(t),t=me[t].parentIdx;return ae}(me[ve].parentIdx)),jt=yt(ve);jt&&jt.viewable.length+jt.notViewable.length+jt.undetermined.length>0&&(rt.extViewableImpression=_t,rt.viewableImpression=jt),x&&(rt.mezzanine=x),q&&q.length>0&&(rt.interactiveCreativeFiles=q)}null!=l&&(rt.fallbackOnNoAd=l),Ae&&Ie.length>0&&(rt.notifyurl=Ie),xe.length>0&&(rt.creative_id=xe),ke.length>0&&(rt.buyerMemberId=ke),Re.length>0&&(rt.brandCategoryId=Re),Pe.length>0&&(rt.viewabilityConfig=Pe);var Mt=!1;if(ye)D.content_source&&"rtb"===D.content_source&&(Mt=!0,rt.rtb=!0);else if(Ae&&!Te){var Ft=ue.getNodeAttributeValue(e,"rtb");Ft&&"true"===Ft&&(Mt=!0,rt.rtb=!0)}if(be)return Be(ve,"terminated"),void I(!1,D,"terminated",null,Ie);var Bt=[];for(at=0;at<O.length;at++)-1===Bt.indexOf(O[at].type)&&Bt.push(O[at].type);Be(ve,"SUCCESS, Available="+JSON.stringify(Bt)),kt(rt),V.telemetry&&(rt.telemetry=Object.assign({},je)),je={hops:[]},Ae||Te?(Te&&(!(f=function(){for(var e=-1,t=ve;t>=0;){var r=me[t].state;r.fallback.index>=0&&(e=r.fallback.index),t=me[t].parentIdx}return e}())&&Ne&&Ge(a),f>=0&&(rt.fallbackIndex=f,rt.fallbackOnNoAd=!0)),Se.push(rt),Mt?Le++:qe++,et()):Ue?(rt.vastXml=function(e,t){for(var r=(new DOMParser).parseFromString(e,"text/xml"),a=ue.getSubNode(r,"VAST"),i=ue.getSubNodes(a,"Ad"),n=0;n<i.length;){var o=ue.getNodeAttributeValue(i[n],"sequence");o&&parseInt(o)!==t?a.removeChild(i[n]):n++}var l;l="ie"===s.browser.name.toLowerCase()?(new XMLSerializer).serializeToString(r.childNodes[0]):r.childNodes[0].outerHTML;return l}(rt.vastXml,rt.sequence),Se.push(rt),et()):I(!0,D,rt,null)}}function kt(e){var t,r=V.mainContentURI||"-1",a=["UNIVERSALADID","CONTENTID","ADSERVINGID","CONTENTURI"],i={UNIVERSALADID:e.universalAdId,CONTENTID:e.contentId,ADSERVINGID:e.adServingId,CONTENTURI:r};for(var n in ue.resolveMacrosArray(e.clickTrackingUrls,a,i,-1),ue.resolveMacrosArray(e.clickUrls,a,i,-1),ue.resolveMacrosArray(e.customClicks,a,i,-1),ue.resolveMacrosArray(e.errorUrls,a,i,-1),ue.resolveMacrosArray(e.impressionUrls,a,i,-1),e.trackingUrls)ue.resolveMacrosArray(e.trackingUrls[n],a,i,-1);if(e.icons&&e.icons.length>0)for(t=0;t<e.icons.length;t++)e.icons[t].IconClickTracking&&ue.resolveMacrosArray(e.icons[t].IconClickTracking,a,i,-1),e.icons[t].IconViewTracking&&ue.resolveMacrosArray(e.icons[t].IconViewTracking,a,i,-1);if(e.companionAds&&e.companionAds.companions&&e.companionAds.companions.length>0){var s=e.companionAds.companions;for(t=0;t<s.length;t++)if(s[t].CompanionClickTracking&&s[t].CompanionClickTracking.length>0&&(s[t].CompanionClickTracking=ue.resolveMacrosArray(s[t].CompanionClickTracking,a,i,-1)),s[t].TrackingEvents&&s[t].TrackingEvents.length>0)for(var o=0;o<s[t].TrackingEvents.length;o++)s[t].TrackingEvents[o].url=ue.resolveMacros(s[t].TrackingEvents[o].url,a,i);e.companionAds.companions=s}e.extClickTrackingUrls=ue.replaceMacrosWithValues(e.extClickTrackingUrls,a,i,-1),e.extClickUrls=ue.replaceMacrosWithValues(e.extClickUrls,a,i,-1),e.extCustomClicks=ue.replaceMacrosWithValues(e.extCustomClicks,a,i,-1),e.extErrorUrls=ue.replaceMacrosWithValues(e.extErrorUrls,a,i,-1),e.extImpressionUrls=ue.replaceMacrosWithValues(e.extImpressionUrls,a,i,-1),e.extTrackingUrls=ue.replaceMacrosWithValues(e.extTrackingUrls,a,i,-1)}N.always(w,"Version 3.2.29"),this.parse=function(e,t,r,a){I=a,function(e,t){var r,a,i,n;if(t&&_.push(t.trim()),e)if(Array.isArray(e)&&1===e.length){var s=e[0];if(s.impression_urls)for(a=0;a<s.impression_urls.length;a++)r=s.impression_urls[a].trim(),_.push(r);if(s.error_urls)for(a=0;a<s.error_urls.length;a++)r=s.error_urls[a].trim(),B.push(r);if(s.video_click_urls)for(a=0;a<s.video_click_urls.length;a++)r=s.video_click_urls[a].trim(),F.push(r);for(n in s.video_events)for(i=s.video_events[n],a=0;a<i.length;a++)r=i[a].trim(),U.hasOwnProperty(n)?We(U[n],r)||U[n].push(r):U[n]=[r]}else for(n in e)if("service"!==n)if(Array.isArray(e[n]))for(i=e[n],a=0;a<i.length;a++)r=i[a].trim(),"click"===n?F.push(r):"error"===n?B.push(r):"impression"===n?_.push(r):U.hasOwnProperty(n)?We(U[n],r)||U[n].push(r):U[n]=[r];else r=e[n].trim(),"click"===n?F.push(r):"error"===n?B.push(r):"impression"===n?_.push(r):U.hasOwnProperty(n)?We(U[n],r)||U[n].push(r):U[n]=[r]}(t,r),Ne=!0,lt(e)},this.parseAdObj=function(e,t,r){I=r,Ne=!0;var a=[],i=ue.getNodeAttributeValue(e,"id");i?i+="_suffix0":i="unknown_suffix0",e.id=i,je.hops.push({});if(t>="4.1"){var n=ue.getNodeAttributeValue(e,"adType");if(""!==n&&"video"!==n)return It("outcome","failed"),It("errCode",g),N.log(w,"Ignore non-video Ad node"),void $e(g,"no Ad available")}a.push(e),it(e),nt(e),at(e),st(e);var s={parentIdx:ve,currentIdx:0,children:a,state:tt()};me.push(s),s.currentIdx=me.length-1,ve=s.currentIdx,Vt(me[ve].children[0],t)},this.terminate=function(){be=!0}},l=r(/*! ./VastModifier.js */"./node_modules/videoads-util-parsers/src/VastModifier.js"),d=r(/*! ./VastMerger.js */"./node_modules/videoads-util-parsers/src/VastMerger.js");e.exports={parse:function(e,t,r,a,i,n,s){var l=new o(r,a,s);return l.parse(e,i,n,(function(e,r,a,i,n){t&&t(e,r,a,i,n),l=null})),l},parseAdObj:function(e,t,r,a,i,n){var s=new o(a,i,n);return s.parseAdObj(e,t,(function(e,t,a,i,n,o){r&&r(e,t,a,i,n,o),s=null})),s},getUnwrappedVastTag:function(e,t,r,a,i,n,s,o,d){if(!e||!e.vastXml)return null;var c=new l(e,t,r,a,i,n,s,o,d),u=c.addTrackers();return c=null,u},getMergedVastTag:function(e,t){if(!e||0===e.length)return null;var r=new d(e,t),a=r.getVastXml();return r=null,a}}},"./node_modules/videoads-util-parsers/src/XmlParserHelper.js":
/*! *******************************************************************!*\
  !*** ./node_modules/videoads-util-parsers/src/XmlParserHelper.js ***!
  \*******************************************************************/(e,t,r)=>{e.exports=function(e){var t=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js"),a=e;this.getSubNodes=function(e,t){var r=e.getElementsByTagName(t);return r.length>0?r:null},this.getSubNode=function(e,t,r){r||(r=0);var a=e.getElementsByTagName(t);return a.length>r?a[r]:null},this.getNodeValue=function(e){if(0===e.childNodes.length)return"";var t=e.childNodes[0].nodeValue;return t?t.trim():""},this.getNodeValues=function(e){if(0===e.childNodes.length)return"";for(var t="",r=0;r<e.childNodes.length;r++){var a=e.childNodes[r].nodeValue;a&&(t+=a)}return t.trim()},this.getNodeAttributeValue=function(e,t){var r=e.getAttribute(t);return null===r&&(r=""),r},this.getNodeAttributeNumberValue=function(e,t,r){r||(r=0);var a=r,i=this.getNodeAttributeValue(e,t);return i.length>0&&(a=i.indexOf(".")>=0?parseFloat(i):parseInt(i)),a},this.getNodeAttributeBooleanValue=function(e,t,r){r||(r=!1);var a=r,i=this.getNodeAttributeValue(e,t);i.length>0&&(a="t"===i.toLowerCase().charAt(0));return a},this.getSubNodeValue=function(e,t,r){r=void 0===r?"":r;var a=this.getSubNode(e,t);return null!==a?this.getNodeValue(a):r},this.getSubNodeWholeValue=function(e,t,r){r=void 0===r?"":r;var a=this.getSubNode(e,t);return null!==a?this.getNodeValues(a):r},this.getSubNodeBooleanValue=function(e,t,r){r=void 0===r?"false":r;var a=this.getSubNodeValue(e,t);return a.length>0&&"t"===a.toLowerCase().charAt(0)||!(a.length>0&&"f"===a.toLowerCase().charAt(0))&&r},this.returnOnlyChildren=function(e,t){var r=[];if(t&&t.length>0)for(var a=0;a<t.length;a++)t[a].parentNode===e&&r.push(t[a]);return r},this.resolveMacros=function(e,r,i){var n,s={TIMESTAMP:function(){return(new Date).toISOString()},CACHEBUSTING:function(){return Math.floor(1e8*Math.random()).toString()},DEVICEUA:function(){return a&&!a.enforcePrivacy?navigator.userAgent:-2},SERVERSIDE:function(){return 0},DOMAIN:function(){try{return top&&top.location?top.location.hostname:-1}catch(e){return-1}},VASTVERSIONS:function(){return"2,3,5,6,7,8,310,311"},ADCATEGORIES:function(){return-1},GDPRCONSENT:function(){return-1},SERVERUA:function(){return-1},MEDIAMIME:function(){return"video/mp4,video/webm,video/ogg,application/javascript,application/x-javascript"},EXTENSIONS:function(){return-1},APIFRAMEWORKS:function(){return"1,2"},VERIFICATIONVENDORS:function(){return"appnexus.com-omid"},APPBUNDLE:function(){return-1},REGULATIONS:function(){return-1},OMIDPARTNER:function(){return"Appnexus/1.4.0"},BREAKMAXDURATION:function(){return-1},BREAKMINDURATION:function(){return-1},BREAKMAXADS:function(){return-1},BREAKMINADLENGTH:function(){return-1},BREAKMAXADLENGTH:function(){return-1},IFA:function(){return-1},IFATYPE:function(){return-1},DEVICEIP:function(){return-1},LATLONG:function(){return-1},PAGEURL:function(){var e;try{e=top&&top.location&&top.location.href?top.location.href:null}catch(e){t.info("VAST Parser","Xandr VAST parser is unable to resolve PAGEURL macro because top window is not accessible. A value of -1 will be used to resolve this macro.")}return e||-1}},o="string"==typeof e?e:e.url;for(n in s)o=o.split("["+n+"]").join(encodeURIComponent(s[n]()));return o=r?this.replaceMacrosWithValues(o,["ADTYPE","INVENTORYSTATE"],i,-1):this.replaceMacrosWithValues(o,["BLOCKEDADCATEGORIES","ADTYPE","ADCOUNT","PLACEMENTTYPE","INVENTORYSTATE"],i,-1),"object"==typeof e?(e.url=o,e):o},this.resolveMacrosArray=function(e,t,r,a){for(var i=0;i<e.length;i++)"string"==typeof e[i]?e[i]=this.replaceMacrosWithValues(e[i],t,r,a):"object"==typeof e[i]&&(e[i].url=this.replaceMacrosWithValues(e[i].url,t,r,a));return e},this.replaceMacrosWithValues=function(e,t,r,a){var i,n,s=0,o=t.length,l=a||-1;for(s=0;s<o;s++)i=t[s],e.indexOf(i)>=0&&(n=e.split("["+i+"]"),e=n.join(encodeURIComponent(r.hasOwnProperty(i)&&r[i]?r[i]:l)));return e},this.getDomain=function(e){return new URL(e).hostname},this.prepareAttributionData=function(e,t,r){var a=this.getNodeAttributeValue(e,"attributiontype");if(!a||"SINGLE-PING"!==a&&"DOUBLE-PING"!==a&&"SINGLE_PING"!==a&&"DOUBLE_PING"!==a)return t;var i={url:t,attributionType:a="SINGLE-PING"===a||"SINGLE_PING"===a?"SINGLE-PING":"DOUBLE-PING"};if("DOUBLE-PING"===a){var n=this.getNodeAttributeValue(e,"attributionsrc");n&&(r&&(n=this.resolveMacros(n,!0,r)),i.attributionSrc=n)}return i}}},"./node_modules/videoads-util-url-loader/src/UrlLoader.js":
/*! ****************************************************************!*\
  !*** ./node_modules/videoads-util-url-loader/src/UrlLoader.js ***!
  \****************************************************************/(e,t,r)=>{var a=r(/*! @appnexus/videoads-util-logging */"./node_modules/@appnexus/videoads-util-logging/src/Logging.js");var i,n=(i=window.document.featurePolicy)&&i.allowedFeatures&&i.allowedFeatures().includes("attribution-reporting")?(a.log("Attribution reporting is SUPPORTED"),!0):(a.log("Attribution reporting is NOT SUPPORTED"),!1);function s(e,t,a,i,n,o){var l,d=0,c=0,u=!1,p=r(/*! videoads-util-misc-general */"./node_modules/videoads-util-misc-general/src/GeneralUtilities.js"),h=r(/*! videoads-util-cache-manager */"./node_modules/videoads-util-cache-manager/src/CacheManager.js"),f=!0,g=function(e){p.logDebug(e,"URL Loader")};if(n&&void 0!==n.withCredentials&&(f=n.withCredentials),window.XMLHttpRequest)l=new XMLHttpRequest;else if(window.ActiveXObject)try{l=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{l=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}l?(l.onreadystatechange=function(){if(4===l.readyState)if(200===l.status){if(g("duration: "+c+", response length: "+l.responseText.length),u&&l.responseText&&l.responseText.length>2048){var e=8*l.responseText.length*1e3/(1024*Math.max(1,c)),t=parseInt(e.toString());g("Bandwidth: "+t);try{h.setGenericData("anxBandwidth",t)}catch(e){}}a&&a.call(this,void 0,l.responseText,l)}else l.status>=400&&l.status<600&&a&&a.call(this,l.status,"",l);else 2===l.readyState?d=(new Date).getTime():3===l.readyState&&d>0&&(u=!0,c=(new Date).getTime()-d)},l.onerror=function(){if(f){var r=n||{};r.withCredentials=!1,s(e,t,a,i,r,o)}else if(a){var d=0===l.status?"404":l.status.toString();a.call(this,d,"",l)}},l.ontimeout=function(){a&&a.call(this,"Timeout","",l)},l.open(o,e),i&&(l.timeout=i),l.withCredentials=f,d=0,"POST"===o?l.send(t):l.send()):a&&a.call(this,"406","")}e.exports={load:function(e,t,r,a){var i=!0;!1===a&&(i=!1),s(e,null,t,r,{withCredentials:i},"GET")},loadPost:function(e,t,r,a){s(e,t,r,a,{withCredentials:!0},"POST")},trackPixel:function(e,t){!function(e,t){if(a.log("Logging Event: "+t+" at url:"+e),"string"==typeof e)new Image(1,1).src=e;else if("object"==typeof e){var r;if(e.url)if(n)if("SINGLE-PING"===e.attributionType){a.log("Event = "+t+" SINGLE-PING empty attributionsrc"),r=new Image(1,1);try{r.setAttribute("attributionsrc","")}catch(e){}r.src=e.url}else if("DOUBLE-PING"===e.attributionType){var i=e.attributionSrc?e.attributionSrc:"";a.log("Event = "+t+" DOUBLE-PING attributionsrc = "+i),r=new Image(1,1);try{r.setAttribute("attributionsrc",i)}catch(e){}r.src=e.url}else new Image(1,1).src=e.url;else new Image(1,1).src=e.url}}(e,t)}}},"./package.json":
/*! **********************!*\
  !*** ./package.json ***!
  \**********************/e=>{"use strict";e.exports=JSON.parse('{"name":"video_ad_server_sdk.js","version":"1.0.5","description":"MS Video Ad Server SDK","main":"src/XandrSDKManager.js","repository":{"type":"git","url":"ssh://git@stash.corp.appnexus.com:7999/video/resources_xandr-video-ad-sdk.git"},"scripts":{"lint":"eslint --ext .js src tests/unit","jest":"node node_modules/jest/bin/jest.js","jest:snapshot":"npm run jest -- --updateSnapshot","coverage":"npm run jest -- --coverage","test":"npm run jest","test:ci":"npm run jest -- --ci --testResultsProcessor=jest-sonar-reporter --coverage","prepare":"husky install","gp-build-install":"npm ci","gp-build-compile":"npm run lint && gulp","gp-build-test":"jest --ci --testResultsProcessor=jest-sonar-reporter --coverage"},"sideEffects":["modules/*.js","modules/*/index.js"],"browserslist":["> 0.25%","not IE 11","not op_mini all"],"globalVarName":"adServerSdk","author":"Yevgeniy Nisman","license":"UNLICENSED","engines":{"node":">=8.9.0"},"devDependencies":{"@appnexus/videoads-util-user-agent-parser":"latest","@babel/eslint-parser":"^7.21.3","@jsdevtools/coverage-istanbul-loader":"^3.0.3","babel-loader":"^8.3.0","babel-register":"^6.26.0","body-parser":"^1.20.2","es5-shim":"^4.5.14","eslint":"^7.27.0","eslint-config-standard":"^10.2.1","eslint-plugin-import":"^2.27.5","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^5.1.0","eslint-plugin-standard":"^3.0.1","gulp":"^4.0.0","gulp-clean":"^0.3.2","gulp-concat":"^2.6.0","gulp-connect":"^5.7.0","gulp-eslint":"^4.0.0","gulp-header":"^1.2.2","gulp-if":"^3.0.0","gulp-install":"^1.1.0","gulp-js-escape":"^1.0.1","gulp-replace":"^1.1.4","gulp-run":"^1.7.1","gulp-shell":"^0.8.0","gulp-sourcemaps":"^3.0.0","gulp-terser":"^2.0.1","gulp-util":"^3.0.0","husky":"^7.0.4","istanbul":"^0.4.5","jest":"^27.5.1","jest-sonar-reporter":"^2.0.0","lodash":"^4.17.21","webpack":"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-stream":"^7.0.0"},"dependencies":{"@appnexus/videoads-util-user-agent-parser":"latest","@babel/core":"^7.21.4","@babel/preset-env":"^7.21.4","babel-plugin-transform-object-assign":"^6.22.0","core-js":"^3.30.1","core-js-pure":"^3.30.1","videoads-util-parsers":"latest","videoads-util-url-loader":"latest"},"jest":{"coverageDirectory":"./coverage/","collectCoverageFrom":["**/src/**/*.js","!**/node_modules/**","!**/tests/**","!**/dist/**"],"coverageReporters":["html","lcov"]}}')}},t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{"use strict";
/*! ********************************!*\
  !*** ./src/XandrSDKManager.js ***!
  \********************************/r.r(a),r.d(a,{AdEvent:()=>u,XandrSDKManager:()=>c});var e=r(/*! ./AdRequestManager */"./src/AdRequestManager.js"),t=r(/*! ./constants/statuses */"./src/constants/statuses.js"),i=r(/*! videoads-util-url-loader */"./node_modules/videoads-util-url-loader/src/UrlLoader.js"),n=r(/*! ../package.json */"./package.json"),s=r(/*! ./AdCommunicator */"./src/AdCommunicator.js"),o=r(/*! ./constants/events */"./src/constants/events.js");function l(e,t,r){e||0===t.length?this.prebidSpecsError="Timeout"===e?"Failed to get bidderSpecs. TIMED OUT: "+r:"Failed to get bidderSpecs. No response for: "+r:this.prebidBidderSpecs=t}function d(){var e,t,r,a;if(null!==(e=this.options)&&void 0!==e&&null!==(t=e.prebid)&&void 0!==t&&t.bidderSpecs&&"string"==typeof this.options.prebid.bidderSpecs)if(0!==this.options.prebid.bidderSpecs.trim().length){const e=this.options.prebid.bidderSpecs;(0,i.load)(e,(t,r)=>{l.bind(this)(t,r,e)},2e3)}else this.prebidSpecsError="bidderSpecs file url is empty";else null!==(r=this.options)&&void 0!==r&&null!==(a=r.prebid)&&void 0!==a&&a.bidderSpecs&&"object"==typeof this.options.prebid.bidderSpecs?Object.keys(this.options.prebid.bidderSpecs).length?this.prebidBidderSpecs=this.options.prebid.bidderSpecs:this.prebidSpecsError="bidderSpecs object is empty":this.prebidSpecsError="bidderSpecs not defined"}class c{constructor(e){if(!(this instanceof c))return new c;this.flowStatuses=t.FLOW,this.prebidBidderSpecs=null,this.prebidSpecsError=null,this.options=e||{},this.adRequestManager=null,this.contentPlayers=[],d.bind(this)()}getVersion(){return n.version?n.version:"unknown"}playAd(t){var r,a,i,n,l,d,c,u,p;let h=!1;if(!t)return void console.error("Missing options object for playAd(...) call");if(0===Object.keys(t).length)return void console.error("An options object is empty for playAd(...) call");this.adRequestManager||(this.adRequestManager=new e.AdRequestManager(this,1)),t.adRequestId||(t.adRequestId="not specified");const f=new s.AdCommunicator(t.adRequestId);if(t.events){for(const e in t.events)f.addEventListener(e,t.events[e]);delete t.events}if(null!=this&&null!==(r=this.options)&&void 0!==r&&null!==(a=r.prebid)&&void 0!==a&&a.hasOwnProperty("enabled")&&null!=t&&null!==(i=t.prebid)&&void 0!==i&&i.hasOwnProperty("enabled")&&(h=t.prebid.enabled),null===(n=this.options)||void 0===n||null===(l=n.prebid)||void 0===l||!l.hasOwnProperty("enabled")||null!==(d=t.prebid)&&void 0!==d&&d.hasOwnProperty("enabled")||(h=this.options.prebid.enabled),null!==(c=this.options)&&void 0!==c&&null!==(u=c.prebid)&&void 0!==u&&u.hasOwnProperty("enabled")||null===(p=t.prebid)||void 0===p||!p.hasOwnProperty("enabled")||(h=t.prebid.enabled),f.dispatchEvent(o.EVENTS.PLAYADCALLED,{prebidEnabled:h}),t.hasOwnProperty("targeting")){if("object"!=typeof t.targeting)return f.dispatchEvent(o.EVENTS.SDKERROR,{message:"The targeting data is invalid within options for playAd(...) call"}),f.dispatchEvent(o.EVENTS.ADSLOTENDED),void console.error("The targeting data is invalid within options for playAd(...) call");if("object"==typeof t.targeting&&!Object.keys(t.targeting).length)return f.dispatchEvent(o.EVENTS.SDKERROR,{message:"The targeting data is missing within options for playAd(...) call"}),f.dispatchEvent(o.EVENTS.ADSLOTENDED),void console.error("The targeting data is missing within options for playAd(...) call")}if(!t.contentPlayer)return f.dispatchEvent(o.EVENTS.SDKERROR,{message:"The content player instance is missing within options for playAd(...) call"}),f.dispatchEvent(o.EVENTS.ADSLOTENDED),void console.error("The content player instance is missing within options for playAd(...) call");this.contentPlayers.includes(t.contentPlayer)||(this.contentPlayers.push({player:t.contentPlayer,playerTime:0}),t.contentPlayer.controlBar.progressControl.on("mouseup",()=>{const e=t.contentPlayer,r=this.contentPlayers.find(t=>t.player===e);r&&Math.abs(e.currentTime()-r.playerTime)>1&&(r.playerTime=e.currentTime(),this.adRequestManager.playAdAfterScrubbing(e))})),t.playerElementId||(t.playerElementId=t.contentPlayer.el_.id);const g=t.timeout&&t.timeout>0?t.timeout:5e3;delete t.timeout,t.companion&&(Array.isArray(t.companion)&&(t.companionContainers=[...t.companion]),delete t.companion),delete t.msSkinCss,this.options.hasOwnProperty("msSkinCss")&&(t.msSkinCss=this.options.msSkinCss),this.adRequestManager.playAd(t,g,f)}pauseAd(t){t?(this.adRequestManager||(this.adRequestManager=new e.AdRequestManager(this,1)),this.adRequestManager.pauseAdForPlayer(!0,t)):console.warn("'contentPlayer' of pauseAd(...) call is missing")}resumeAd(t){t?(this.adRequestManager||(this.adRequestManager=new e.AdRequestManager(this,1)),this.adRequestManager.pauseAdForPlayer(!1,t)):console.warn("'contentPlayer' of resumeAd(...) call is missing")}}const u=o.EVENTS})(),XandrVideoAdSdk=a})();